var K2=Object.defineProperty;var jS=n=>{throw TypeError(n)};var X2=(n,e,t)=>e in n?K2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ue=(n,e,t)=>X2(n,typeof e!="symbol"?e+"":e,t),Zv=(n,e,t)=>e.has(n)||jS("Cannot "+t);var c=(n,e,t)=>(Zv(n,e,"read from private field"),t?t.call(n):e.get(n)),I=(n,e,t)=>e.has(n)?jS("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),w=(n,e,t,s)=>(Zv(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),x=(n,e,t)=>(Zv(n,e,"access private method"),t);var Ln=(n,e,t,s)=>({set _(i){w(n,e,i,t)},get _(){return c(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function Y2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jI={exports:{}},U_={},UI={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gg=Symbol.for("react.element"),Q2=Symbol.for("react.portal"),J2=Symbol.for("react.fragment"),Z2=Symbol.for("react.strict_mode"),eL=Symbol.for("react.profiler"),tL=Symbol.for("react.provider"),nL=Symbol.for("react.context"),sL=Symbol.for("react.forward_ref"),iL=Symbol.for("react.suspense"),rL=Symbol.for("react.memo"),oL=Symbol.for("react.lazy"),US=Symbol.iterator;function aL(n){return n===null||typeof n!="object"?null:(n=US&&n[US]||n["@@iterator"],typeof n=="function"?n:null)}var BI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zI=Object.assign,$I={};function Vh(n,e,t){this.props=n,this.context=e,this.refs=$I,this.updater=t||BI}Vh.prototype.isReactComponent={};Vh.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Vh.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function HI(){}HI.prototype=Vh.prototype;function VA(n,e,t){this.props=n,this.context=e,this.refs=$I,this.updater=t||BI}var jA=VA.prototype=new HI;jA.constructor=VA;zI(jA,Vh.prototype);jA.isPureReactComponent=!0;var BS=Array.isArray,WI=Object.prototype.hasOwnProperty,UA={current:null},GI={key:!0,ref:!0,__self:!0,__source:!0};function qI(n,e,t){var s,i={},r=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(r=""+e.key),e)WI.call(e,s)&&!GI.hasOwnProperty(s)&&(i[s]=e[s]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(n&&n.defaultProps)for(s in a=n.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return{$$typeof:gg,type:n,key:r,ref:o,props:i,_owner:UA.current}}function lL(n,e){return{$$typeof:gg,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function BA(n){return typeof n=="object"&&n!==null&&n.$$typeof===gg}function cL(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var zS=/\/+/g;function ew(n,e){return typeof n=="object"&&n!==null&&n.key!=null?cL(""+n.key):e.toString(36)}function Nm(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case gg:case Q2:o=!0}}if(o)return o=n,i=i(o),n=s===""?"."+ew(o,0):s,BS(i)?(t="",n!=null&&(t=n.replace(zS,"$&/")+"/"),Nm(i,e,t,"",function(u){return u})):i!=null&&(BA(i)&&(i=lL(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(zS,"$&/")+"/")+n)),e.push(i)),1;if(o=0,s=s===""?".":s+":",BS(n))for(var a=0;a<n.length;a++){r=n[a];var l=s+ew(r,a);o+=Nm(r,e,t,l,i)}else if(l=aL(n),typeof l=="function")for(n=l.call(n),a=0;!(r=n.next()).done;)r=r.value,l=s+ew(r,a++),o+=Nm(r,e,t,l,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function nm(n,e,t){if(n==null)return n;var s=[],i=0;return Nm(n,s,"","",function(r){return e.call(t,r,i++)}),s}function uL(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Kn={current:null},Dm={transition:null},hL={ReactCurrentDispatcher:Kn,ReactCurrentBatchConfig:Dm,ReactCurrentOwner:UA};function KI(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:nm,forEach:function(n,e,t){nm(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return nm(n,function(){e++}),e},toArray:function(n){return nm(n,function(e){return e})||[]},only:function(n){if(!BA(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ie.Component=Vh;Ie.Fragment=J2;Ie.Profiler=eL;Ie.PureComponent=VA;Ie.StrictMode=Z2;Ie.Suspense=iL;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hL;Ie.act=KI;Ie.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=zI({},n.props),i=n.key,r=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,o=UA.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)WI.call(e,l)&&!GI.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:gg,type:n.type,key:i,ref:r,props:s,_owner:o}};Ie.createContext=function(n){return n={$$typeof:nL,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:tL,_context:n},n.Consumer=n};Ie.createElement=qI;Ie.createFactory=function(n){var e=qI.bind(null,n);return e.type=n,e};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(n){return{$$typeof:sL,render:n}};Ie.isValidElement=BA;Ie.lazy=function(n){return{$$typeof:oL,_payload:{_status:-1,_result:n},_init:uL}};Ie.memo=function(n,e){return{$$typeof:rL,type:n,compare:e===void 0?null:e}};Ie.startTransition=function(n){var e=Dm.transition;Dm.transition={};try{n()}finally{Dm.transition=e}};Ie.unstable_act=KI;Ie.useCallback=function(n,e){return Kn.current.useCallback(n,e)};Ie.useContext=function(n){return Kn.current.useContext(n)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(n){return Kn.current.useDeferredValue(n)};Ie.useEffect=function(n,e){return Kn.current.useEffect(n,e)};Ie.useId=function(){return Kn.current.useId()};Ie.useImperativeHandle=function(n,e,t){return Kn.current.useImperativeHandle(n,e,t)};Ie.useInsertionEffect=function(n,e){return Kn.current.useInsertionEffect(n,e)};Ie.useLayoutEffect=function(n,e){return Kn.current.useLayoutEffect(n,e)};Ie.useMemo=function(n,e){return Kn.current.useMemo(n,e)};Ie.useReducer=function(n,e,t){return Kn.current.useReducer(n,e,t)};Ie.useRef=function(n){return Kn.current.useRef(n)};Ie.useState=function(n){return Kn.current.useState(n)};Ie.useSyncExternalStore=function(n,e,t){return Kn.current.useSyncExternalStore(n,e,t)};Ie.useTransition=function(){return Kn.current.useTransition()};Ie.version="18.3.1";UI.exports=Ie;var K=UI.exports;const dL=Y2(K);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fL=K,pL=Symbol.for("react.element"),gL=Symbol.for("react.fragment"),mL=Object.prototype.hasOwnProperty,yL=fL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_L={key:!0,ref:!0,__self:!0,__source:!0};function XI(n,e,t){var s,i={},r=null,o=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)mL.call(e,s)&&!_L.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:pL,type:n,key:r,ref:o,props:i,_owner:yL.current}}U_.Fragment=gL;U_.jsx=XI;U_.jsxs=XI;jI.exports=U_;var b=jI.exports,e0={},YI={exports:{}},ks={},QI={exports:{}},JI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(z,$){var q=z.length;z.push($);e:for(;0<q;){var oe=q-1>>>1,se=z[oe];if(0<i(se,$))z[oe]=$,z[q]=se,q=oe;else break e}}function t(z){return z.length===0?null:z[0]}function s(z){if(z.length===0)return null;var $=z[0],q=z.pop();if(q!==$){z[0]=q;e:for(var oe=0,se=z.length,J=se>>>1;oe<J;){var Ge=2*(oe+1)-1,_e=z[Ge],Be=Ge+1,be=z[Be];if(0>i(_e,q))Be<se&&0>i(be,_e)?(z[oe]=be,z[Be]=q,oe=Be):(z[oe]=_e,z[Ge]=q,oe=Ge);else if(Be<se&&0>i(be,q))z[oe]=be,z[Be]=q,oe=Be;else break e}}return $}function i(z,$){var q=z.sortIndex-$.sortIndex;return q!==0?q:z.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,f=null,p=3,m=!1,y=!1,E=!1,k=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(z){for(var $=t(u);$!==null;){if($.callback===null)s(u);else if($.startTime<=z)s(u),$.sortIndex=$.expirationTime,e(l,$);else break;$=t(u)}}function N(z){if(E=!1,C(z),!y)if(t(l)!==null)y=!0,de(F);else{var $=t(u);$!==null&&Y(N,$.startTime-z)}}function F(z,$){y=!1,E&&(E=!1,v(T),T=-1),m=!0;var q=p;try{for(C($),f=t(l);f!==null&&(!(f.expirationTime>$)||z&&!M());){var oe=f.callback;if(typeof oe=="function"){f.callback=null,p=f.priorityLevel;var se=oe(f.expirationTime<=$);$=n.unstable_now(),typeof se=="function"?f.callback=se:f===t(l)&&s(l),C($)}else s(l);f=t(l)}if(f!==null)var J=!0;else{var Ge=t(u);Ge!==null&&Y(N,Ge.startTime-$),J=!1}return J}finally{f=null,p=q,m=!1}}var V=!1,S=null,T=-1,P=5,D=-1;function M(){return!(n.unstable_now()-D<P)}function O(){if(S!==null){var z=n.unstable_now();D=z;var $=!0;try{$=S(!0,z)}finally{$?L():(V=!1,S=null)}}else V=!1}var L;if(typeof A=="function")L=function(){A(O)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,Ne=ne.port2;ne.port1.onmessage=O,L=function(){Ne.postMessage(null)}}else L=function(){k(O,0)};function de(z){S=z,V||(V=!0,L())}function Y(z,$){T=k(function(){z(n.unstable_now())},$)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(z){z.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,de(F))},n.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<z?Math.floor(1e3/z):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(z){switch(p){case 1:case 2:case 3:var $=3;break;default:$=p}var q=p;p=$;try{return z()}finally{p=q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(z,$){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var q=p;p=z;try{return $()}finally{p=q}},n.unstable_scheduleCallback=function(z,$,q){var oe=n.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?oe+q:oe):q=oe,z){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=q+se,z={id:d++,callback:$,priorityLevel:z,startTime:q,expirationTime:se,sortIndex:-1},q>oe?(z.sortIndex=q,e(u,z),t(l)===null&&z===t(u)&&(E?(v(T),T=-1):E=!0,Y(N,q-oe))):(z.sortIndex=se,e(l,z),y||m||(y=!0,de(F))),z},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(z){var $=p;return function(){var q=p;p=$;try{return z.apply(this,arguments)}finally{p=q}}}})(JI);QI.exports=JI;var vL=QI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wL=K,Cs=vL;function G(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ZI=new Set,wf={};function mc(n,e){bh(n,e),bh(n+"Capture",e)}function bh(n,e){for(wf[n]=e,n=0;n<e.length;n++)ZI.add(e[n])}var to=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),t0=Object.prototype.hasOwnProperty,EL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$S={},HS={};function AL(n){return t0.call(HS,n)?!0:t0.call($S,n)?!1:EL.test(n)?HS[n]=!0:($S[n]=!0,!1)}function bL(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function TL(n,e,t,s){if(e===null||typeof e>"u"||bL(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Xn(n,e,t,s,i,r,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var fn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){fn[n]=new Xn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];fn[e]=new Xn(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){fn[n]=new Xn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){fn[n]=new Xn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){fn[n]=new Xn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){fn[n]=new Xn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){fn[n]=new Xn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){fn[n]=new Xn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){fn[n]=new Xn(n,5,!1,n.toLowerCase(),null,!1,!1)});var zA=/[\-:]([a-z])/g;function $A(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(zA,$A);fn[e]=new Xn(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(zA,$A);fn[e]=new Xn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(zA,$A);fn[e]=new Xn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){fn[n]=new Xn(n,1,!1,n.toLowerCase(),null,!1,!1)});fn.xlinkHref=new Xn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){fn[n]=new Xn(n,1,!1,n.toLowerCase(),null,!0,!0)});function HA(n,e,t,s){var i=fn.hasOwnProperty(e)?fn[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(TL(e,t,i,s)&&(t=null),s||i===null?AL(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var uo=wL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sm=Symbol.for("react.element"),Hc=Symbol.for("react.portal"),Wc=Symbol.for("react.fragment"),WA=Symbol.for("react.strict_mode"),n0=Symbol.for("react.profiler"),eC=Symbol.for("react.provider"),tC=Symbol.for("react.context"),GA=Symbol.for("react.forward_ref"),s0=Symbol.for("react.suspense"),i0=Symbol.for("react.suspense_list"),qA=Symbol.for("react.memo"),_o=Symbol.for("react.lazy"),nC=Symbol.for("react.offscreen"),WS=Symbol.iterator;function gd(n){return n===null||typeof n!="object"?null:(n=WS&&n[WS]||n["@@iterator"],typeof n=="function"?n:null)}var _t=Object.assign,tw;function Cd(n){if(tw===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);tw=e&&e[1]||""}return`
`+tw+n}var nw=!1;function sw(n,e){if(!n||nw)return"";nw=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),o=i.length-1,a=r.length-1;1<=o&&0<=a&&i[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==r[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==r[a]){var l=`
`+i[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{nw=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Cd(n):""}function SL(n){switch(n.tag){case 5:return Cd(n.type);case 16:return Cd("Lazy");case 13:return Cd("Suspense");case 19:return Cd("SuspenseList");case 0:case 2:case 15:return n=sw(n.type,!1),n;case 11:return n=sw(n.type.render,!1),n;case 1:return n=sw(n.type,!0),n;default:return""}}function r0(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Wc:return"Fragment";case Hc:return"Portal";case n0:return"Profiler";case WA:return"StrictMode";case s0:return"Suspense";case i0:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case tC:return(n.displayName||"Context")+".Consumer";case eC:return(n._context.displayName||"Context")+".Provider";case GA:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case qA:return e=n.displayName||null,e!==null?e:r0(n.type)||"Memo";case _o:e=n._payload,n=n._init;try{return r0(n(e))}catch{}}return null}function xL(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return r0(e);case 8:return e===WA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ya(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function sC(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function IL(n){var e=sC(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){s=""+o,r.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function im(n){n._valueTracker||(n._valueTracker=IL(n))}function iC(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=sC(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function Iy(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function o0(n,e){var t=e.checked;return _t({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function GS(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=ya(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function rC(n,e){e=e.checked,e!=null&&HA(n,"checked",e,!1)}function a0(n,e){rC(n,e);var t=ya(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?l0(n,e.type,t):e.hasOwnProperty("defaultValue")&&l0(n,e.type,ya(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function qS(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function l0(n,e,t){(e!=="number"||Iy(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var kd=Array.isArray;function ou(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+ya(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function c0(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return _t({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function KS(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(G(92));if(kd(t)){if(1<t.length)throw Error(G(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:ya(t)}}function oC(n,e){var t=ya(e.value),s=ya(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function XS(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function aC(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function u0(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?aC(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var rm,lC=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(rm=rm||document.createElement("div"),rm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rm.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Ef(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var ef={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CL=["Webkit","ms","Moz","O"];Object.keys(ef).forEach(function(n){CL.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),ef[e]=ef[n]})});function cC(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ef.hasOwnProperty(n)&&ef[n]?(""+e).trim():e+"px"}function uC(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=cC(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var kL=_t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function h0(n,e){if(e){if(kL[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function d0(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var f0=null;function KA(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var p0=null,au=null,lu=null;function YS(n){if(n=_g(n)){if(typeof p0!="function")throw Error(G(280));var e=n.stateNode;e&&(e=W_(e),p0(n.stateNode,n.type,e))}}function hC(n){au?lu?lu.push(n):lu=[n]:au=n}function dC(){if(au){var n=au,e=lu;if(lu=au=null,YS(n),e)for(n=0;n<e.length;n++)YS(e[n])}}function fC(n,e){return n(e)}function pC(){}var iw=!1;function gC(n,e,t){if(iw)return n(e,t);iw=!0;try{return fC(n,e,t)}finally{iw=!1,(au!==null||lu!==null)&&(pC(),dC())}}function Af(n,e){var t=n.stateNode;if(t===null)return null;var s=W_(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(G(231,e,typeof t));return t}var g0=!1;if(to)try{var md={};Object.defineProperty(md,"passive",{get:function(){g0=!0}}),window.addEventListener("test",md,md),window.removeEventListener("test",md,md)}catch{g0=!1}function RL(n,e,t,s,i,r,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(d){this.onError(d)}}var tf=!1,Cy=null,ky=!1,m0=null,PL={onError:function(n){tf=!0,Cy=n}};function NL(n,e,t,s,i,r,o,a,l){tf=!1,Cy=null,RL.apply(PL,arguments)}function DL(n,e,t,s,i,r,o,a,l){if(NL.apply(this,arguments),tf){if(tf){var u=Cy;tf=!1,Cy=null}else throw Error(G(198));ky||(ky=!0,m0=u)}}function yc(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function mC(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function QS(n){if(yc(n)!==n)throw Error(G(188))}function LL(n){var e=n.alternate;if(!e){if(e=yc(n),e===null)throw Error(G(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return QS(i),n;if(r===s)return QS(i),e;r=r.sibling}throw Error(G(188))}if(t.return!==s.return)t=i,s=r;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,s=r;break}if(a===s){o=!0,s=i,t=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===t){o=!0,t=r,s=i;break}if(a===s){o=!0,s=r,t=i;break}a=a.sibling}if(!o)throw Error(G(189))}}if(t.alternate!==s)throw Error(G(190))}if(t.tag!==3)throw Error(G(188));return t.stateNode.current===t?n:e}function yC(n){return n=LL(n),n!==null?_C(n):null}function _C(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=_C(n);if(e!==null)return e;n=n.sibling}return null}var vC=Cs.unstable_scheduleCallback,JS=Cs.unstable_cancelCallback,ML=Cs.unstable_shouldYield,OL=Cs.unstable_requestPaint,Ct=Cs.unstable_now,FL=Cs.unstable_getCurrentPriorityLevel,XA=Cs.unstable_ImmediatePriority,wC=Cs.unstable_UserBlockingPriority,Ry=Cs.unstable_NormalPriority,VL=Cs.unstable_LowPriority,EC=Cs.unstable_IdlePriority,B_=null,Qi=null;function jL(n){if(Qi&&typeof Qi.onCommitFiberRoot=="function")try{Qi.onCommitFiberRoot(B_,n,void 0,(n.current.flags&128)===128)}catch{}}var wi=Math.clz32?Math.clz32:zL,UL=Math.log,BL=Math.LN2;function zL(n){return n>>>=0,n===0?32:31-(UL(n)/BL|0)|0}var om=64,am=4194304;function Rd(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Py(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?s=Rd(a):(r&=o,r!==0&&(s=Rd(r)))}else o=t&~i,o!==0?s=Rd(o):r!==0&&(s=Rd(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-wi(e),i=1<<t,s|=n[t],e&=~i;return s}function $L(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function HL(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var o=31-wi(r),a=1<<o,l=i[o];l===-1?(!(a&t)||a&s)&&(i[o]=$L(a,e)):l<=e&&(n.expiredLanes|=a),r&=~a}}function y0(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function AC(){var n=om;return om<<=1,!(om&4194240)&&(om=64),n}function rw(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function mg(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-wi(e),n[e]=t}function WL(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-wi(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function YA(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-wi(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var He=0;function bC(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var TC,QA,SC,xC,IC,_0=!1,lm=[],ia=null,ra=null,oa=null,bf=new Map,Tf=new Map,wo=[],GL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ZS(n,e){switch(n){case"focusin":case"focusout":ia=null;break;case"dragenter":case"dragleave":ra=null;break;case"mouseover":case"mouseout":oa=null;break;case"pointerover":case"pointerout":bf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tf.delete(e.pointerId)}}function yd(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=_g(e),e!==null&&QA(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function qL(n,e,t,s,i){switch(e){case"focusin":return ia=yd(ia,n,e,t,s,i),!0;case"dragenter":return ra=yd(ra,n,e,t,s,i),!0;case"mouseover":return oa=yd(oa,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return bf.set(r,yd(bf.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,Tf.set(r,yd(Tf.get(r)||null,n,e,t,s,i)),!0}return!1}function CC(n){var e=Ka(n.target);if(e!==null){var t=yc(e);if(t!==null){if(e=t.tag,e===13){if(e=mC(t),e!==null){n.blockedOn=e,IC(n.priority,function(){SC(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Lm(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=v0(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);f0=s,t.target.dispatchEvent(s),f0=null}else return e=_g(t),e!==null&&QA(e),n.blockedOn=t,!1;e.shift()}return!0}function e1(n,e,t){Lm(n)&&t.delete(e)}function KL(){_0=!1,ia!==null&&Lm(ia)&&(ia=null),ra!==null&&Lm(ra)&&(ra=null),oa!==null&&Lm(oa)&&(oa=null),bf.forEach(e1),Tf.forEach(e1)}function _d(n,e){n.blockedOn===e&&(n.blockedOn=null,_0||(_0=!0,Cs.unstable_scheduleCallback(Cs.unstable_NormalPriority,KL)))}function Sf(n){function e(i){return _d(i,n)}if(0<lm.length){_d(lm[0],n);for(var t=1;t<lm.length;t++){var s=lm[t];s.blockedOn===n&&(s.blockedOn=null)}}for(ia!==null&&_d(ia,n),ra!==null&&_d(ra,n),oa!==null&&_d(oa,n),bf.forEach(e),Tf.forEach(e),t=0;t<wo.length;t++)s=wo[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<wo.length&&(t=wo[0],t.blockedOn===null);)CC(t),t.blockedOn===null&&wo.shift()}var cu=uo.ReactCurrentBatchConfig,Ny=!0;function XL(n,e,t,s){var i=He,r=cu.transition;cu.transition=null;try{He=1,JA(n,e,t,s)}finally{He=i,cu.transition=r}}function YL(n,e,t,s){var i=He,r=cu.transition;cu.transition=null;try{He=4,JA(n,e,t,s)}finally{He=i,cu.transition=r}}function JA(n,e,t,s){if(Ny){var i=v0(n,e,t,s);if(i===null)gw(n,e,s,Dy,t),ZS(n,s);else if(qL(i,n,e,t,s))s.stopPropagation();else if(ZS(n,s),e&4&&-1<GL.indexOf(n)){for(;i!==null;){var r=_g(i);if(r!==null&&TC(r),r=v0(n,e,t,s),r===null&&gw(n,e,s,Dy,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else gw(n,e,s,null,t)}}var Dy=null;function v0(n,e,t,s){if(Dy=null,n=KA(s),n=Ka(n),n!==null)if(e=yc(n),e===null)n=null;else if(t=e.tag,t===13){if(n=mC(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Dy=n,null}function kC(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(FL()){case XA:return 1;case wC:return 4;case Ry:case VL:return 16;case EC:return 536870912;default:return 16}default:return 16}}var ta=null,ZA=null,Mm=null;function RC(){if(Mm)return Mm;var n,e=ZA,t=e.length,s,i="value"in ta?ta.value:ta.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(s=1;s<=o&&e[t-s]===i[r-s];s++);return Mm=i.slice(n,1<s?1-s:void 0)}function Om(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function cm(){return!0}function t1(){return!1}function Rs(n){function e(t,s,i,r,o){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?cm:t1,this.isPropagationStopped=t1,this}return _t(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=cm)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=cm)},persist:function(){},isPersistent:cm}),e}var jh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eb=Rs(jh),yg=_t({},jh,{view:0,detail:0}),QL=Rs(yg),ow,aw,vd,z_=_t({},yg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tb,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==vd&&(vd&&n.type==="mousemove"?(ow=n.screenX-vd.screenX,aw=n.screenY-vd.screenY):aw=ow=0,vd=n),ow)},movementY:function(n){return"movementY"in n?n.movementY:aw}}),n1=Rs(z_),JL=_t({},z_,{dataTransfer:0}),ZL=Rs(JL),eM=_t({},yg,{relatedTarget:0}),lw=Rs(eM),tM=_t({},jh,{animationName:0,elapsedTime:0,pseudoElement:0}),nM=Rs(tM),sM=_t({},jh,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),iM=Rs(sM),rM=_t({},jh,{data:0}),s1=Rs(rM),oM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cM(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=lM[n])?!!e[n]:!1}function tb(){return cM}var uM=_t({},yg,{key:function(n){if(n.key){var e=oM[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Om(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?aM[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tb,charCode:function(n){return n.type==="keypress"?Om(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Om(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),hM=Rs(uM),dM=_t({},z_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i1=Rs(dM),fM=_t({},yg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tb}),pM=Rs(fM),gM=_t({},jh,{propertyName:0,elapsedTime:0,pseudoElement:0}),mM=Rs(gM),yM=_t({},z_,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),_M=Rs(yM),vM=[9,13,27,32],nb=to&&"CompositionEvent"in window,nf=null;to&&"documentMode"in document&&(nf=document.documentMode);var wM=to&&"TextEvent"in window&&!nf,PC=to&&(!nb||nf&&8<nf&&11>=nf),r1=" ",o1=!1;function NC(n,e){switch(n){case"keyup":return vM.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function DC(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Gc=!1;function EM(n,e){switch(n){case"compositionend":return DC(e);case"keypress":return e.which!==32?null:(o1=!0,r1);case"textInput":return n=e.data,n===r1&&o1?null:n;default:return null}}function AM(n,e){if(Gc)return n==="compositionend"||!nb&&NC(n,e)?(n=RC(),Mm=ZA=ta=null,Gc=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return PC&&e.locale!=="ko"?null:e.data;default:return null}}var bM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function a1(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!bM[n.type]:e==="textarea"}function LC(n,e,t,s){hC(s),e=Ly(e,"onChange"),0<e.length&&(t=new eb("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var sf=null,xf=null;function TM(n){WC(n,0)}function $_(n){var e=Xc(n);if(iC(e))return n}function SM(n,e){if(n==="change")return e}var MC=!1;if(to){var cw;if(to){var uw="oninput"in document;if(!uw){var l1=document.createElement("div");l1.setAttribute("oninput","return;"),uw=typeof l1.oninput=="function"}cw=uw}else cw=!1;MC=cw&&(!document.documentMode||9<document.documentMode)}function c1(){sf&&(sf.detachEvent("onpropertychange",OC),xf=sf=null)}function OC(n){if(n.propertyName==="value"&&$_(xf)){var e=[];LC(e,xf,n,KA(n)),gC(TM,e)}}function xM(n,e,t){n==="focusin"?(c1(),sf=e,xf=t,sf.attachEvent("onpropertychange",OC)):n==="focusout"&&c1()}function IM(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return $_(xf)}function CM(n,e){if(n==="click")return $_(e)}function kM(n,e){if(n==="input"||n==="change")return $_(e)}function RM(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var bi=typeof Object.is=="function"?Object.is:RM;function If(n,e){if(bi(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!t0.call(e,i)||!bi(n[i],e[i]))return!1}return!0}function u1(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function h1(n,e){var t=u1(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=u1(t)}}function FC(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?FC(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function VC(){for(var n=window,e=Iy();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Iy(n.document)}return e}function sb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function PM(n){var e=VC(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&FC(t.ownerDocument.documentElement,t)){if(s!==null&&sb(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=h1(t,r);var o=h1(t,s);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var NM=to&&"documentMode"in document&&11>=document.documentMode,qc=null,w0=null,rf=null,E0=!1;function d1(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;E0||qc==null||qc!==Iy(s)||(s=qc,"selectionStart"in s&&sb(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),rf&&If(rf,s)||(rf=s,s=Ly(w0,"onSelect"),0<s.length&&(e=new eb("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=qc)))}function um(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Kc={animationend:um("Animation","AnimationEnd"),animationiteration:um("Animation","AnimationIteration"),animationstart:um("Animation","AnimationStart"),transitionend:um("Transition","TransitionEnd")},hw={},jC={};to&&(jC=document.createElement("div").style,"AnimationEvent"in window||(delete Kc.animationend.animation,delete Kc.animationiteration.animation,delete Kc.animationstart.animation),"TransitionEvent"in window||delete Kc.transitionend.transition);function H_(n){if(hw[n])return hw[n];if(!Kc[n])return n;var e=Kc[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in jC)return hw[n]=e[t];return n}var UC=H_("animationend"),BC=H_("animationiteration"),zC=H_("animationstart"),$C=H_("transitionend"),HC=new Map,f1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ia(n,e){HC.set(n,e),mc(e,[n])}for(var dw=0;dw<f1.length;dw++){var fw=f1[dw],DM=fw.toLowerCase(),LM=fw[0].toUpperCase()+fw.slice(1);Ia(DM,"on"+LM)}Ia(UC,"onAnimationEnd");Ia(BC,"onAnimationIteration");Ia(zC,"onAnimationStart");Ia("dblclick","onDoubleClick");Ia("focusin","onFocus");Ia("focusout","onBlur");Ia($C,"onTransitionEnd");bh("onMouseEnter",["mouseout","mouseover"]);bh("onMouseLeave",["mouseout","mouseover"]);bh("onPointerEnter",["pointerout","pointerover"]);bh("onPointerLeave",["pointerout","pointerover"]);mc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));mc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));mc("onBeforeInput",["compositionend","keypress","textInput","paste"]);mc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));mc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));mc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MM=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pd));function p1(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,DL(s,e,void 0,n),n.currentTarget=null}function WC(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==r&&i.isPropagationStopped())break e;p1(i,a,u),r=l}else for(o=0;o<s.length;o++){if(a=s[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==r&&i.isPropagationStopped())break e;p1(i,a,u),r=l}}}if(ky)throw n=m0,ky=!1,m0=null,n}function it(n,e){var t=e[x0];t===void 0&&(t=e[x0]=new Set);var s=n+"__bubble";t.has(s)||(GC(e,n,2,!1),t.add(s))}function pw(n,e,t){var s=0;e&&(s|=4),GC(t,n,s,e)}var hm="_reactListening"+Math.random().toString(36).slice(2);function Cf(n){if(!n[hm]){n[hm]=!0,ZI.forEach(function(t){t!=="selectionchange"&&(MM.has(t)||pw(t,!1,n),pw(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[hm]||(e[hm]=!0,pw("selectionchange",!1,e))}}function GC(n,e,t,s){switch(kC(e)){case 1:var i=XL;break;case 4:i=YL;break;default:i=JA}t=i.bind(null,e,t,n),i=void 0,!g0||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function gw(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=s.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ka(a),o===null)return;if(l=o.tag,l===5||l===6){s=r=o;continue e}a=a.parentNode}}s=s.return}gC(function(){var u=r,d=KA(t),f=[];e:{var p=HC.get(n);if(p!==void 0){var m=eb,y=n;switch(n){case"keypress":if(Om(t)===0)break e;case"keydown":case"keyup":m=hM;break;case"focusin":y="focus",m=lw;break;case"focusout":y="blur",m=lw;break;case"beforeblur":case"afterblur":m=lw;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=n1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=ZL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=pM;break;case UC:case BC:case zC:m=nM;break;case $C:m=mM;break;case"scroll":m=QL;break;case"wheel":m=_M;break;case"copy":case"cut":case"paste":m=iM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=i1}var E=(e&4)!==0,k=!E&&n==="scroll",v=E?p!==null?p+"Capture":null:p;E=[];for(var A=u,C;A!==null;){C=A;var N=C.stateNode;if(C.tag===5&&N!==null&&(C=N,v!==null&&(N=Af(A,v),N!=null&&E.push(kf(A,N,C)))),k)break;A=A.return}0<E.length&&(p=new m(p,y,null,t,d),f.push({event:p,listeners:E}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==f0&&(y=t.relatedTarget||t.fromElement)&&(Ka(y)||y[no]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=t.relatedTarget||t.toElement,m=u,y=y?Ka(y):null,y!==null&&(k=yc(y),y!==k||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(E=n1,N="onMouseLeave",v="onMouseEnter",A="mouse",(n==="pointerout"||n==="pointerover")&&(E=i1,N="onPointerLeave",v="onPointerEnter",A="pointer"),k=m==null?p:Xc(m),C=y==null?p:Xc(y),p=new E(N,A+"leave",m,t,d),p.target=k,p.relatedTarget=C,N=null,Ka(d)===u&&(E=new E(v,A+"enter",y,t,d),E.target=C,E.relatedTarget=k,N=E),k=N,m&&y)t:{for(E=m,v=y,A=0,C=E;C;C=Nc(C))A++;for(C=0,N=v;N;N=Nc(N))C++;for(;0<A-C;)E=Nc(E),A--;for(;0<C-A;)v=Nc(v),C--;for(;A--;){if(E===v||v!==null&&E===v.alternate)break t;E=Nc(E),v=Nc(v)}E=null}else E=null;m!==null&&g1(f,p,m,E,!1),y!==null&&k!==null&&g1(f,k,y,E,!0)}}e:{if(p=u?Xc(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var F=SM;else if(a1(p))if(MC)F=kM;else{F=IM;var V=xM}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(F=CM);if(F&&(F=F(n,u))){LC(f,F,t,d);break e}V&&V(n,p,u),n==="focusout"&&(V=p._wrapperState)&&V.controlled&&p.type==="number"&&l0(p,"number",p.value)}switch(V=u?Xc(u):window,n){case"focusin":(a1(V)||V.contentEditable==="true")&&(qc=V,w0=u,rf=null);break;case"focusout":rf=w0=qc=null;break;case"mousedown":E0=!0;break;case"contextmenu":case"mouseup":case"dragend":E0=!1,d1(f,t,d);break;case"selectionchange":if(NM)break;case"keydown":case"keyup":d1(f,t,d)}var S;if(nb)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Gc?NC(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(PC&&t.locale!=="ko"&&(Gc||T!=="onCompositionStart"?T==="onCompositionEnd"&&Gc&&(S=RC()):(ta=d,ZA="value"in ta?ta.value:ta.textContent,Gc=!0)),V=Ly(u,T),0<V.length&&(T=new s1(T,n,null,t,d),f.push({event:T,listeners:V}),S?T.data=S:(S=DC(t),S!==null&&(T.data=S)))),(S=wM?EM(n,t):AM(n,t))&&(u=Ly(u,"onBeforeInput"),0<u.length&&(d=new s1("onBeforeInput","beforeinput",null,t,d),f.push({event:d,listeners:u}),d.data=S))}WC(f,e)})}function kf(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Ly(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=Af(n,t),r!=null&&s.unshift(kf(n,r,i)),r=Af(n,e),r!=null&&s.push(kf(n,r,i))),n=n.return}return s}function Nc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function g1(n,e,t,s,i){for(var r=e._reactName,o=[];t!==null&&t!==s;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&u!==null&&(a=u,i?(l=Af(t,r),l!=null&&o.unshift(kf(t,l,a))):i||(l=Af(t,r),l!=null&&o.push(kf(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var OM=/\r\n?/g,FM=/\u0000|\uFFFD/g;function m1(n){return(typeof n=="string"?n:""+n).replace(OM,`
`).replace(FM,"")}function dm(n,e,t){if(e=m1(e),m1(n)!==e&&t)throw Error(G(425))}function My(){}var A0=null,b0=null;function T0(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var S0=typeof setTimeout=="function"?setTimeout:void 0,VM=typeof clearTimeout=="function"?clearTimeout:void 0,y1=typeof Promise=="function"?Promise:void 0,jM=typeof queueMicrotask=="function"?queueMicrotask:typeof y1<"u"?function(n){return y1.resolve(null).then(n).catch(UM)}:S0;function UM(n){setTimeout(function(){throw n})}function mw(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),Sf(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);Sf(e)}function aa(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function _1(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Uh=Math.random().toString(36).slice(2),Xi="__reactFiber$"+Uh,Rf="__reactProps$"+Uh,no="__reactContainer$"+Uh,x0="__reactEvents$"+Uh,BM="__reactListeners$"+Uh,zM="__reactHandles$"+Uh;function Ka(n){var e=n[Xi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[no]||t[Xi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=_1(n);n!==null;){if(t=n[Xi])return t;n=_1(n)}return e}n=t,t=n.parentNode}return null}function _g(n){return n=n[Xi]||n[no],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Xc(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(G(33))}function W_(n){return n[Rf]||null}var I0=[],Yc=-1;function Ca(n){return{current:n}}function rt(n){0>Yc||(n.current=I0[Yc],I0[Yc]=null,Yc--)}function tt(n,e){Yc++,I0[Yc]=n.current,n.current=e}var _a={},Pn=Ca(_a),os=Ca(!1),tc=_a;function Th(n,e){var t=n.type.contextTypes;if(!t)return _a;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function as(n){return n=n.childContextTypes,n!=null}function Oy(){rt(os),rt(Pn)}function v1(n,e,t){if(Pn.current!==_a)throw Error(G(168));tt(Pn,e),tt(os,t)}function qC(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(G(108,xL(n)||"Unknown",i));return _t({},t,s)}function Fy(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||_a,tc=Pn.current,tt(Pn,n),tt(os,os.current),!0}function w1(n,e,t){var s=n.stateNode;if(!s)throw Error(G(169));t?(n=qC(n,e,tc),s.__reactInternalMemoizedMergedChildContext=n,rt(os),rt(Pn),tt(Pn,n)):rt(os),tt(os,t)}var vr=null,G_=!1,yw=!1;function KC(n){vr===null?vr=[n]:vr.push(n)}function $M(n){G_=!0,KC(n)}function ka(){if(!yw&&vr!==null){yw=!0;var n=0,e=He;try{var t=vr;for(He=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}vr=null,G_=!1}catch(i){throw vr!==null&&(vr=vr.slice(n+1)),vC(XA,ka),i}finally{He=e,yw=!1}}return null}var Qc=[],Jc=0,Vy=null,jy=0,zs=[],$s=0,nc=null,Wr=1,Gr="";function ja(n,e){Qc[Jc++]=jy,Qc[Jc++]=Vy,Vy=n,jy=e}function XC(n,e,t){zs[$s++]=Wr,zs[$s++]=Gr,zs[$s++]=nc,nc=n;var s=Wr;n=Gr;var i=32-wi(s)-1;s&=~(1<<i),t+=1;var r=32-wi(e)+i;if(30<r){var o=i-i%5;r=(s&(1<<o)-1).toString(32),s>>=o,i-=o,Wr=1<<32-wi(e)+i|t<<i|s,Gr=r+n}else Wr=1<<r|t<<i|s,Gr=n}function ib(n){n.return!==null&&(ja(n,1),XC(n,1,0))}function rb(n){for(;n===Vy;)Vy=Qc[--Jc],Qc[Jc]=null,jy=Qc[--Jc],Qc[Jc]=null;for(;n===nc;)nc=zs[--$s],zs[$s]=null,Gr=zs[--$s],zs[$s]=null,Wr=zs[--$s],zs[$s]=null}var Ss=null,bs=null,ut=!1,yi=null;function YC(n,e){var t=Gs(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function E1(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ss=n,bs=aa(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ss=n,bs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=nc!==null?{id:Wr,overflow:Gr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Gs(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ss=n,bs=null,!0):!1;default:return!1}}function C0(n){return(n.mode&1)!==0&&(n.flags&128)===0}function k0(n){if(ut){var e=bs;if(e){var t=e;if(!E1(n,e)){if(C0(n))throw Error(G(418));e=aa(t.nextSibling);var s=Ss;e&&E1(n,e)?YC(s,t):(n.flags=n.flags&-4097|2,ut=!1,Ss=n)}}else{if(C0(n))throw Error(G(418));n.flags=n.flags&-4097|2,ut=!1,Ss=n}}}function A1(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ss=n}function fm(n){if(n!==Ss)return!1;if(!ut)return A1(n),ut=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!T0(n.type,n.memoizedProps)),e&&(e=bs)){if(C0(n))throw QC(),Error(G(418));for(;e;)YC(n,e),e=aa(e.nextSibling)}if(A1(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(G(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){bs=aa(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}bs=null}}else bs=Ss?aa(n.stateNode.nextSibling):null;return!0}function QC(){for(var n=bs;n;)n=aa(n.nextSibling)}function Sh(){bs=Ss=null,ut=!1}function ob(n){yi===null?yi=[n]:yi.push(n)}var HM=uo.ReactCurrentBatchConfig;function wd(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(G(309));var s=t.stateNode}if(!s)throw Error(G(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(o){var a=i.refs;o===null?delete a[r]:a[r]=o},e._stringRef=r,e)}if(typeof n!="string")throw Error(G(284));if(!t._owner)throw Error(G(290,n))}return n}function pm(n,e){throw n=Object.prototype.toString.call(e),Error(G(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function b1(n){var e=n._init;return e(n._payload)}function JC(n){function e(v,A){if(n){var C=v.deletions;C===null?(v.deletions=[A],v.flags|=16):C.push(A)}}function t(v,A){if(!n)return null;for(;A!==null;)e(v,A),A=A.sibling;return null}function s(v,A){for(v=new Map;A!==null;)A.key!==null?v.set(A.key,A):v.set(A.index,A),A=A.sibling;return v}function i(v,A){return v=ha(v,A),v.index=0,v.sibling=null,v}function r(v,A,C){return v.index=C,n?(C=v.alternate,C!==null?(C=C.index,C<A?(v.flags|=2,A):C):(v.flags|=2,A)):(v.flags|=1048576,A)}function o(v){return n&&v.alternate===null&&(v.flags|=2),v}function a(v,A,C,N){return A===null||A.tag!==6?(A=Tw(C,v.mode,N),A.return=v,A):(A=i(A,C),A.return=v,A)}function l(v,A,C,N){var F=C.type;return F===Wc?d(v,A,C.props.children,N,C.key):A!==null&&(A.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===_o&&b1(F)===A.type)?(N=i(A,C.props),N.ref=wd(v,A,C),N.return=v,N):(N=$m(C.type,C.key,C.props,null,v.mode,N),N.ref=wd(v,A,C),N.return=v,N)}function u(v,A,C,N){return A===null||A.tag!==4||A.stateNode.containerInfo!==C.containerInfo||A.stateNode.implementation!==C.implementation?(A=Sw(C,v.mode,N),A.return=v,A):(A=i(A,C.children||[]),A.return=v,A)}function d(v,A,C,N,F){return A===null||A.tag!==7?(A=Ql(C,v.mode,N,F),A.return=v,A):(A=i(A,C),A.return=v,A)}function f(v,A,C){if(typeof A=="string"&&A!==""||typeof A=="number")return A=Tw(""+A,v.mode,C),A.return=v,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case sm:return C=$m(A.type,A.key,A.props,null,v.mode,C),C.ref=wd(v,null,A),C.return=v,C;case Hc:return A=Sw(A,v.mode,C),A.return=v,A;case _o:var N=A._init;return f(v,N(A._payload),C)}if(kd(A)||gd(A))return A=Ql(A,v.mode,C,null),A.return=v,A;pm(v,A)}return null}function p(v,A,C,N){var F=A!==null?A.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return F!==null?null:a(v,A,""+C,N);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case sm:return C.key===F?l(v,A,C,N):null;case Hc:return C.key===F?u(v,A,C,N):null;case _o:return F=C._init,p(v,A,F(C._payload),N)}if(kd(C)||gd(C))return F!==null?null:d(v,A,C,N,null);pm(v,C)}return null}function m(v,A,C,N,F){if(typeof N=="string"&&N!==""||typeof N=="number")return v=v.get(C)||null,a(A,v,""+N,F);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case sm:return v=v.get(N.key===null?C:N.key)||null,l(A,v,N,F);case Hc:return v=v.get(N.key===null?C:N.key)||null,u(A,v,N,F);case _o:var V=N._init;return m(v,A,C,V(N._payload),F)}if(kd(N)||gd(N))return v=v.get(C)||null,d(A,v,N,F,null);pm(A,N)}return null}function y(v,A,C,N){for(var F=null,V=null,S=A,T=A=0,P=null;S!==null&&T<C.length;T++){S.index>T?(P=S,S=null):P=S.sibling;var D=p(v,S,C[T],N);if(D===null){S===null&&(S=P);break}n&&S&&D.alternate===null&&e(v,S),A=r(D,A,T),V===null?F=D:V.sibling=D,V=D,S=P}if(T===C.length)return t(v,S),ut&&ja(v,T),F;if(S===null){for(;T<C.length;T++)S=f(v,C[T],N),S!==null&&(A=r(S,A,T),V===null?F=S:V.sibling=S,V=S);return ut&&ja(v,T),F}for(S=s(v,S);T<C.length;T++)P=m(S,v,T,C[T],N),P!==null&&(n&&P.alternate!==null&&S.delete(P.key===null?T:P.key),A=r(P,A,T),V===null?F=P:V.sibling=P,V=P);return n&&S.forEach(function(M){return e(v,M)}),ut&&ja(v,T),F}function E(v,A,C,N){var F=gd(C);if(typeof F!="function")throw Error(G(150));if(C=F.call(C),C==null)throw Error(G(151));for(var V=F=null,S=A,T=A=0,P=null,D=C.next();S!==null&&!D.done;T++,D=C.next()){S.index>T?(P=S,S=null):P=S.sibling;var M=p(v,S,D.value,N);if(M===null){S===null&&(S=P);break}n&&S&&M.alternate===null&&e(v,S),A=r(M,A,T),V===null?F=M:V.sibling=M,V=M,S=P}if(D.done)return t(v,S),ut&&ja(v,T),F;if(S===null){for(;!D.done;T++,D=C.next())D=f(v,D.value,N),D!==null&&(A=r(D,A,T),V===null?F=D:V.sibling=D,V=D);return ut&&ja(v,T),F}for(S=s(v,S);!D.done;T++,D=C.next())D=m(S,v,T,D.value,N),D!==null&&(n&&D.alternate!==null&&S.delete(D.key===null?T:D.key),A=r(D,A,T),V===null?F=D:V.sibling=D,V=D);return n&&S.forEach(function(O){return e(v,O)}),ut&&ja(v,T),F}function k(v,A,C,N){if(typeof C=="object"&&C!==null&&C.type===Wc&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case sm:e:{for(var F=C.key,V=A;V!==null;){if(V.key===F){if(F=C.type,F===Wc){if(V.tag===7){t(v,V.sibling),A=i(V,C.props.children),A.return=v,v=A;break e}}else if(V.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===_o&&b1(F)===V.type){t(v,V.sibling),A=i(V,C.props),A.ref=wd(v,V,C),A.return=v,v=A;break e}t(v,V);break}else e(v,V);V=V.sibling}C.type===Wc?(A=Ql(C.props.children,v.mode,N,C.key),A.return=v,v=A):(N=$m(C.type,C.key,C.props,null,v.mode,N),N.ref=wd(v,A,C),N.return=v,v=N)}return o(v);case Hc:e:{for(V=C.key;A!==null;){if(A.key===V)if(A.tag===4&&A.stateNode.containerInfo===C.containerInfo&&A.stateNode.implementation===C.implementation){t(v,A.sibling),A=i(A,C.children||[]),A.return=v,v=A;break e}else{t(v,A);break}else e(v,A);A=A.sibling}A=Sw(C,v.mode,N),A.return=v,v=A}return o(v);case _o:return V=C._init,k(v,A,V(C._payload),N)}if(kd(C))return y(v,A,C,N);if(gd(C))return E(v,A,C,N);pm(v,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,A!==null&&A.tag===6?(t(v,A.sibling),A=i(A,C),A.return=v,v=A):(t(v,A),A=Tw(C,v.mode,N),A.return=v,v=A),o(v)):t(v,A)}return k}var xh=JC(!0),ZC=JC(!1),Uy=Ca(null),By=null,Zc=null,ab=null;function lb(){ab=Zc=By=null}function cb(n){var e=Uy.current;rt(Uy),n._currentValue=e}function R0(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function uu(n,e){By=n,ab=Zc=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(rs=!0),n.firstContext=null)}function Xs(n){var e=n._currentValue;if(ab!==n)if(n={context:n,memoizedValue:e,next:null},Zc===null){if(By===null)throw Error(G(308));Zc=n,By.dependencies={lanes:0,firstContext:n}}else Zc=Zc.next=n;return e}var Xa=null;function ub(n){Xa===null?Xa=[n]:Xa.push(n)}function ek(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,ub(e)):(t.next=i.next,i.next=t),e.interleaved=t,so(n,s)}function so(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var vo=!1;function hb(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tk(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Qr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function la(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,Le&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,so(n,t)}return i=s.interleaved,i===null?(e.next=e,ub(s)):(e.next=i.next,i.next=e),s.interleaved=e,so(n,t)}function Fm(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,YA(n,t)}}function T1(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=o:r=r.next=o,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function zy(n,e,t,s){var i=n.updateQueue;vo=!1;var r=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?r=u:o.next=u,o=l;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(r!==null){var f=i.baseState;o=0,d=u=l=null,a=r;do{var p=a.lane,m=a.eventTime;if((s&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,E=a;switch(p=e,m=t,E.tag){case 1:if(y=E.payload,typeof y=="function"){f=y.call(m,f,p);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=E.payload,p=typeof y=="function"?y.call(m,f,p):y,p==null)break e;f=_t({},f,p);break e;case 2:vo=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else m={eventTime:m,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=m,l=f):d=d.next=m,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);ic|=o,n.lanes=o,n.memoizedState=f}}function S1(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(G(191,i));i.call(s)}}}var vg={},Ji=Ca(vg),Pf=Ca(vg),Nf=Ca(vg);function Ya(n){if(n===vg)throw Error(G(174));return n}function db(n,e){switch(tt(Nf,e),tt(Pf,n),tt(Ji,vg),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:u0(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=u0(e,n)}rt(Ji),tt(Ji,e)}function Ih(){rt(Ji),rt(Pf),rt(Nf)}function nk(n){Ya(Nf.current);var e=Ya(Ji.current),t=u0(e,n.type);e!==t&&(tt(Pf,n),tt(Ji,t))}function fb(n){Pf.current===n&&(rt(Ji),rt(Pf))}var gt=Ca(0);function $y(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var _w=[];function pb(){for(var n=0;n<_w.length;n++)_w[n]._workInProgressVersionPrimary=null;_w.length=0}var Vm=uo.ReactCurrentDispatcher,vw=uo.ReactCurrentBatchConfig,sc=0,yt=null,jt=null,Jt=null,Hy=!1,of=!1,Df=0,WM=0;function yn(){throw Error(G(321))}function gb(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!bi(n[t],e[t]))return!1;return!0}function mb(n,e,t,s,i,r){if(sc=r,yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Vm.current=n===null||n.memoizedState===null?XM:YM,n=t(s,i),of){r=0;do{if(of=!1,Df=0,25<=r)throw Error(G(301));r+=1,Jt=jt=null,e.updateQueue=null,Vm.current=QM,n=t(s,i)}while(of)}if(Vm.current=Wy,e=jt!==null&&jt.next!==null,sc=0,Jt=jt=yt=null,Hy=!1,e)throw Error(G(300));return n}function yb(){var n=Df!==0;return Df=0,n}function Ri(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?yt.memoizedState=Jt=n:Jt=Jt.next=n,Jt}function Ys(){if(jt===null){var n=yt.alternate;n=n!==null?n.memoizedState:null}else n=jt.next;var e=Jt===null?yt.memoizedState:Jt.next;if(e!==null)Jt=e,jt=n;else{if(n===null)throw Error(G(310));jt=n,n={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Jt===null?yt.memoizedState=Jt=n:Jt=Jt.next=n}return Jt}function Lf(n,e){return typeof e=="function"?e(n):e}function ww(n){var e=Ys(),t=e.queue;if(t===null)throw Error(G(311));t.lastRenderedReducer=n;var s=jt,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var o=i.next;i.next=r.next,r.next=o}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var a=o=null,l=null,u=r;do{var d=u.lane;if((sc&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=s):l=l.next=f,yt.lanes|=d,ic|=d}u=u.next}while(u!==null&&u!==r);l===null?o=s:l.next=a,bi(s,e.memoizedState)||(rs=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=l,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,yt.lanes|=r,ic|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Ew(n){var e=Ys(),t=e.queue;if(t===null)throw Error(G(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do r=n(r,o.action),o=o.next;while(o!==i);bi(r,e.memoizedState)||(rs=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function sk(){}function ik(n,e){var t=yt,s=Ys(),i=e(),r=!bi(s.memoizedState,i);if(r&&(s.memoizedState=i,rs=!0),s=s.queue,_b(ak.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||Jt!==null&&Jt.memoizedState.tag&1){if(t.flags|=2048,Mf(9,ok.bind(null,t,s,i,e),void 0,null),Zt===null)throw Error(G(349));sc&30||rk(t,e,i)}return i}function rk(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function ok(n,e,t,s){e.value=t,e.getSnapshot=s,lk(e)&&ck(n)}function ak(n,e,t){return t(function(){lk(e)&&ck(n)})}function lk(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!bi(n,t)}catch{return!0}}function ck(n){var e=so(n,1);e!==null&&Ei(e,n,1,-1)}function x1(n){var e=Ri();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Lf,lastRenderedState:n},e.queue=n,n=n.dispatch=KM.bind(null,yt,n),[e.memoizedState,n]}function Mf(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function uk(){return Ys().memoizedState}function jm(n,e,t,s){var i=Ri();yt.flags|=n,i.memoizedState=Mf(1|e,t,void 0,s===void 0?null:s)}function q_(n,e,t,s){var i=Ys();s=s===void 0?null:s;var r=void 0;if(jt!==null){var o=jt.memoizedState;if(r=o.destroy,s!==null&&gb(s,o.deps)){i.memoizedState=Mf(e,t,r,s);return}}yt.flags|=n,i.memoizedState=Mf(1|e,t,r,s)}function I1(n,e){return jm(8390656,8,n,e)}function _b(n,e){return q_(2048,8,n,e)}function hk(n,e){return q_(4,2,n,e)}function dk(n,e){return q_(4,4,n,e)}function fk(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function pk(n,e,t){return t=t!=null?t.concat([n]):null,q_(4,4,fk.bind(null,e,n),t)}function vb(){}function gk(n,e){var t=Ys();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&gb(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function mk(n,e){var t=Ys();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&gb(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function yk(n,e,t){return sc&21?(bi(t,e)||(t=AC(),yt.lanes|=t,ic|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,rs=!0),n.memoizedState=t)}function GM(n,e){var t=He;He=t!==0&&4>t?t:4,n(!0);var s=vw.transition;vw.transition={};try{n(!1),e()}finally{He=t,vw.transition=s}}function _k(){return Ys().memoizedState}function qM(n,e,t){var s=ua(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},vk(n))wk(e,t);else if(t=ek(n,e,t,s),t!==null){var i=$n();Ei(t,n,s,i),Ek(t,e,s)}}function KM(n,e,t){var s=ua(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(vk(n))wk(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var o=e.lastRenderedState,a=r(o,t);if(i.hasEagerState=!0,i.eagerState=a,bi(a,o)){var l=e.interleaved;l===null?(i.next=i,ub(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=ek(n,e,i,s),t!==null&&(i=$n(),Ei(t,n,s,i),Ek(t,e,s))}}function vk(n){var e=n.alternate;return n===yt||e!==null&&e===yt}function wk(n,e){of=Hy=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Ek(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,YA(n,t)}}var Wy={readContext:Xs,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useInsertionEffect:yn,useLayoutEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useMutableSource:yn,useSyncExternalStore:yn,useId:yn,unstable_isNewReconciler:!1},XM={readContext:Xs,useCallback:function(n,e){return Ri().memoizedState=[n,e===void 0?null:e],n},useContext:Xs,useEffect:I1,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,jm(4194308,4,fk.bind(null,e,n),t)},useLayoutEffect:function(n,e){return jm(4194308,4,n,e)},useInsertionEffect:function(n,e){return jm(4,2,n,e)},useMemo:function(n,e){var t=Ri();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=Ri();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=qM.bind(null,yt,n),[s.memoizedState,n]},useRef:function(n){var e=Ri();return n={current:n},e.memoizedState=n},useState:x1,useDebugValue:vb,useDeferredValue:function(n){return Ri().memoizedState=n},useTransition:function(){var n=x1(!1),e=n[0];return n=GM.bind(null,n[1]),Ri().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=yt,i=Ri();if(ut){if(t===void 0)throw Error(G(407));t=t()}else{if(t=e(),Zt===null)throw Error(G(349));sc&30||rk(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,I1(ak.bind(null,s,r,n),[n]),s.flags|=2048,Mf(9,ok.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=Ri(),e=Zt.identifierPrefix;if(ut){var t=Gr,s=Wr;t=(s&~(1<<32-wi(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=Df++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=WM++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},YM={readContext:Xs,useCallback:gk,useContext:Xs,useEffect:_b,useImperativeHandle:pk,useInsertionEffect:hk,useLayoutEffect:dk,useMemo:mk,useReducer:ww,useRef:uk,useState:function(){return ww(Lf)},useDebugValue:vb,useDeferredValue:function(n){var e=Ys();return yk(e,jt.memoizedState,n)},useTransition:function(){var n=ww(Lf)[0],e=Ys().memoizedState;return[n,e]},useMutableSource:sk,useSyncExternalStore:ik,useId:_k,unstable_isNewReconciler:!1},QM={readContext:Xs,useCallback:gk,useContext:Xs,useEffect:_b,useImperativeHandle:pk,useInsertionEffect:hk,useLayoutEffect:dk,useMemo:mk,useReducer:Ew,useRef:uk,useState:function(){return Ew(Lf)},useDebugValue:vb,useDeferredValue:function(n){var e=Ys();return jt===null?e.memoizedState=n:yk(e,jt.memoizedState,n)},useTransition:function(){var n=Ew(Lf)[0],e=Ys().memoizedState;return[n,e]},useMutableSource:sk,useSyncExternalStore:ik,useId:_k,unstable_isNewReconciler:!1};function ti(n,e){if(n&&n.defaultProps){e=_t({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function P0(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:_t({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var K_={isMounted:function(n){return(n=n._reactInternals)?yc(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=$n(),i=ua(n),r=Qr(s,i);r.payload=e,t!=null&&(r.callback=t),e=la(n,r,i),e!==null&&(Ei(e,n,i,s),Fm(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=$n(),i=ua(n),r=Qr(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=la(n,r,i),e!==null&&(Ei(e,n,i,s),Fm(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=$n(),s=ua(n),i=Qr(t,s);i.tag=2,e!=null&&(i.callback=e),e=la(n,i,s),e!==null&&(Ei(e,n,s,t),Fm(e,n,s))}};function C1(n,e,t,s,i,r,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,o):e.prototype&&e.prototype.isPureReactComponent?!If(t,s)||!If(i,r):!0}function Ak(n,e,t){var s=!1,i=_a,r=e.contextType;return typeof r=="object"&&r!==null?r=Xs(r):(i=as(e)?tc:Pn.current,s=e.contextTypes,r=(s=s!=null)?Th(n,i):_a),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=K_,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function k1(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&K_.enqueueReplaceState(e,e.state,null)}function N0(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},hb(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=Xs(r):(r=as(e)?tc:Pn.current,i.context=Th(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(P0(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&K_.enqueueReplaceState(i,i.state,null),zy(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Ch(n,e){try{var t="",s=e;do t+=SL(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function Aw(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function D0(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var JM=typeof WeakMap=="function"?WeakMap:Map;function bk(n,e,t){t=Qr(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){qy||(qy=!0,$0=s),D0(n,e)},t}function Tk(n,e,t){t=Qr(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){D0(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){D0(n,e),typeof s!="function"&&(ca===null?ca=new Set([this]):ca.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function R1(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new JM;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=dO.bind(null,n,e,t),e.then(n,n))}function P1(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function N1(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Qr(-1,1),e.tag=2,la(t,e,1))),t.lanes|=1),n)}var ZM=uo.ReactCurrentOwner,rs=!1;function Un(n,e,t,s){e.child=n===null?ZC(e,null,t,s):xh(e,n.child,t,s)}function D1(n,e,t,s,i){t=t.render;var r=e.ref;return uu(e,i),s=mb(n,e,t,s,r,i),t=yb(),n!==null&&!rs?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,io(n,e,i)):(ut&&t&&ib(e),e.flags|=1,Un(n,e,s,i),e.child)}function L1(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!Ib(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,Sk(n,e,r,s,i)):(n=$m(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var o=r.memoizedProps;if(t=t.compare,t=t!==null?t:If,t(o,s)&&n.ref===e.ref)return io(n,e,i)}return e.flags|=1,n=ha(r,s),n.ref=e.ref,n.return=e,e.child=n}function Sk(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(If(r,s)&&n.ref===e.ref)if(rs=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(rs=!0);else return e.lanes=n.lanes,io(n,e,i)}return L0(n,e,t,s,i)}function xk(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},tt(tu,Es),Es|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,tt(tu,Es),Es|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,tt(tu,Es),Es|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,tt(tu,Es),Es|=s;return Un(n,e,i,t),e.child}function Ik(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function L0(n,e,t,s,i){var r=as(t)?tc:Pn.current;return r=Th(e,r),uu(e,i),t=mb(n,e,t,s,r,i),s=yb(),n!==null&&!rs?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,io(n,e,i)):(ut&&s&&ib(e),e.flags|=1,Un(n,e,t,i),e.child)}function M1(n,e,t,s,i){if(as(t)){var r=!0;Fy(e)}else r=!1;if(uu(e,i),e.stateNode===null)Um(n,e),Ak(e,t,s),N0(e,t,s,i),s=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Xs(u):(u=as(t)?tc:Pn.current,u=Th(e,u));var d=t.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||l!==u)&&k1(e,o,s,u),vo=!1;var p=e.memoizedState;o.state=p,zy(e,s,o,i),l=e.memoizedState,a!==s||p!==l||os.current||vo?(typeof d=="function"&&(P0(e,t,d,s),l=e.memoizedState),(a=vo||C1(e,t,a,s,p,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),o.props=s,o.state=l,o.context=u,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,tk(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:ti(e.type,a),o.props=u,f=e.pendingProps,p=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Xs(l):(l=as(t)?tc:Pn.current,l=Th(e,l));var m=t.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||p!==l)&&k1(e,o,s,l),vo=!1,p=e.memoizedState,o.state=p,zy(e,s,o,i);var y=e.memoizedState;a!==f||p!==y||os.current||vo?(typeof m=="function"&&(P0(e,t,m,s),y=e.memoizedState),(u=vo||C1(e,t,u,s,p,y,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=y),o.props=s,o.state=y,o.context=l,s=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),s=!1)}return M0(n,e,t,s,r,i)}function M0(n,e,t,s,i,r){Ik(n,e);var o=(e.flags&128)!==0;if(!s&&!o)return i&&w1(e,t,!1),io(n,e,r);s=e.stateNode,ZM.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&o?(e.child=xh(e,n.child,null,r),e.child=xh(e,null,a,r)):Un(n,e,a,r),e.memoizedState=s.state,i&&w1(e,t,!0),e.child}function Ck(n){var e=n.stateNode;e.pendingContext?v1(n,e.pendingContext,e.pendingContext!==e.context):e.context&&v1(n,e.context,!1),db(n,e.containerInfo)}function O1(n,e,t,s,i){return Sh(),ob(i),e.flags|=256,Un(n,e,t,s),e.child}var O0={dehydrated:null,treeContext:null,retryLane:0};function F0(n){return{baseLanes:n,cachePool:null,transitions:null}}function kk(n,e,t){var s=e.pendingProps,i=gt.current,r=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),tt(gt,i&1),n===null)return k0(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,n=s.fallback,r?(s=e.mode,r=e.child,o={mode:"hidden",children:o},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=Q_(o,s,0,null),n=Ql(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=F0(t),e.memoizedState=O0,n):wb(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return eO(n,e,o,s,a,i,t);if(r){r=s.fallback,o=e.mode,i=n.child,a=i.sibling;var l={mode:"hidden",children:s.children};return!(o&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=ha(i,l),s.subtreeFlags=i.subtreeFlags&14680064),a!==null?r=ha(a,r):(r=Ql(r,o,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,o=n.child.memoizedState,o=o===null?F0(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=n.childLanes&~t,e.memoizedState=O0,s}return r=n.child,n=r.sibling,s=ha(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function wb(n,e){return e=Q_({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function gm(n,e,t,s){return s!==null&&ob(s),xh(e,n.child,null,t),n=wb(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function eO(n,e,t,s,i,r,o){if(t)return e.flags&256?(e.flags&=-257,s=Aw(Error(G(422))),gm(n,e,o,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=Q_({mode:"visible",children:s.children},i,0,null),r=Ql(r,i,o,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&xh(e,n.child,null,o),e.child.memoizedState=F0(o),e.memoizedState=O0,r);if(!(e.mode&1))return gm(n,e,o,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var a=s.dgst;return s=a,r=Error(G(419)),s=Aw(r,s,void 0),gm(n,e,o,s)}if(a=(o&n.childLanes)!==0,rs||a){if(s=Zt,s!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|o)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,so(n,i),Ei(s,n,i,-1))}return xb(),s=Aw(Error(G(421))),gm(n,e,o,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=fO.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,bs=aa(i.nextSibling),Ss=e,ut=!0,yi=null,n!==null&&(zs[$s++]=Wr,zs[$s++]=Gr,zs[$s++]=nc,Wr=n.id,Gr=n.overflow,nc=e),e=wb(e,s.children),e.flags|=4096,e)}function F1(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),R0(n.return,e,t)}function bw(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function Rk(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(Un(n,e,s.children,t),s=gt.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&F1(n,t,e);else if(n.tag===19)F1(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(tt(gt,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&$y(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),bw(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&$y(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}bw(e,!0,t,null,r);break;case"together":bw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Um(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function io(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ic|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(G(153));if(e.child!==null){for(n=e.child,t=ha(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=ha(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function tO(n,e,t){switch(e.tag){case 3:Ck(e),Sh();break;case 5:nk(e);break;case 1:as(e.type)&&Fy(e);break;case 4:db(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;tt(Uy,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(tt(gt,gt.current&1),e.flags|=128,null):t&e.child.childLanes?kk(n,e,t):(tt(gt,gt.current&1),n=io(n,e,t),n!==null?n.sibling:null);tt(gt,gt.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return Rk(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),tt(gt,gt.current),s)break;return null;case 22:case 23:return e.lanes=0,xk(n,e,t)}return io(n,e,t)}var Pk,V0,Nk,Dk;Pk=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};V0=function(){};Nk=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,Ya(Ji.current);var r=null;switch(t){case"input":i=o0(n,i),s=o0(n,s),r=[];break;case"select":i=_t({},i,{value:void 0}),s=_t({},s,{value:void 0}),r=[];break;case"textarea":i=c0(n,i),s=c0(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=My)}h0(t,s);var o;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(wf.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var l=s[u];if(a=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(r||(r=[]),r.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(r=r||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(r=r||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(wf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&it("scroll",n),r||a===l||(r=[])):(r=r||[]).push(u,l))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};Dk=function(n,e,t,s){t!==s&&(e.flags|=4)};function Ed(n,e){if(!ut)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function _n(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function nO(n,e,t){var s=e.pendingProps;switch(rb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(e),null;case 1:return as(e.type)&&Oy(),_n(e),null;case 3:return s=e.stateNode,Ih(),rt(os),rt(Pn),pb(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(fm(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,yi!==null&&(G0(yi),yi=null))),V0(n,e),_n(e),null;case 5:fb(e);var i=Ya(Nf.current);if(t=e.type,n!==null&&e.stateNode!=null)Nk(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(G(166));return _n(e),null}if(n=Ya(Ji.current),fm(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[Xi]=e,s[Rf]=r,n=(e.mode&1)!==0,t){case"dialog":it("cancel",s),it("close",s);break;case"iframe":case"object":case"embed":it("load",s);break;case"video":case"audio":for(i=0;i<Pd.length;i++)it(Pd[i],s);break;case"source":it("error",s);break;case"img":case"image":case"link":it("error",s),it("load",s);break;case"details":it("toggle",s);break;case"input":GS(s,r),it("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},it("invalid",s);break;case"textarea":KS(s,r),it("invalid",s)}h0(t,r),i=null;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];o==="children"?typeof a=="string"?s.textContent!==a&&(r.suppressHydrationWarning!==!0&&dm(s.textContent,a,n),i=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(r.suppressHydrationWarning!==!0&&dm(s.textContent,a,n),i=["children",""+a]):wf.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&it("scroll",s)}switch(t){case"input":im(s),qS(s,r,!0);break;case"textarea":im(s),XS(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=My)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=aC(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=o.createElement(t,{is:s.is}):(n=o.createElement(t),t==="select"&&(o=n,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):n=o.createElementNS(n,t),n[Xi]=e,n[Rf]=s,Pk(n,e,!1,!1),e.stateNode=n;e:{switch(o=d0(t,s),t){case"dialog":it("cancel",n),it("close",n),i=s;break;case"iframe":case"object":case"embed":it("load",n),i=s;break;case"video":case"audio":for(i=0;i<Pd.length;i++)it(Pd[i],n);i=s;break;case"source":it("error",n),i=s;break;case"img":case"image":case"link":it("error",n),it("load",n),i=s;break;case"details":it("toggle",n),i=s;break;case"input":GS(n,s),i=o0(n,s),it("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=_t({},s,{value:void 0}),it("invalid",n);break;case"textarea":KS(n,s),i=c0(n,s),it("invalid",n);break;default:i=s}h0(t,i),a=i;for(r in a)if(a.hasOwnProperty(r)){var l=a[r];r==="style"?uC(n,l):r==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&lC(n,l)):r==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Ef(n,l):typeof l=="number"&&Ef(n,""+l):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(wf.hasOwnProperty(r)?l!=null&&r==="onScroll"&&it("scroll",n):l!=null&&HA(n,r,l,o))}switch(t){case"input":im(n),qS(n,s,!1);break;case"textarea":im(n),XS(n);break;case"option":s.value!=null&&n.setAttribute("value",""+ya(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?ou(n,!!s.multiple,r,!1):s.defaultValue!=null&&ou(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=My)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _n(e),null;case 6:if(n&&e.stateNode!=null)Dk(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(G(166));if(t=Ya(Nf.current),Ya(Ji.current),fm(e)){if(s=e.stateNode,t=e.memoizedProps,s[Xi]=e,(r=s.nodeValue!==t)&&(n=Ss,n!==null))switch(n.tag){case 3:dm(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&dm(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[Xi]=e,e.stateNode=s}return _n(e),null;case 13:if(rt(gt),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ut&&bs!==null&&e.mode&1&&!(e.flags&128))QC(),Sh(),e.flags|=98560,r=!1;else if(r=fm(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(G(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(G(317));r[Xi]=e}else Sh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_n(e),r=!1}else yi!==null&&(G0(yi),yi=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||gt.current&1?Bt===0&&(Bt=3):xb())),e.updateQueue!==null&&(e.flags|=4),_n(e),null);case 4:return Ih(),V0(n,e),n===null&&Cf(e.stateNode.containerInfo),_n(e),null;case 10:return cb(e.type._context),_n(e),null;case 17:return as(e.type)&&Oy(),_n(e),null;case 19:if(rt(gt),r=e.memoizedState,r===null)return _n(e),null;if(s=(e.flags&128)!==0,o=r.rendering,o===null)if(s)Ed(r,!1);else{if(Bt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=$y(n),o!==null){for(e.flags|=128,Ed(r,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return tt(gt,gt.current&1|2),e.child}n=n.sibling}r.tail!==null&&Ct()>kh&&(e.flags|=128,s=!0,Ed(r,!1),e.lanes=4194304)}else{if(!s)if(n=$y(o),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Ed(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!ut)return _n(e),null}else 2*Ct()-r.renderingStartTime>kh&&t!==1073741824&&(e.flags|=128,s=!0,Ed(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(t=r.last,t!==null?t.sibling=o:e.child=o,r.last=o)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Ct(),e.sibling=null,t=gt.current,tt(gt,s?t&1|2:t&1),e):(_n(e),null);case 22:case 23:return Sb(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Es&1073741824&&(_n(e),e.subtreeFlags&6&&(e.flags|=8192)):_n(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function sO(n,e){switch(rb(e),e.tag){case 1:return as(e.type)&&Oy(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Ih(),rt(os),rt(Pn),pb(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return fb(e),null;case 13:if(rt(gt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(G(340));Sh()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return rt(gt),null;case 4:return Ih(),null;case 10:return cb(e.type._context),null;case 22:case 23:return Sb(),null;case 24:return null;default:return null}}var mm=!1,kn=!1,iO=typeof WeakSet=="function"?WeakSet:Set,te=null;function eu(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){At(n,e,s)}else t.current=null}function j0(n,e,t){try{t()}catch(s){At(n,e,s)}}var V1=!1;function rO(n,e){if(A0=Ny,n=VC(),sb(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,d=0,f=n,p=null;t:for(;;){for(var m;f!==t||i!==0&&f.nodeType!==3||(a=o+i),f!==r||s!==0&&f.nodeType!==3||(l=o+s),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===n)break t;if(p===t&&++u===i&&(a=o),p===r&&++d===s&&(l=o),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(b0={focusedElem:n,selectionRange:t},Ny=!1,te=e;te!==null;)if(e=te,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,te=n;else for(;te!==null;){e=te;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var E=y.memoizedProps,k=y.memoizedState,v=e.stateNode,A=v.getSnapshotBeforeUpdate(e.elementType===e.type?E:ti(e.type,E),k);v.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(N){At(e,e.return,N)}if(n=e.sibling,n!==null){n.return=e.return,te=n;break}te=e.return}return y=V1,V1=!1,y}function af(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&j0(e,t,r)}i=i.next}while(i!==s)}}function X_(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function U0(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Lk(n){var e=n.alternate;e!==null&&(n.alternate=null,Lk(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Xi],delete e[Rf],delete e[x0],delete e[BM],delete e[zM])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Mk(n){return n.tag===5||n.tag===3||n.tag===4}function j1(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Mk(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function B0(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=My));else if(s!==4&&(n=n.child,n!==null))for(B0(n,e,t),n=n.sibling;n!==null;)B0(n,e,t),n=n.sibling}function z0(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(z0(n,e,t),n=n.sibling;n!==null;)z0(n,e,t),n=n.sibling}var an=null,mi=!1;function go(n,e,t){for(t=t.child;t!==null;)Ok(n,e,t),t=t.sibling}function Ok(n,e,t){if(Qi&&typeof Qi.onCommitFiberUnmount=="function")try{Qi.onCommitFiberUnmount(B_,t)}catch{}switch(t.tag){case 5:kn||eu(t,e);case 6:var s=an,i=mi;an=null,go(n,e,t),an=s,mi=i,an!==null&&(mi?(n=an,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):an.removeChild(t.stateNode));break;case 18:an!==null&&(mi?(n=an,t=t.stateNode,n.nodeType===8?mw(n.parentNode,t):n.nodeType===1&&mw(n,t),Sf(n)):mw(an,t.stateNode));break;case 4:s=an,i=mi,an=t.stateNode.containerInfo,mi=!0,go(n,e,t),an=s,mi=i;break;case 0:case 11:case 14:case 15:if(!kn&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&j0(t,e,o),i=i.next}while(i!==s)}go(n,e,t);break;case 1:if(!kn&&(eu(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(a){At(t,e,a)}go(n,e,t);break;case 21:go(n,e,t);break;case 22:t.mode&1?(kn=(s=kn)||t.memoizedState!==null,go(n,e,t),kn=s):go(n,e,t);break;default:go(n,e,t)}}function U1(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new iO),e.forEach(function(s){var i=pO.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function Zs(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:an=a.stateNode,mi=!1;break e;case 3:an=a.stateNode.containerInfo,mi=!0;break e;case 4:an=a.stateNode.containerInfo,mi=!0;break e}a=a.return}if(an===null)throw Error(G(160));Ok(r,o,i),an=null,mi=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){At(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Fk(e,n),e=e.sibling}function Fk(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Zs(e,n),xi(n),s&4){try{af(3,n,n.return),X_(3,n)}catch(E){At(n,n.return,E)}try{af(5,n,n.return)}catch(E){At(n,n.return,E)}}break;case 1:Zs(e,n),xi(n),s&512&&t!==null&&eu(t,t.return);break;case 5:if(Zs(e,n),xi(n),s&512&&t!==null&&eu(t,t.return),n.flags&32){var i=n.stateNode;try{Ef(i,"")}catch(E){At(n,n.return,E)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,o=t!==null?t.memoizedProps:r,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&r.type==="radio"&&r.name!=null&&rC(i,r),d0(a,o);var u=d0(a,r);for(o=0;o<l.length;o+=2){var d=l[o],f=l[o+1];d==="style"?uC(i,f):d==="dangerouslySetInnerHTML"?lC(i,f):d==="children"?Ef(i,f):HA(i,d,f,u)}switch(a){case"input":a0(i,r);break;case"textarea":oC(i,r);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var m=r.value;m!=null?ou(i,!!r.multiple,m,!1):p!==!!r.multiple&&(r.defaultValue!=null?ou(i,!!r.multiple,r.defaultValue,!0):ou(i,!!r.multiple,r.multiple?[]:"",!1))}i[Rf]=r}catch(E){At(n,n.return,E)}}break;case 6:if(Zs(e,n),xi(n),s&4){if(n.stateNode===null)throw Error(G(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(E){At(n,n.return,E)}}break;case 3:if(Zs(e,n),xi(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Sf(e.containerInfo)}catch(E){At(n,n.return,E)}break;case 4:Zs(e,n),xi(n);break;case 13:Zs(e,n),xi(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(bb=Ct())),s&4&&U1(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(kn=(u=kn)||d,Zs(e,n),kn=u):Zs(e,n),xi(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!d&&n.mode&1)for(te=n,d=n.child;d!==null;){for(f=te=d;te!==null;){switch(p=te,m=p.child,p.tag){case 0:case 11:case 14:case 15:af(4,p,p.return);break;case 1:eu(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){s=p,t=p.return;try{e=s,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(E){At(s,t,E)}}break;case 5:eu(p,p.return);break;case 22:if(p.memoizedState!==null){z1(f);continue}}m!==null?(m.return=p,te=m):z1(f)}d=d.sibling}e:for(d=null,f=n;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=cC("display",o))}catch(E){At(n,n.return,E)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(E){At(n,n.return,E)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Zs(e,n),xi(n),s&4&&U1(n);break;case 21:break;default:Zs(e,n),xi(n)}}function xi(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Mk(t)){var s=t;break e}t=t.return}throw Error(G(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(Ef(i,""),s.flags&=-33);var r=j1(n);z0(n,r,i);break;case 3:case 4:var o=s.stateNode.containerInfo,a=j1(n);B0(n,a,o);break;default:throw Error(G(161))}}catch(l){At(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function oO(n,e,t){te=n,Vk(n)}function Vk(n,e,t){for(var s=(n.mode&1)!==0;te!==null;){var i=te,r=i.child;if(i.tag===22&&s){var o=i.memoizedState!==null||mm;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||kn;a=mm;var u=kn;if(mm=o,(kn=l)&&!u)for(te=i;te!==null;)o=te,l=o.child,o.tag===22&&o.memoizedState!==null?$1(i):l!==null?(l.return=o,te=l):$1(i);for(;r!==null;)te=r,Vk(r),r=r.sibling;te=i,mm=a,kn=u}B1(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,te=r):B1(n)}}function B1(n){for(;te!==null;){var e=te;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:kn||X_(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!kn)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:ti(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&S1(e,r,s);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}S1(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Sf(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}kn||e.flags&512&&U0(e)}catch(p){At(e,e.return,p)}}if(e===n){te=null;break}if(t=e.sibling,t!==null){t.return=e.return,te=t;break}te=e.return}}function z1(n){for(;te!==null;){var e=te;if(e===n){te=null;break}var t=e.sibling;if(t!==null){t.return=e.return,te=t;break}te=e.return}}function $1(n){for(;te!==null;){var e=te;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{X_(4,e)}catch(l){At(e,t,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(l){At(e,i,l)}}var r=e.return;try{U0(e)}catch(l){At(e,r,l)}break;case 5:var o=e.return;try{U0(e)}catch(l){At(e,o,l)}}}catch(l){At(e,e.return,l)}if(e===n){te=null;break}var a=e.sibling;if(a!==null){a.return=e.return,te=a;break}te=e.return}}var aO=Math.ceil,Gy=uo.ReactCurrentDispatcher,Eb=uo.ReactCurrentOwner,qs=uo.ReactCurrentBatchConfig,Le=0,Zt=null,Nt=null,hn=0,Es=0,tu=Ca(0),Bt=0,Of=null,ic=0,Y_=0,Ab=0,lf=null,ss=null,bb=0,kh=1/0,mr=null,qy=!1,$0=null,ca=null,ym=!1,na=null,Ky=0,cf=0,H0=null,Bm=-1,zm=0;function $n(){return Le&6?Ct():Bm!==-1?Bm:Bm=Ct()}function ua(n){return n.mode&1?Le&2&&hn!==0?hn&-hn:HM.transition!==null?(zm===0&&(zm=AC()),zm):(n=He,n!==0||(n=window.event,n=n===void 0?16:kC(n.type)),n):1}function Ei(n,e,t,s){if(50<cf)throw cf=0,H0=null,Error(G(185));mg(n,t,s),(!(Le&2)||n!==Zt)&&(n===Zt&&(!(Le&2)&&(Y_|=t),Bt===4&&Eo(n,hn)),ls(n,s),t===1&&Le===0&&!(e.mode&1)&&(kh=Ct()+500,G_&&ka()))}function ls(n,e){var t=n.callbackNode;HL(n,e);var s=Py(n,n===Zt?hn:0);if(s===0)t!==null&&JS(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&JS(t),e===1)n.tag===0?$M(H1.bind(null,n)):KC(H1.bind(null,n)),jM(function(){!(Le&6)&&ka()}),t=null;else{switch(bC(s)){case 1:t=XA;break;case 4:t=wC;break;case 16:t=Ry;break;case 536870912:t=EC;break;default:t=Ry}t=Gk(t,jk.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function jk(n,e){if(Bm=-1,zm=0,Le&6)throw Error(G(327));var t=n.callbackNode;if(hu()&&n.callbackNode!==t)return null;var s=Py(n,n===Zt?hn:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=Xy(n,s);else{e=s;var i=Le;Le|=2;var r=Bk();(Zt!==n||hn!==e)&&(mr=null,kh=Ct()+500,Yl(n,e));do try{uO();break}catch(a){Uk(n,a)}while(!0);lb(),Gy.current=r,Le=i,Nt!==null?e=0:(Zt=null,hn=0,e=Bt)}if(e!==0){if(e===2&&(i=y0(n),i!==0&&(s=i,e=W0(n,i))),e===1)throw t=Of,Yl(n,0),Eo(n,s),ls(n,Ct()),t;if(e===6)Eo(n,s);else{if(i=n.current.alternate,!(s&30)&&!lO(i)&&(e=Xy(n,s),e===2&&(r=y0(n),r!==0&&(s=r,e=W0(n,r))),e===1))throw t=Of,Yl(n,0),Eo(n,s),ls(n,Ct()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(G(345));case 2:Ua(n,ss,mr);break;case 3:if(Eo(n,s),(s&130023424)===s&&(e=bb+500-Ct(),10<e)){if(Py(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){$n(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=S0(Ua.bind(null,n,ss,mr),e);break}Ua(n,ss,mr);break;case 4:if(Eo(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var o=31-wi(s);r=1<<o,o=e[o],o>i&&(i=o),s&=~r}if(s=i,s=Ct()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*aO(s/1960))-s,10<s){n.timeoutHandle=S0(Ua.bind(null,n,ss,mr),s);break}Ua(n,ss,mr);break;case 5:Ua(n,ss,mr);break;default:throw Error(G(329))}}}return ls(n,Ct()),n.callbackNode===t?jk.bind(null,n):null}function W0(n,e){var t=lf;return n.current.memoizedState.isDehydrated&&(Yl(n,e).flags|=256),n=Xy(n,e),n!==2&&(e=ss,ss=t,e!==null&&G0(e)),n}function G0(n){ss===null?ss=n:ss.push.apply(ss,n)}function lO(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!bi(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Eo(n,e){for(e&=~Ab,e&=~Y_,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-wi(e),s=1<<t;n[t]=-1,e&=~s}}function H1(n){if(Le&6)throw Error(G(327));hu();var e=Py(n,0);if(!(e&1))return ls(n,Ct()),null;var t=Xy(n,e);if(n.tag!==0&&t===2){var s=y0(n);s!==0&&(e=s,t=W0(n,s))}if(t===1)throw t=Of,Yl(n,0),Eo(n,e),ls(n,Ct()),t;if(t===6)throw Error(G(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Ua(n,ss,mr),ls(n,Ct()),null}function Tb(n,e){var t=Le;Le|=1;try{return n(e)}finally{Le=t,Le===0&&(kh=Ct()+500,G_&&ka())}}function rc(n){na!==null&&na.tag===0&&!(Le&6)&&hu();var e=Le;Le|=1;var t=qs.transition,s=He;try{if(qs.transition=null,He=1,n)return n()}finally{He=s,qs.transition=t,Le=e,!(Le&6)&&ka()}}function Sb(){Es=tu.current,rt(tu)}function Yl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,VM(t)),Nt!==null)for(t=Nt.return;t!==null;){var s=t;switch(rb(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Oy();break;case 3:Ih(),rt(os),rt(Pn),pb();break;case 5:fb(s);break;case 4:Ih();break;case 13:rt(gt);break;case 19:rt(gt);break;case 10:cb(s.type._context);break;case 22:case 23:Sb()}t=t.return}if(Zt=n,Nt=n=ha(n.current,null),hn=Es=e,Bt=0,Of=null,Ab=Y_=ic=0,ss=lf=null,Xa!==null){for(e=0;e<Xa.length;e++)if(t=Xa[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var o=r.next;r.next=i,s.next=o}t.pending=s}Xa=null}return n}function Uk(n,e){do{var t=Nt;try{if(lb(),Vm.current=Wy,Hy){for(var s=yt.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Hy=!1}if(sc=0,Jt=jt=yt=null,of=!1,Df=0,Eb.current=null,t===null||t.return===null){Bt=1,Of=e,Nt=null;break}e:{var r=n,o=t.return,a=t,l=e;if(e=hn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=P1(o);if(m!==null){m.flags&=-257,N1(m,o,a,r,e),m.mode&1&&R1(r,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var E=new Set;E.add(l),e.updateQueue=E}else y.add(l);break e}else{if(!(e&1)){R1(r,u,e),xb();break e}l=Error(G(426))}}else if(ut&&a.mode&1){var k=P1(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),N1(k,o,a,r,e),ob(Ch(l,a));break e}}r=l=Ch(l,a),Bt!==4&&(Bt=2),lf===null?lf=[r]:lf.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var v=bk(r,l,e);T1(r,v);break e;case 1:a=l;var A=r.type,C=r.stateNode;if(!(r.flags&128)&&(typeof A.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(ca===null||!ca.has(C)))){r.flags|=65536,e&=-e,r.lanes|=e;var N=Tk(r,a,e);T1(r,N);break e}}r=r.return}while(r!==null)}$k(t)}catch(F){e=F,Nt===t&&t!==null&&(Nt=t=t.return);continue}break}while(!0)}function Bk(){var n=Gy.current;return Gy.current=Wy,n===null?Wy:n}function xb(){(Bt===0||Bt===3||Bt===2)&&(Bt=4),Zt===null||!(ic&268435455)&&!(Y_&268435455)||Eo(Zt,hn)}function Xy(n,e){var t=Le;Le|=2;var s=Bk();(Zt!==n||hn!==e)&&(mr=null,Yl(n,e));do try{cO();break}catch(i){Uk(n,i)}while(!0);if(lb(),Le=t,Gy.current=s,Nt!==null)throw Error(G(261));return Zt=null,hn=0,Bt}function cO(){for(;Nt!==null;)zk(Nt)}function uO(){for(;Nt!==null&&!ML();)zk(Nt)}function zk(n){var e=Wk(n.alternate,n,Es);n.memoizedProps=n.pendingProps,e===null?$k(n):Nt=e,Eb.current=null}function $k(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=sO(t,e),t!==null){t.flags&=32767,Nt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Bt=6,Nt=null;return}}else if(t=nO(t,e,Es),t!==null){Nt=t;return}if(e=e.sibling,e!==null){Nt=e;return}Nt=e=n}while(e!==null);Bt===0&&(Bt=5)}function Ua(n,e,t){var s=He,i=qs.transition;try{qs.transition=null,He=1,hO(n,e,t,s)}finally{qs.transition=i,He=s}return null}function hO(n,e,t,s){do hu();while(na!==null);if(Le&6)throw Error(G(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(G(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(WL(n,r),n===Zt&&(Nt=Zt=null,hn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||ym||(ym=!0,Gk(Ry,function(){return hu(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=qs.transition,qs.transition=null;var o=He;He=1;var a=Le;Le|=4,Eb.current=null,rO(n,t),Fk(t,n),PM(b0),Ny=!!A0,b0=A0=null,n.current=t,oO(t),OL(),Le=a,He=o,qs.transition=r}else n.current=t;if(ym&&(ym=!1,na=n,Ky=i),r=n.pendingLanes,r===0&&(ca=null),jL(t.stateNode),ls(n,Ct()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(qy)throw qy=!1,n=$0,$0=null,n;return Ky&1&&n.tag!==0&&hu(),r=n.pendingLanes,r&1?n===H0?cf++:(cf=0,H0=n):cf=0,ka(),null}function hu(){if(na!==null){var n=bC(Ky),e=qs.transition,t=He;try{if(qs.transition=null,He=16>n?16:n,na===null)var s=!1;else{if(n=na,na=null,Ky=0,Le&6)throw Error(G(331));var i=Le;for(Le|=4,te=n.current;te!==null;){var r=te,o=r.child;if(te.flags&16){var a=r.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(te=u;te!==null;){var d=te;switch(d.tag){case 0:case 11:case 15:af(8,d,r)}var f=d.child;if(f!==null)f.return=d,te=f;else for(;te!==null;){d=te;var p=d.sibling,m=d.return;if(Lk(d),d===u){te=null;break}if(p!==null){p.return=m,te=p;break}te=m}}}var y=r.alternate;if(y!==null){var E=y.child;if(E!==null){y.child=null;do{var k=E.sibling;E.sibling=null,E=k}while(E!==null)}}te=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,te=o;else e:for(;te!==null;){if(r=te,r.flags&2048)switch(r.tag){case 0:case 11:case 15:af(9,r,r.return)}var v=r.sibling;if(v!==null){v.return=r.return,te=v;break e}te=r.return}}var A=n.current;for(te=A;te!==null;){o=te;var C=o.child;if(o.subtreeFlags&2064&&C!==null)C.return=o,te=C;else e:for(o=A;te!==null;){if(a=te,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:X_(9,a)}}catch(F){At(a,a.return,F)}if(a===o){te=null;break e}var N=a.sibling;if(N!==null){N.return=a.return,te=N;break e}te=a.return}}if(Le=i,ka(),Qi&&typeof Qi.onPostCommitFiberRoot=="function")try{Qi.onPostCommitFiberRoot(B_,n)}catch{}s=!0}return s}finally{He=t,qs.transition=e}}return!1}function W1(n,e,t){e=Ch(t,e),e=bk(n,e,1),n=la(n,e,1),e=$n(),n!==null&&(mg(n,1,e),ls(n,e))}function At(n,e,t){if(n.tag===3)W1(n,n,t);else for(;e!==null;){if(e.tag===3){W1(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ca===null||!ca.has(s))){n=Ch(t,n),n=Tk(e,n,1),e=la(e,n,1),n=$n(),e!==null&&(mg(e,1,n),ls(e,n));break}}e=e.return}}function dO(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=$n(),n.pingedLanes|=n.suspendedLanes&t,Zt===n&&(hn&t)===t&&(Bt===4||Bt===3&&(hn&130023424)===hn&&500>Ct()-bb?Yl(n,0):Ab|=t),ls(n,e)}function Hk(n,e){e===0&&(n.mode&1?(e=am,am<<=1,!(am&130023424)&&(am=4194304)):e=1);var t=$n();n=so(n,e),n!==null&&(mg(n,e,t),ls(n,t))}function fO(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Hk(n,t)}function pO(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(G(314))}s!==null&&s.delete(e),Hk(n,t)}var Wk;Wk=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||os.current)rs=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return rs=!1,tO(n,e,t);rs=!!(n.flags&131072)}else rs=!1,ut&&e.flags&1048576&&XC(e,jy,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Um(n,e),n=e.pendingProps;var i=Th(e,Pn.current);uu(e,t),i=mb(null,e,s,n,i,t);var r=yb();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,as(s)?(r=!0,Fy(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,hb(e),i.updater=K_,e.stateNode=i,i._reactInternals=e,N0(e,s,n,t),e=M0(null,e,s,!0,r,t)):(e.tag=0,ut&&r&&ib(e),Un(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(Um(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=mO(s),n=ti(s,n),i){case 0:e=L0(null,e,s,n,t);break e;case 1:e=M1(null,e,s,n,t);break e;case 11:e=D1(null,e,s,n,t);break e;case 14:e=L1(null,e,s,ti(s.type,n),t);break e}throw Error(G(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ti(s,i),L0(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ti(s,i),M1(n,e,s,i,t);case 3:e:{if(Ck(e),n===null)throw Error(G(387));s=e.pendingProps,r=e.memoizedState,i=r.element,tk(n,e),zy(e,s,null,t);var o=e.memoizedState;if(s=o.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=Ch(Error(G(423)),e),e=O1(n,e,s,t,i);break e}else if(s!==i){i=Ch(Error(G(424)),e),e=O1(n,e,s,t,i);break e}else for(bs=aa(e.stateNode.containerInfo.firstChild),Ss=e,ut=!0,yi=null,t=ZC(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Sh(),s===i){e=io(n,e,t);break e}Un(n,e,s,t)}e=e.child}return e;case 5:return nk(e),n===null&&k0(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,o=i.children,T0(s,i)?o=null:r!==null&&T0(s,r)&&(e.flags|=32),Ik(n,e),Un(n,e,o,t),e.child;case 6:return n===null&&k0(e),null;case 13:return kk(n,e,t);case 4:return db(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=xh(e,null,s,t):Un(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ti(s,i),D1(n,e,s,i,t);case 7:return Un(n,e,e.pendingProps,t),e.child;case 8:return Un(n,e,e.pendingProps.children,t),e.child;case 12:return Un(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,o=i.value,tt(Uy,s._currentValue),s._currentValue=o,r!==null)if(bi(r.value,o)){if(r.children===i.children&&!os.current){e=io(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var a=r.dependencies;if(a!==null){o=r.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(r.tag===1){l=Qr(-1,t&-t),l.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}r.lanes|=t,l=r.alternate,l!==null&&(l.lanes|=t),R0(r.return,t,e),a.lanes|=t;break}l=l.next}}else if(r.tag===10)o=r.type===e.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(G(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),R0(o,t,e),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===e){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}Un(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,uu(e,t),i=Xs(i),s=s(i),e.flags|=1,Un(n,e,s,t),e.child;case 14:return s=e.type,i=ti(s,e.pendingProps),i=ti(s.type,i),L1(n,e,s,i,t);case 15:return Sk(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ti(s,i),Um(n,e),e.tag=1,as(s)?(n=!0,Fy(e)):n=!1,uu(e,t),Ak(e,s,i),N0(e,s,i,t),M0(null,e,s,!0,n,t);case 19:return Rk(n,e,t);case 22:return xk(n,e,t)}throw Error(G(156,e.tag))};function Gk(n,e){return vC(n,e)}function gO(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gs(n,e,t,s){return new gO(n,e,t,s)}function Ib(n){return n=n.prototype,!(!n||!n.isReactComponent)}function mO(n){if(typeof n=="function")return Ib(n)?1:0;if(n!=null){if(n=n.$$typeof,n===GA)return 11;if(n===qA)return 14}return 2}function ha(n,e){var t=n.alternate;return t===null?(t=Gs(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function $m(n,e,t,s,i,r){var o=2;if(s=n,typeof n=="function")Ib(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Wc:return Ql(t.children,i,r,e);case WA:o=8,i|=8;break;case n0:return n=Gs(12,t,e,i|2),n.elementType=n0,n.lanes=r,n;case s0:return n=Gs(13,t,e,i),n.elementType=s0,n.lanes=r,n;case i0:return n=Gs(19,t,e,i),n.elementType=i0,n.lanes=r,n;case nC:return Q_(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case eC:o=10;break e;case tC:o=9;break e;case GA:o=11;break e;case qA:o=14;break e;case _o:o=16,s=null;break e}throw Error(G(130,n==null?n:typeof n,""))}return e=Gs(o,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function Ql(n,e,t,s){return n=Gs(7,n,s,e),n.lanes=t,n}function Q_(n,e,t,s){return n=Gs(22,n,s,e),n.elementType=nC,n.lanes=t,n.stateNode={isHidden:!1},n}function Tw(n,e,t){return n=Gs(6,n,null,e),n.lanes=t,n}function Sw(n,e,t){return e=Gs(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function yO(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rw(0),this.expirationTimes=rw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rw(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Cb(n,e,t,s,i,r,o,a,l){return n=new yO(n,e,t,a,l),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Gs(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},hb(r),n}function _O(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hc,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function qk(n){if(!n)return _a;n=n._reactInternals;e:{if(yc(n)!==n||n.tag!==1)throw Error(G(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(as(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(n.tag===1){var t=n.type;if(as(t))return qC(n,t,e)}return e}function Kk(n,e,t,s,i,r,o,a,l){return n=Cb(t,s,!0,n,i,r,o,a,l),n.context=qk(null),t=n.current,s=$n(),i=ua(t),r=Qr(s,i),r.callback=e??null,la(t,r,i),n.current.lanes=i,mg(n,i,s),ls(n,s),n}function J_(n,e,t,s){var i=e.current,r=$n(),o=ua(i);return t=qk(t),e.context===null?e.context=t:e.pendingContext=t,e=Qr(r,o),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=la(i,e,o),n!==null&&(Ei(n,i,o,r),Fm(n,i,o)),o}function Yy(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function G1(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function kb(n,e){G1(n,e),(n=n.alternate)&&G1(n,e)}function vO(){return null}var Xk=typeof reportError=="function"?reportError:function(n){console.error(n)};function Rb(n){this._internalRoot=n}Z_.prototype.render=Rb.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(G(409));J_(n,e,null,null)};Z_.prototype.unmount=Rb.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;rc(function(){J_(null,n,null,null)}),e[no]=null}};function Z_(n){this._internalRoot=n}Z_.prototype.unstable_scheduleHydration=function(n){if(n){var e=xC();n={blockedOn:null,target:n,priority:e};for(var t=0;t<wo.length&&e!==0&&e<wo[t].priority;t++);wo.splice(t,0,n),t===0&&CC(n)}};function Pb(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function ev(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function q1(){}function wO(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=Yy(o);r.call(u)}}var o=Kk(e,s,n,0,null,!1,!1,"",q1);return n._reactRootContainer=o,n[no]=o.current,Cf(n.nodeType===8?n.parentNode:n),rc(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var a=s;s=function(){var u=Yy(l);a.call(u)}}var l=Cb(n,0,!1,null,null,!1,!1,"",q1);return n._reactRootContainer=l,n[no]=l.current,Cf(n.nodeType===8?n.parentNode:n),rc(function(){J_(e,l,t,s)}),l}function tv(n,e,t,s,i){var r=t._reactRootContainer;if(r){var o=r;if(typeof i=="function"){var a=i;i=function(){var l=Yy(o);a.call(l)}}J_(e,o,n,i)}else o=wO(t,e,n,i,s);return Yy(o)}TC=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Rd(e.pendingLanes);t!==0&&(YA(e,t|1),ls(e,Ct()),!(Le&6)&&(kh=Ct()+500,ka()))}break;case 13:rc(function(){var s=so(n,1);if(s!==null){var i=$n();Ei(s,n,1,i)}}),kb(n,1)}};QA=function(n){if(n.tag===13){var e=so(n,134217728);if(e!==null){var t=$n();Ei(e,n,134217728,t)}kb(n,134217728)}};SC=function(n){if(n.tag===13){var e=ua(n),t=so(n,e);if(t!==null){var s=$n();Ei(t,n,e,s)}kb(n,e)}};xC=function(){return He};IC=function(n,e){var t=He;try{return He=n,e()}finally{He=t}};p0=function(n,e,t){switch(e){case"input":if(a0(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=W_(s);if(!i)throw Error(G(90));iC(s),a0(s,i)}}}break;case"textarea":oC(n,t);break;case"select":e=t.value,e!=null&&ou(n,!!t.multiple,e,!1)}};fC=Tb;pC=rc;var EO={usingClientEntryPoint:!1,Events:[_g,Xc,W_,hC,dC,Tb]},Ad={findFiberByHostInstance:Ka,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},AO={bundleType:Ad.bundleType,version:Ad.version,rendererPackageName:Ad.rendererPackageName,rendererConfig:Ad.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:uo.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=yC(n),n===null?null:n.stateNode},findFiberByHostInstance:Ad.findFiberByHostInstance||vO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _m=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_m.isDisabled&&_m.supportsFiber)try{B_=_m.inject(AO),Qi=_m}catch{}}ks.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EO;ks.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pb(e))throw Error(G(200));return _O(n,e,null,t)};ks.createRoot=function(n,e){if(!Pb(n))throw Error(G(299));var t=!1,s="",i=Xk;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Cb(n,1,!1,null,null,t,!1,s,i),n[no]=e.current,Cf(n.nodeType===8?n.parentNode:n),new Rb(e)};ks.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(G(188)):(n=Object.keys(n).join(","),Error(G(268,n)));return n=yC(e),n=n===null?null:n.stateNode,n};ks.flushSync=function(n){return rc(n)};ks.hydrate=function(n,e,t){if(!ev(e))throw Error(G(200));return tv(null,n,e,!0,t)};ks.hydrateRoot=function(n,e,t){if(!Pb(n))throw Error(G(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",o=Xk;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=Kk(e,null,n,1,t??null,i,!1,r,o),n[no]=e.current,Cf(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new Z_(e)};ks.render=function(n,e,t){if(!ev(e))throw Error(G(200));return tv(null,n,e,!1,t)};ks.unmountComponentAtNode=function(n){if(!ev(n))throw Error(G(40));return n._reactRootContainer?(rc(function(){tv(null,null,n,!1,function(){n._reactRootContainer=null,n[no]=null})}),!0):!1};ks.unstable_batchedUpdates=Tb;ks.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!ev(t))throw Error(G(200));if(n==null||n._reactInternals===void 0)throw Error(G(38));return tv(n,e,t,!1,s)};ks.version="18.3.1-next-f1338f8080-20240426";function Yk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Yk)}catch(n){console.error(n)}}Yk(),YI.exports=ks;var bO=YI.exports,K1=bO;e0.createRoot=K1.createRoot,e0.hydrateRoot=K1.hydrateRoot;/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TO=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Qk=(...n)=>n.filter((e,t,s)=>!!e&&s.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var SO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xO=K.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:r,iconNode:o,...a},l)=>K.createElement("svg",{ref:l,...SO,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:Qk("lucide",i),...a},[...o.map(([u,d])=>K.createElement(u,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=(n,e)=>{const t=K.forwardRef(({className:s,...i},r)=>K.createElement(xO,{ref:r,iconNode:e,className:Qk(`lucide-${TO(n)}`,s),...i}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=Oe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IO=Oe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=Oe("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CO=Oe("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X1=Oe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=Oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RO=Oe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=Oe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=Oe("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PO=Oe("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NO=Oe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=Oe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cw=Oe("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DO=Oe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=Oe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=Oe("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=Oe("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=Oe("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=Oe("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=Oe("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=Oe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=Oe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=Oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FO=Oe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VO=Oe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=Oe("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y1=Oe("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=Oe("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=Oe("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vm=Oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jO=Oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UO=Oe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=Oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Q1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let i=n.charCodeAt(s);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},BO=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const i=n[t++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=n[t++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=n[t++],o=n[t++],a=n[t++],l=((i&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const r=n[t++],o=n[t++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return e.join("")},sR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<n.length;i+=3){const r=n[i],o=i+1<n.length,a=o?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0,d=r>>2,f=(r&3)<<4|a>>4;let p=(a&15)<<2|u>>6,m=u&63;l||(m=64,o||(p=64)),s.push(t[d],t[f],t[p],t[m])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(nR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):BO(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<n.length;){const r=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,r==null||a==null||u==null||f==null)throw new zO;const p=r<<2|a>>4;if(s.push(p),u!==64){const m=a<<4&240|u>>2;if(s.push(m),f!==64){const y=u<<6&192|f;s.push(y)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class zO extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $O=function(n){const e=nR(n);return sR.encodeByteArray(e,!0)},Jy=function(n){return $O(n).replace(/\./g,"")},iR=function(n){try{return sR.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO=()=>HO().__FIREBASE_DEFAULTS__,GO=()=>{if(typeof process>"u"||typeof Q1>"u")return;const n=Q1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},qO=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&iR(n[1]);return e&&JSON.parse(e)},nv=()=>{try{return WO()||GO()||qO()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},rR=n=>{var e,t;return(t=(e=nv())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},oR=n=>{const e=rR(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},aR=()=>{var n;return(n=nv())===null||n===void 0?void 0:n.config},lR=n=>{var e;return(e=nv())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cR(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",i=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Jy(JSON.stringify(t)),Jy(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function XO(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nn())}function YO(){var n;const e=(n=nv())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function QO(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function JO(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ZO(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eF(){const n=Nn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function tF(){return!YO()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nF(){try{return typeof indexedDB=="object"}catch{return!1}}function sF(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var r;e(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iF="FirebaseError";class ar extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=iF,Object.setPrototypeOf(this,ar.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,wg.prototype.create)}}class wg{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?rF(r,s):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ar(i,a,s)}}function rF(n,e){return n.replace(oF,(t,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const oF=/\{\$([^}]+)}/g;function aF(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Zy(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const i of t){if(!s.includes(i))return!1;const r=n[i],o=e[i];if(J1(r)&&J1(o)){if(!Zy(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!t.includes(i))return!1;return!0}function J1(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eg(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Nd(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[i,r]=s.split("=");e[decodeURIComponent(i)]=decodeURIComponent(r)}}),e}function Dd(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function lF(n,e){const t=new cF(n,e);return t.subscribe.bind(t)}class cF{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let i;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");uF(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:s},i.next===void 0&&(i.next=Pw),i.error===void 0&&(i.error=Pw),i.complete===void 0&&(i.complete=Pw);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),r}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uF(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Pw(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nt(n){return n&&n._delegate?n._delegate:n}class va{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new KO;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fF(e))try{this.getOrInitializeService({instanceIdentifier:Ba})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=Ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ba){return this.instances.has(e)}getOptions(e=Ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);s===a&&o.resolve(i)}return i}onInit(e,t){var s;const i=this.normalizeInstanceIdentifier(t),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const i of s)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:dF(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Ba){return this.component?this.component.multipleInstances?e:Ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function dF(n){return n===Ba?void 0:n}function fF(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new hF(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Re;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Re||(Re={}));const gF={debug:Re.DEBUG,verbose:Re.VERBOSE,info:Re.INFO,warn:Re.WARN,error:Re.ERROR,silent:Re.SILENT},mF=Re.INFO,yF={[Re.DEBUG]:"log",[Re.VERBOSE]:"log",[Re.INFO]:"info",[Re.WARN]:"warn",[Re.ERROR]:"error"},_F=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),i=yF[e];if(i)console[i](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Nb{constructor(e){this.name=e,this._logLevel=mF,this._logHandler=_F,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gF[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Re.DEBUG,...e),this._logHandler(this,Re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Re.VERBOSE,...e),this._logHandler(this,Re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Re.INFO,...e),this._logHandler(this,Re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Re.WARN,...e),this._logHandler(this,Re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Re.ERROR,...e),this._logHandler(this,Re.ERROR,...e)}}const vF=(n,e)=>e.some(t=>n instanceof t);let Z1,ex;function wF(){return Z1||(Z1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function EF(){return ex||(ex=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const uR=new WeakMap,Q0=new WeakMap,hR=new WeakMap,Nw=new WeakMap,Db=new WeakMap;function AF(n){const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{t(da(n.result)),i()},o=()=>{s(n.error),i()};n.addEventListener("success",r),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&uR.set(t,n)}).catch(()=>{}),Db.set(e,n),e}function bF(n){if(Q0.has(n))return;const e=new Promise((t,s)=>{const i=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{t(),i()},o=()=>{s(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});Q0.set(n,e)}let J0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Q0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||hR.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return da(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function TF(n){J0=n(J0)}function SF(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Dw(this),e,...t);return hR.set(s,e.sort?e.sort():[e]),da(s)}:EF().includes(n)?function(...e){return n.apply(Dw(this),e),da(uR.get(this))}:function(...e){return da(n.apply(Dw(this),e))}}function xF(n){return typeof n=="function"?SF(n):(n instanceof IDBTransaction&&bF(n),vF(n,wF())?new Proxy(n,J0):n)}function da(n){if(n instanceof IDBRequest)return AF(n);if(Nw.has(n))return Nw.get(n);const e=xF(n);return e!==n&&(Nw.set(n,e),Db.set(e,n)),e}const Dw=n=>Db.get(n);function IF(n,e,{blocked:t,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(n,e),a=da(o);return s&&o.addEventListener("upgradeneeded",l=>{s(da(o.result),l.oldVersion,l.newVersion,da(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const CF=["get","getKey","getAll","getAllKeys","count"],kF=["put","add","delete","clear"],Lw=new Map;function tx(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Lw.get(e))return Lw.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,i=kF.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(i||CF.includes(t)))return;const r=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return s&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),i&&l.done]))[0]};return Lw.set(e,r),r}TF(n=>({...n,get:(e,t,s)=>tx(e,t)||n.get(e,t,s),has:(e,t)=>!!tx(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(PF(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function PF(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Z0="@firebase/app",nx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ro=new Nb("@firebase/app"),NF="@firebase/app-compat",DF="@firebase/analytics-compat",LF="@firebase/analytics",MF="@firebase/app-check-compat",OF="@firebase/app-check",FF="@firebase/auth",VF="@firebase/auth-compat",jF="@firebase/database",UF="@firebase/data-connect",BF="@firebase/database-compat",zF="@firebase/functions",$F="@firebase/functions-compat",HF="@firebase/installations",WF="@firebase/installations-compat",GF="@firebase/messaging",qF="@firebase/messaging-compat",KF="@firebase/performance",XF="@firebase/performance-compat",YF="@firebase/remote-config",QF="@firebase/remote-config-compat",JF="@firebase/storage",ZF="@firebase/storage-compat",eV="@firebase/firestore",tV="@firebase/vertexai-preview",nV="@firebase/firestore-compat",sV="firebase",iV="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eE="[DEFAULT]",rV={[Z0]:"fire-core",[NF]:"fire-core-compat",[LF]:"fire-analytics",[DF]:"fire-analytics-compat",[OF]:"fire-app-check",[MF]:"fire-app-check-compat",[FF]:"fire-auth",[VF]:"fire-auth-compat",[jF]:"fire-rtdb",[UF]:"fire-data-connect",[BF]:"fire-rtdb-compat",[zF]:"fire-fn",[$F]:"fire-fn-compat",[HF]:"fire-iid",[WF]:"fire-iid-compat",[GF]:"fire-fcm",[qF]:"fire-fcm-compat",[KF]:"fire-perf",[XF]:"fire-perf-compat",[YF]:"fire-rc",[QF]:"fire-rc-compat",[JF]:"fire-gcs",[ZF]:"fire-gcs-compat",[eV]:"fire-fst",[nV]:"fire-fst-compat",[tV]:"fire-vertex","fire-js":"fire-js",[sV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=new Map,oV=new Map,tE=new Map;function sx(n,e){try{n.container.addComponent(e)}catch(t){ro.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function oc(n){const e=n.name;if(tE.has(e))return ro.debug(`There were multiple attempts to register component ${e}.`),!1;tE.set(e,n);for(const t of e_.values())sx(t,n);for(const t of oV.values())sx(t,n);return!0}function sv(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function qr(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fa=new wg("app","Firebase",aV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _c=iV;function dR(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:eE,automaticDataCollectionEnabled:!1},e),i=s.name;if(typeof i!="string"||!i)throw fa.create("bad-app-name",{appName:String(i)});if(t||(t=aR()),!t)throw fa.create("no-options");const r=e_.get(i);if(r){if(Zy(t,r.options)&&Zy(s,r.config))return r;throw fa.create("duplicate-app",{appName:i})}const o=new pF(i);for(const l of tE.values())o.addComponent(l);const a=new lV(t,s,o);return e_.set(i,a),a}function Lb(n=eE){const e=e_.get(n);if(!e&&n===eE&&aR())return dR();if(!e)throw fa.create("no-app",{appName:n});return e}function Zi(n,e,t){var s;let i=(s=rV[n])!==null&&s!==void 0?s:n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${i}" with version "${e}":`];r&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ro.warn(a.join(" "));return}oc(new va(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV="firebase-heartbeat-database",uV=1,Ff="firebase-heartbeat-store";let Mw=null;function fR(){return Mw||(Mw=IF(cV,uV,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ff)}catch(t){console.warn(t)}}}}).catch(n=>{throw fa.create("idb-open",{originalErrorMessage:n.message})})),Mw}async function hV(n){try{const t=(await fR()).transaction(Ff),s=await t.objectStore(Ff).get(pR(n));return await t.done,s}catch(e){if(e instanceof ar)ro.warn(e.message);else{const t=fa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ro.warn(t.message)}}}async function ix(n,e){try{const s=(await fR()).transaction(Ff,"readwrite");await s.objectStore(Ff).put(e,pR(n)),await s.done}catch(t){if(t instanceof ar)ro.warn(t.message);else{const s=fa.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ro.warn(s.message)}}}function pR(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dV=1024,fV=30*24*60*60*1e3;class pV{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new mV(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=rx();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r)?void 0:(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=fV}),this._storage.overwrite(this._heartbeatsCache))}catch(s){ro.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=rx(),{heartbeatsToSend:s,unsentEntries:i}=gV(this._heartbeatsCache.heartbeats),r=Jy(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(t){return ro.warn(t),""}}}function rx(){return new Date().toISOString().substring(0,10)}function gV(n,e=dV){const t=[];let s=n.slice();for(const i of n){const r=t.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),ox(t)>e){r.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),ox(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class mV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nF()?sF().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await hV(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return ix(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return ix(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ox(n){return Jy(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yV(n){oc(new va("platform-logger",e=>new RF(e),"PRIVATE")),oc(new va("heartbeat",e=>new pV(e),"PRIVATE")),Zi(Z0,nx,n),Zi(Z0,nx,"esm2017"),Zi("fire-js","")}yV("");var _V="firebase",vV="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zi(_V,vV,"app");function Mb(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t}function gR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const wV=gR,mR=new wg("auth","Firebase",gR());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=new Nb("@firebase/auth");function EV(n,...e){t_.logLevel<=Re.WARN&&t_.warn(`Auth (${_c}): ${n}`,...e)}function Hm(n,...e){t_.logLevel<=Re.ERROR&&t_.error(`Auth (${_c}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(n,...e){throw Ob(n,...e)}function er(n,...e){return Ob(n,...e)}function yR(n,e,t){const s=Object.assign(Object.assign({},wV()),{[e]:t});return new wg("auth","Firebase",s).create(e,{appName:n.name})}function pa(n){return yR(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ob(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return mR.create(n,...e)}function fe(n,e,...t){if(!n)throw Ob(e,...t)}function Kr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Hm(e),new Error(e)}function oo(n,e){n||Kr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function AV(){return ax()==="http:"||ax()==="https:"}function ax(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(AV()||JO()||"connection"in navigator)?navigator.onLine:!0}function TV(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,t){this.shortDelay=e,this.longDelay=t,oo(t>e,"Short delay should be less than long delay!"),this.isMobile=XO()||ZO()}get(){return bV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fb(n,e){oo(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Kr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Kr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Kr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xV=new Ag(3e4,6e4);function vc(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ra(n,e,t,s,i={}){return vR(n,i,async()=>{let r={},o={};s&&(e==="GET"?o=s:r={body:JSON.stringify(s)});const a=Eg(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u=Object.assign({method:e,headers:l},r);return QO()||(u.referrerPolicy="no-referrer"),_R.fetch()(wR(n,n.config.apiHost,t,a),u)})}async function vR(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},SV),e);try{const i=new CV(n),r=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw wm(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw wm(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw wm(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw wm(n,"user-disabled",o);const d=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw yR(n,d,u);Ti(n,d)}}catch(i){if(i instanceof ar)throw i;Ti(n,"network-request-failed",{message:String(i)})}}async function iv(n,e,t,s,i={}){const r=await Ra(n,e,t,s,i);return"mfaPendingCredential"in r&&Ti(n,"multi-factor-auth-required",{_serverResponse:r}),r}function wR(n,e,t,s){const i=`${e}${t}?${s}`;return n.config.emulator?Fb(n.config,i):`${n.config.apiScheme}://${i}`}function IV(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class CV{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(er(this.auth,"network-request-failed")),xV.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function wm(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const i=er(n,e,s);return i.customData._tokenResponse=t,i}function lx(n){return n!==void 0&&n.enterprise!==void 0}class kV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return IV(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function RV(n,e){return Ra(n,"GET","/v2/recaptchaConfig",vc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PV(n,e){return Ra(n,"POST","/v1/accounts:delete",e)}async function ER(n,e){return Ra(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function NV(n,e=!1){const t=nt(n),s=await t.getIdToken(e),i=Vb(s);fe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const r=typeof i.firebase=="object"?i.firebase:void 0,o=r==null?void 0:r.sign_in_provider;return{claims:i,token:s,authTime:uf(Ow(i.auth_time)),issuedAtTime:uf(Ow(i.iat)),expirationTime:uf(Ow(i.exp)),signInProvider:o||null,signInSecondFactor:(r==null?void 0:r.sign_in_second_factor)||null}}function Ow(n){return Number(n)*1e3}function Vb(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Hm("JWT malformed, contained fewer than 3 sections"),null;try{const i=iR(t);return i?JSON.parse(i):(Hm("Failed to decode base64 JWT payload"),null)}catch(i){return Hm("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function cx(n){const e=Vb(n);return fe(e,"internal-error"),fe(typeof e.exp<"u","internal-error"),fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vf(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof ar&&DV(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function DV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=uf(this.lastLoginAt),this.creationTime=uf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n_(n){var e;const t=n.auth,s=await n.getIdToken(),i=await Vf(n,ER(t,{idToken:s}));fe(i==null?void 0:i.users.length,t,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const o=!((e=r.providerUserInfo)===null||e===void 0)&&e.length?AR(r.providerUserInfo):[],a=OV(n.providerData,o),l=n.isAnonymous,u=!(n.email&&r.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,f={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new sE(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(n,f)}async function MV(n){const e=nt(n);await n_(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function OV(n,e){return[...n.filter(s=>!e.some(i=>i.providerId===s.providerId)),...e]}function AR(n){return n.map(e=>{var{providerId:t}=e,s=Mb(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FV(n,e){const t=await vR(n,{},async()=>{const s=Eg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:r}=n.config,o=wR(n,i,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",_R.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function VV(n,e){return Ra(n,"POST","/v2/accounts:revokeToken",vc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fe(e.idToken,"internal-error"),fe(typeof e.idToken<"u","internal-error"),fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):cx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){fe(e.length!==0,"internal-error");const t=cx(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:i,expiresIn:r}=await FV(e,t);this.updateTokensAndExpiration(s,i,Number(r))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:i,expirationTime:r}=t,o=new fu;return s&&(fe(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),i&&(fe(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),r&&(fe(typeof r=="number","internal-error",{appName:e}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fu,this.toJSON())}_performRefresh(){return Kr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(n,e){fe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Xr{constructor(e){var{uid:t,auth:s,stsTokenManager:i}=e,r=Mb(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new LV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new sE(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Vf(this,this.stsTokenManager.getToken(this.auth,e));return fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return NV(this,e)}reload(){return MV(this)}_assign(e){this!==e&&(fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Xr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await n_(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qr(this.auth.app))return Promise.reject(pa(this.auth));const e=await this.getIdToken();return await Vf(this,PV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,i,r,o,a,l,u,d;const f=(s=t.displayName)!==null&&s!==void 0?s:void 0,p=(i=t.email)!==null&&i!==void 0?i:void 0,m=(r=t.phoneNumber)!==null&&r!==void 0?r:void 0,y=(o=t.photoURL)!==null&&o!==void 0?o:void 0,E=(a=t.tenantId)!==null&&a!==void 0?a:void 0,k=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,v=(u=t.createdAt)!==null&&u!==void 0?u:void 0,A=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:C,emailVerified:N,isAnonymous:F,providerData:V,stsTokenManager:S}=t;fe(C&&S,e,"internal-error");const T=fu.fromJSON(this.name,S);fe(typeof C=="string",e,"internal-error"),mo(f,e.name),mo(p,e.name),fe(typeof N=="boolean",e,"internal-error"),fe(typeof F=="boolean",e,"internal-error"),mo(m,e.name),mo(y,e.name),mo(E,e.name),mo(k,e.name),mo(v,e.name),mo(A,e.name);const P=new Xr({uid:C,auth:e,email:p,emailVerified:N,displayName:f,isAnonymous:F,photoURL:y,phoneNumber:m,tenantId:E,stsTokenManager:T,createdAt:v,lastLoginAt:A});return V&&Array.isArray(V)&&(P.providerData=V.map(D=>Object.assign({},D))),k&&(P._redirectEventId=k),P}static async _fromIdTokenResponse(e,t,s=!1){const i=new fu;i.updateFromServerResponse(t);const r=new Xr({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:s});return await n_(r),r}static async _fromGetAccountInfoResponse(e,t,s){const i=t.users[0];fe(i.localId!==void 0,"internal-error");const r=i.providerUserInfo!==void 0?AR(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(r!=null&&r.length),a=new fu;a.updateFromIdToken(s);const l=new Xr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:r,metadata:new sE(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(r!=null&&r.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ux=new Map;function Yr(n){oo(n instanceof Function,"Expected a class definition");let e=ux.get(n);return e?(oo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ux.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}bR.type="NONE";const hx=bR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wm(n,e,t){return`firebase:${n}:${e}:${t}`}class pu{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:i,name:r}=this.auth;this.fullUserKey=Wm(this.userKey,i.apiKey,r),this.fullPersistenceKey=Wm("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new pu(Yr(hx),e,s);const i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let r=i[0]||Yr(hx);const o=Wm(s,e.config.apiKey,e.name);let a=null;for(const u of t)try{const d=await u._get(o);if(d){const f=Xr._fromJSON(e,d);u!==r&&(a=f),r=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!r._shouldAllowMigration||!l.length?new pu(r,e,s):(r=l[0],a&&await r._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==r)try{await u._remove(o)}catch{}})),new pu(r,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(IR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(TR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(kR(e))return"Blackberry";if(RR(e))return"Webos";if(SR(e))return"Safari";if((e.includes("chrome/")||xR(e))&&!e.includes("edge/"))return"Chrome";if(CR(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function TR(n=Nn()){return/firefox\//i.test(n)}function SR(n=Nn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xR(n=Nn()){return/crios\//i.test(n)}function IR(n=Nn()){return/iemobile/i.test(n)}function CR(n=Nn()){return/android/i.test(n)}function kR(n=Nn()){return/blackberry/i.test(n)}function RR(n=Nn()){return/webos/i.test(n)}function jb(n=Nn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function jV(n=Nn()){var e;return jb(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function UV(){return eF()&&document.documentMode===10}function PR(n=Nn()){return jb(n)||CR(n)||RR(n)||kR(n)||/windows phone/i.test(n)||IR(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(n,e=[]){let t;switch(n){case"Browser":t=dx(Nn());break;case"Worker":t=`${dx(Nn())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${_c}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=r=>new Promise((o,a)=>{try{const l=e(r);o(l)}catch(l){a(l)}});s.onAbort=t,this.queue.push(s);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zV(n,e={}){return Ra(n,"GET","/v2/passwordPolicy",vc(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V=6;class HV{constructor(e){var t,s,i,r;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:$V,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(r=e.forceUpgradeOnSignin)!==null&&r!==void 0?r:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,i,r,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(s=l.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsUppercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let i=0;i<e.length;i++)s=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WV{constructor(e,t,s,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new fx(this),this.idTokenSubscription=new fx(this),this.beforeStateQueue=new BV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yr(t)),this._initializationPromise=this.queue(async()=>{var s,i;if(!this._deleted&&(this.persistenceManager=await pu.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ER(this,{idToken:e}),s=await Xr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(qr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let i=s,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await n_(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=TV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qr(this.app))return Promise.reject(pa(this));const t=e?nt(e):null;return t&&fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qr(this.app)?Promise.reject(pa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qr(this.app)?Promise.reject(pa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Yr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await zV(this),t=new HV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new wg("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await VV(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Yr(e)||this._popupRedirectResolver;fe(t,this,"argument-error"),this.redirectPersistenceManager=await pu.create(this,[Yr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,i){if(this._deleted)return()=>{};const r=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,s,i);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=NR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&EV(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Bh(n){return nt(n)}class fx{constructor(e){this.auth=e,this.observer=null,this.addObserver=lF(t=>this.observer=t)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function GV(n){rv=n}function DR(n){return rv.loadJS(n)}function qV(){return rv.recaptchaEnterpriseScript}function KV(){return rv.gapiScript}function XV(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const YV="recaptcha-enterprise",QV="NO_RECAPTCHA";class JV{constructor(e){this.type=YV,this.auth=Bh(e)}async verify(e="verify",t=!1){async function s(r){if(!t){if(r.tenantId==null&&r._agentRecaptchaConfig!=null)return r._agentRecaptchaConfig.siteKey;if(r.tenantId!=null&&r._tenantRecaptchaConfigs[r.tenantId]!==void 0)return r._tenantRecaptchaConfigs[r.tenantId].siteKey}return new Promise(async(o,a)=>{RV(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new kV(l);return r.tenantId==null?r._agentRecaptchaConfig=u:r._tenantRecaptchaConfigs[r.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(r,o,a){const l=window.grecaptcha;lx(l)?l.enterprise.ready(()=>{l.enterprise.execute(r,{action:e}).then(u=>{o(u)}).catch(()=>{o(QV)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((r,o)=>{s(this.auth).then(a=>{if(!t&&lx(window.grecaptcha))i(a,r,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=qV();l.length!==0&&(l+=a),DR(l).then(()=>{i(a,r,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function px(n,e,t,s=!1){const i=new JV(n);let r;try{r=await i.verify(t)}catch{r=await i.verify(t,!0)}const o=Object.assign({},e);return s?Object.assign(o,{captchaResp:r}):Object.assign(o,{captchaResponse:r}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function gx(n,e,t,s){var i;if(!((i=n._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await px(n,e,t,t==="getOobCode");return s(n,r)}else return s(n,e).catch(async r=>{if(r.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await px(n,e,t,t==="getOobCode");return s(n,o)}else return Promise.reject(r)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZV(n,e){const t=sv(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),r=t.getOptions();if(Zy(r,e??{}))return i;Ti(i,"already-initialized")}return t.initialize({options:e})}function ej(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(Yr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function tj(n,e,t){const s=Bh(n);fe(s._canInitEmulator,s,"emulator-config-failed"),fe(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const i=!1,r=LR(e),{host:o,port:a}=nj(e),l=a===null?"":`:${a}`;s.config.emulator={url:`${r}//${o}${l}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:i})}),sj()}function LR(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function nj(n){const e=LR(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(s);if(i){const r=i[1];return{host:r,port:mx(s.substr(r.length+1))}}else{const[r,o]=s.split(":");return{host:r,port:mx(o)}}}function mx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function sj(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Kr("not implemented")}_getIdTokenResponse(e){return Kr("not implemented")}_linkToIdToken(e,t){return Kr("not implemented")}_getReauthenticationResolver(e){return Kr("not implemented")}}async function ij(n,e){return Ra(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rj(n,e){return iv(n,"POST","/v1/accounts:signInWithPassword",vc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oj(n,e){return iv(n,"POST","/v1/accounts:signInWithEmailLink",vc(n,e))}async function aj(n,e){return iv(n,"POST","/v1/accounts:signInWithEmailLink",vc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf extends Ub{constructor(e,t,s,i=null){super("password",s),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new jf(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new jf(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gx(e,t,"signInWithPassword",rj);case"emailLink":return oj(e,{email:this._email,oobCode:this._password});default:Ti(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gx(e,s,"signUpPassword",ij);case"emailLink":return aj(e,{idToken:t,email:this._email,oobCode:this._password});default:Ti(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gu(n,e){return iv(n,"POST","/v1/accounts:signInWithIdp",vc(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj="http://localhost";class ac extends Ub{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ac(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ti("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:i}=t,r=Mb(t,["providerId","signInMethod"]);if(!s||!i)return null;const o=new ac(s,i);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return gu(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,gu(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,gu(e,t)}buildRequest(){const e={requestUri:lj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Eg(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function uj(n){const e=Nd(Dd(n)).link,t=e?Nd(Dd(e)).deep_link_id:null,s=Nd(Dd(n)).deep_link_id;return(s?Nd(Dd(s)).link:null)||s||t||e||n}class Bb{constructor(e){var t,s,i,r,o,a;const l=Nd(Dd(e)),u=(t=l.apiKey)!==null&&t!==void 0?t:null,d=(s=l.oobCode)!==null&&s!==void 0?s:null,f=cj((i=l.mode)!==null&&i!==void 0?i:null);fe(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(r=l.continueUrl)!==null&&r!==void 0?r:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=uj(e);try{return new Bb(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(){this.providerId=zh.PROVIDER_ID}static credential(e,t){return jf._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=Bb.parseLink(t);return fe(s,"argument-error"),jf._fromEmailAndCode(e,s.code,s.tenantId)}}zh.PROVIDER_ID="password";zh.EMAIL_PASSWORD_SIGN_IN_METHOD="password";zh.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MR{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg extends MR{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao extends bg{constructor(){super("facebook.com")}static credential(e){return ac._fromParams({providerId:Ao.PROVIDER_ID,signInMethod:Ao.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ao.credentialFromTaggedObject(e)}static credentialFromError(e){return Ao.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ao.credential(e.oauthAccessToken)}catch{return null}}}Ao.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ao.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo extends bg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ac._fromParams({providerId:bo.PROVIDER_ID,signInMethod:bo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return bo.credentialFromTaggedObject(e)}static credentialFromError(e){return bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return bo.credential(t,s)}catch{return null}}}bo.GOOGLE_SIGN_IN_METHOD="google.com";bo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To extends bg{constructor(){super("github.com")}static credential(e){return ac._fromParams({providerId:To.PROVIDER_ID,signInMethod:To.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return To.credentialFromTaggedObject(e)}static credentialFromError(e){return To.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return To.credential(e.oauthAccessToken)}catch{return null}}}To.GITHUB_SIGN_IN_METHOD="github.com";To.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So extends bg{constructor(){super("twitter.com")}static credential(e,t){return ac._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return So.credential(t,s)}catch{return null}}}So.TWITTER_SIGN_IN_METHOD="twitter.com";So.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,i=!1){const r=await Xr._fromIdTokenResponse(e,s,i),o=yx(s);return new Rh({user:r,providerId:o,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const i=yx(s);return new Rh({user:e,providerId:i,_tokenResponse:s,operationType:t})}}function yx(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_ extends ar{constructor(e,t,s,i){var r;super(t.code,t.message),this.operationType=s,this.user=i,Object.setPrototypeOf(this,s_.prototype),this.customData={appName:e.name,tenantId:(r=e.tenantId)!==null&&r!==void 0?r:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,i){return new s_(e,t,s,i)}}function OR(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?s_._fromErrorAndOperation(n,r,e,s):r})}async function hj(n,e,t=!1){const s=await Vf(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Rh._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dj(n,e,t=!1){const{auth:s}=n;if(qr(s.app))return Promise.reject(pa(s));const i="reauthenticate";try{const r=await Vf(n,OR(s,i,e,n),t);fe(r.idToken,s,"internal-error");const o=Vb(r.idToken);fe(o,s,"internal-error");const{sub:a}=o;return fe(n.uid===a,s,"user-mismatch"),Rh._forOperation(n,i,r)}catch(r){throw(r==null?void 0:r.code)==="auth/user-not-found"&&Ti(s,"user-mismatch"),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FR(n,e,t=!1){if(qr(n.app))return Promise.reject(pa(n));const s="signIn",i=await OR(n,s,e),r=await Rh._fromIdTokenResponse(n,s,i);return t||await n._updateCurrentUser(r.user),r}async function fj(n,e){return FR(Bh(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pj(n){const e=Bh(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function iE(n,e,t){return qr(n.app)?Promise.reject(pa(n)):fj(nt(n),zh.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&pj(n),s})}function gj(n,e,t,s){return nt(n).onIdTokenChanged(e,t,s)}function mj(n,e,t){return nt(n).beforeAuthStateChanged(e,t)}function yj(n,e,t,s){return nt(n).onAuthStateChanged(e,t,s)}function _j(n){return nt(n).signOut()}const i_="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(i_,"1"),this.storage.removeItem(i_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=1e3,wj=10;class jR extends VR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=PR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),i=this.localCache[t];s!==i&&e(t,i,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(s);!t&&this.localCache[s]===o||this.notifyListeners(s,o)},r=this.storage.getItem(s);UV()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,wj):i()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},vj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}jR.type="LOCAL";const Ej=jR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR extends VR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}UR.type="SESSION";const BR=UR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aj(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const s=new ov(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:i,data:r}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:i});const a=Array.from(o).map(async u=>u(t.origin,r)),l=await Aj(a);t.ports[0].postMessage({status:"done",eventId:s,eventType:i,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ov.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zb(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,o;return new Promise((a,l)=>{const u=zb("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:i,onMessage(f){const p=f;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),r=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(p.data.response);break;default:clearTimeout(d),clearTimeout(r),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(){return window}function Tj(n){tr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zR(){return typeof tr().WorkerGlobalScope<"u"&&typeof tr().importScripts=="function"}async function Sj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function xj(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Ij(){return zR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R="firebaseLocalStorageDb",Cj=1,r_="firebaseLocalStorage",HR="fbase_key";class Tg{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function av(n,e){return n.transaction([r_],e?"readwrite":"readonly").objectStore(r_)}function kj(){const n=indexedDB.deleteDatabase($R);return new Tg(n).toPromise()}function rE(){const n=indexedDB.open($R,Cj);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(r_,{keyPath:HR})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(r_)?e(s):(s.close(),await kj(),e(await rE()))})})}async function _x(n,e,t){const s=av(n,!0).put({[HR]:e,value:t});return new Tg(s).toPromise()}async function Rj(n,e){const t=av(n,!1).get(e),s=await new Tg(t).toPromise();return s===void 0?null:s.value}function vx(n,e){const t=av(n,!0).delete(e);return new Tg(t).toPromise()}const Pj=800,Nj=3;class WR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rE(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>Nj)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ov._getInstance(Ij()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Sj(),!this.activeServiceWorker)return;this.sender=new bj(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||xj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rE();return await _x(e,i_,"1"),await vx(e,i_),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>_x(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>Rj(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>vx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const r=av(i,!1).getAll();return new Tg(r).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:i,value:r}of e)s.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!s.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Pj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}WR.type="LOCAL";const Dj=WR;new Ag(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(n,e){return e?Yr(e):(fe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b extends Ub{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return gu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return gu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return gu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Mj(n){return FR(n.auth,new $b(n),n.bypassAuthState)}function Oj(n){const{auth:e,user:t}=n;return fe(t,e,"internal-error"),dj(t,new $b(n),n.bypassAuthState)}async function Fj(n){const{auth:e,user:t}=n;return fe(t,e,"internal-error"),hj(t,new $b(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e,t,s,i,r=!1){this.auth=e,this.resolver=s,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:i,tenantId:r,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:s,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Mj;case"linkViaPopup":case"linkViaRedirect":return Fj;case"reauthViaPopup":case"reauthViaRedirect":return Oj;default:Ti(this.auth,"internal-error")}}resolve(e){oo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){oo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj=new Ag(2e3,1e4);class nu extends GR{constructor(e,t,s,i,r){super(e,t,i,r),this.provider=s,this.authWindow=null,this.pollId=null,nu.currentPopupAction&&nu.currentPopupAction.cancel(),nu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fe(e,this.auth,"internal-error"),e}async onExecution(){oo(this.filter.length===1,"Popup operations only handle one event");const e=zb();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(er(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(er(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(er(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Vj.get())};e()}}nu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jj="pendingRedirect",Gm=new Map;class Uj extends GR{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Gm.get(this.auth._key());if(!e){try{const s=await Bj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Gm.set(this.auth._key(),e)}return this.bypassAuthState||Gm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Bj(n,e){const t=Hj(e),s=$j(n);if(!await s._isAvailable())return!1;const i=await s._get(t)==="true";return await s._remove(t),i}function zj(n,e){Gm.set(n._key(),e)}function $j(n){return Yr(n._redirectPersistence)}function Hj(n){return Wm(jj,n.config.apiKey,n.name)}async function Wj(n,e,t=!1){if(qr(n.app))return Promise.reject(pa(n));const s=Bh(n),i=Lj(s,e),o=await new Uj(s,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gj=10*60*1e3;class qj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Kj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!qR(e)){const i=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(er(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Gj&&this.cachedEventUids.clear(),this.cachedEventUids.has(wx(e))}saveEventToCache(e){this.cachedEventUids.add(wx(e)),this.lastProcessedEventTime=Date.now()}}function wx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function qR({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Kj(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qR(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xj(n,e={}){return Ra(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Qj=/^https?/;async function Jj(n){if(n.config.emulator)return;const{authorizedDomains:e}=await Xj(n);for(const t of e)try{if(Zj(t))return}catch{}Ti(n,"unauthorized-domain")}function Zj(n){const e=nE(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===s}if(!Qj.test(t))return!1;if(Yj.test(n))return s===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4=new Ag(3e4,6e4);function Ex(){const n=tr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function t4(n){return new Promise((e,t)=>{var s,i,r;function o(){Ex(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ex(),t(er(n,"network-request-failed"))},timeout:e4.get()})}if(!((i=(s=tr().gapi)===null||s===void 0?void 0:s.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((r=tr().gapi)===null||r===void 0)&&r.load)o();else{const a=XV("iframefcb");return tr()[a]=()=>{gapi.load?o():t(er(n,"network-request-failed"))},DR(`${KV()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw qm=null,e})}let qm=null;function n4(n){return qm=qm||t4(n),qm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4=new Ag(5e3,15e3),i4="__/auth/iframe",r4="emulator/auth/iframe",o4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},a4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function l4(n){const e=n.config;fe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Fb(e,r4):`https://${n.config.authDomain}/${i4}`,s={apiKey:e.apiKey,appName:n.name,v:_c},i=a4.get(n.config.apiHost);i&&(s.eid=i);const r=n._getFrameworks();return r.length&&(s.fw=r.join(",")),`${t}?${Eg(s).slice(1)}`}async function c4(n){const e=await n4(n),t=tr().gapi;return fe(t,n,"internal-error"),e.open({where:document.body,url:l4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:o4,dontclear:!0},s=>new Promise(async(i,r)=>{await s.restyle({setHideOnLeave:!1});const o=er(n,"network-request-failed"),a=tr().setTimeout(()=>{r(o)},s4.get());function l(){tr().clearTimeout(a),i(s)}s.ping(l).then(l,()=>{r(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},h4=500,d4=600,f4="_blank",p4="http://localhost";class Ax{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function g4(n,e,t,s=h4,i=d4){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l=Object.assign(Object.assign({},u4),{width:s.toString(),height:i.toString(),top:r,left:o}),u=Nn().toLowerCase();t&&(a=xR(u)?f4:t),TR(u)&&(e=e||p4,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[m,y])=>`${p}${m}=${y},`,"");if(jV(u)&&a!=="_self")return m4(e||"",a),new Ax(null);const f=window.open(e||"",a,d);fe(f,n,"popup-blocked");try{f.focus()}catch{}return new Ax(f)}function m4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y4="__/auth/handler",_4="emulator/auth/handler",v4=encodeURIComponent("fac");async function bx(n,e,t,s,i,r){fe(n.config.authDomain,n,"auth-domain-config-required"),fe(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:_c,eventId:i};if(e instanceof MR){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",aF(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,f]of Object.entries({}))o[d]=f}if(e instanceof bg){const d=e.getScopes().filter(f=>f!=="");d.length>0&&(o.scopes=d.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await n._getAppCheckToken(),u=l?`#${v4}=${encodeURIComponent(l)}`:"";return`${w4(n)}?${Eg(a).slice(1)}${u}`}function w4({config:n}){return n.emulator?Fb(n,_4):`https://${n.authDomain}/${y4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="webStorageSupport";class E4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BR,this._completeRedirectFn=Wj,this._overrideRedirectResult=zj}async _openPopup(e,t,s,i){var r;oo((r=this.eventManagers[e._key()])===null||r===void 0?void 0:r.manager,"_initialize() not called before _openPopup()");const o=await bx(e,t,s,nE(),i);return g4(e,o,zb())}async _openRedirect(e,t,s,i){await this._originValidation(e);const r=await bx(e,t,s,nE(),i);return Tj(r),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:r}=this.eventManagers[t];return i?Promise.resolve(i):(oo(r,"If manager is not set, promise should be"),r)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await c4(e),s=new qj(e);return t.register("authEvent",i=>(fe(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fw,{type:Fw},i=>{var r;const o=(r=i==null?void 0:i[0])===null||r===void 0?void 0:r[Fw];o!==void 0&&t(!!o),Ti(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Jj(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return PR()||SR()||jb()}}const A4=E4;var Tx="@firebase/auth",Sx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function S4(n){oc(new va("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),r=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;fe(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:NR(n)},u=new WV(s,i,r,l);return ej(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),oc(new va("auth-internal",e=>{const t=Bh(e.getProvider("auth").getImmediate());return(s=>new b4(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zi(Tx,Sx,T4(n)),Zi(Tx,Sx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x4=5*60,I4=lR("authIdTokenMaxAge")||x4;let xx=null;const C4=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>I4)return;const i=t==null?void 0:t.token;xx!==i&&(xx=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function k4(n=Lb()){const e=sv(n,"auth");if(e.isInitialized())return e.getImmediate();const t=ZV(n,{popupRedirectResolver:A4,persistence:[Dj,Ej,BR]}),s=lR("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(s,location.origin);if(location.origin===r.origin){const o=C4(r.toString());mj(t,o,()=>o(t.currentUser)),gj(t,a=>o(a))}}const i=rR("auth");return i&&tj(t,`http://${i}`),t}function R4(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}GV({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=i=>{const r=er("internal-error");r.customData=i,t(r)},s.type="text/javascript",s.charset="UTF-8",R4().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});S4("Browser");var Ix=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Jl,KR;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,T){function P(){}P.prototype=T.prototype,S.D=T.prototype,S.prototype=new P,S.prototype.constructor=S,S.C=function(D,M,O){for(var L=Array(arguments.length-2),ne=2;ne<arguments.length;ne++)L[ne-2]=arguments[ne];return T.prototype[M].apply(D,L)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,T,P){P||(P=0);var D=Array(16);if(typeof T=="string")for(var M=0;16>M;++M)D[M]=T.charCodeAt(P++)|T.charCodeAt(P++)<<8|T.charCodeAt(P++)<<16|T.charCodeAt(P++)<<24;else for(M=0;16>M;++M)D[M]=T[P++]|T[P++]<<8|T[P++]<<16|T[P++]<<24;T=S.g[0],P=S.g[1],M=S.g[2];var O=S.g[3],L=T+(O^P&(M^O))+D[0]+3614090360&4294967295;T=P+(L<<7&4294967295|L>>>25),L=O+(M^T&(P^M))+D[1]+3905402710&4294967295,O=T+(L<<12&4294967295|L>>>20),L=M+(P^O&(T^P))+D[2]+606105819&4294967295,M=O+(L<<17&4294967295|L>>>15),L=P+(T^M&(O^T))+D[3]+3250441966&4294967295,P=M+(L<<22&4294967295|L>>>10),L=T+(O^P&(M^O))+D[4]+4118548399&4294967295,T=P+(L<<7&4294967295|L>>>25),L=O+(M^T&(P^M))+D[5]+1200080426&4294967295,O=T+(L<<12&4294967295|L>>>20),L=M+(P^O&(T^P))+D[6]+2821735955&4294967295,M=O+(L<<17&4294967295|L>>>15),L=P+(T^M&(O^T))+D[7]+4249261313&4294967295,P=M+(L<<22&4294967295|L>>>10),L=T+(O^P&(M^O))+D[8]+1770035416&4294967295,T=P+(L<<7&4294967295|L>>>25),L=O+(M^T&(P^M))+D[9]+2336552879&4294967295,O=T+(L<<12&4294967295|L>>>20),L=M+(P^O&(T^P))+D[10]+4294925233&4294967295,M=O+(L<<17&4294967295|L>>>15),L=P+(T^M&(O^T))+D[11]+2304563134&4294967295,P=M+(L<<22&4294967295|L>>>10),L=T+(O^P&(M^O))+D[12]+1804603682&4294967295,T=P+(L<<7&4294967295|L>>>25),L=O+(M^T&(P^M))+D[13]+4254626195&4294967295,O=T+(L<<12&4294967295|L>>>20),L=M+(P^O&(T^P))+D[14]+2792965006&4294967295,M=O+(L<<17&4294967295|L>>>15),L=P+(T^M&(O^T))+D[15]+1236535329&4294967295,P=M+(L<<22&4294967295|L>>>10),L=T+(M^O&(P^M))+D[1]+4129170786&4294967295,T=P+(L<<5&4294967295|L>>>27),L=O+(P^M&(T^P))+D[6]+3225465664&4294967295,O=T+(L<<9&4294967295|L>>>23),L=M+(T^P&(O^T))+D[11]+643717713&4294967295,M=O+(L<<14&4294967295|L>>>18),L=P+(O^T&(M^O))+D[0]+3921069994&4294967295,P=M+(L<<20&4294967295|L>>>12),L=T+(M^O&(P^M))+D[5]+3593408605&4294967295,T=P+(L<<5&4294967295|L>>>27),L=O+(P^M&(T^P))+D[10]+38016083&4294967295,O=T+(L<<9&4294967295|L>>>23),L=M+(T^P&(O^T))+D[15]+3634488961&4294967295,M=O+(L<<14&4294967295|L>>>18),L=P+(O^T&(M^O))+D[4]+3889429448&4294967295,P=M+(L<<20&4294967295|L>>>12),L=T+(M^O&(P^M))+D[9]+568446438&4294967295,T=P+(L<<5&4294967295|L>>>27),L=O+(P^M&(T^P))+D[14]+3275163606&4294967295,O=T+(L<<9&4294967295|L>>>23),L=M+(T^P&(O^T))+D[3]+4107603335&4294967295,M=O+(L<<14&4294967295|L>>>18),L=P+(O^T&(M^O))+D[8]+1163531501&4294967295,P=M+(L<<20&4294967295|L>>>12),L=T+(M^O&(P^M))+D[13]+2850285829&4294967295,T=P+(L<<5&4294967295|L>>>27),L=O+(P^M&(T^P))+D[2]+4243563512&4294967295,O=T+(L<<9&4294967295|L>>>23),L=M+(T^P&(O^T))+D[7]+1735328473&4294967295,M=O+(L<<14&4294967295|L>>>18),L=P+(O^T&(M^O))+D[12]+2368359562&4294967295,P=M+(L<<20&4294967295|L>>>12),L=T+(P^M^O)+D[5]+4294588738&4294967295,T=P+(L<<4&4294967295|L>>>28),L=O+(T^P^M)+D[8]+2272392833&4294967295,O=T+(L<<11&4294967295|L>>>21),L=M+(O^T^P)+D[11]+1839030562&4294967295,M=O+(L<<16&4294967295|L>>>16),L=P+(M^O^T)+D[14]+4259657740&4294967295,P=M+(L<<23&4294967295|L>>>9),L=T+(P^M^O)+D[1]+2763975236&4294967295,T=P+(L<<4&4294967295|L>>>28),L=O+(T^P^M)+D[4]+1272893353&4294967295,O=T+(L<<11&4294967295|L>>>21),L=M+(O^T^P)+D[7]+4139469664&4294967295,M=O+(L<<16&4294967295|L>>>16),L=P+(M^O^T)+D[10]+3200236656&4294967295,P=M+(L<<23&4294967295|L>>>9),L=T+(P^M^O)+D[13]+681279174&4294967295,T=P+(L<<4&4294967295|L>>>28),L=O+(T^P^M)+D[0]+3936430074&4294967295,O=T+(L<<11&4294967295|L>>>21),L=M+(O^T^P)+D[3]+3572445317&4294967295,M=O+(L<<16&4294967295|L>>>16),L=P+(M^O^T)+D[6]+76029189&4294967295,P=M+(L<<23&4294967295|L>>>9),L=T+(P^M^O)+D[9]+3654602809&4294967295,T=P+(L<<4&4294967295|L>>>28),L=O+(T^P^M)+D[12]+3873151461&4294967295,O=T+(L<<11&4294967295|L>>>21),L=M+(O^T^P)+D[15]+530742520&4294967295,M=O+(L<<16&4294967295|L>>>16),L=P+(M^O^T)+D[2]+3299628645&4294967295,P=M+(L<<23&4294967295|L>>>9),L=T+(M^(P|~O))+D[0]+4096336452&4294967295,T=P+(L<<6&4294967295|L>>>26),L=O+(P^(T|~M))+D[7]+1126891415&4294967295,O=T+(L<<10&4294967295|L>>>22),L=M+(T^(O|~P))+D[14]+2878612391&4294967295,M=O+(L<<15&4294967295|L>>>17),L=P+(O^(M|~T))+D[5]+4237533241&4294967295,P=M+(L<<21&4294967295|L>>>11),L=T+(M^(P|~O))+D[12]+1700485571&4294967295,T=P+(L<<6&4294967295|L>>>26),L=O+(P^(T|~M))+D[3]+2399980690&4294967295,O=T+(L<<10&4294967295|L>>>22),L=M+(T^(O|~P))+D[10]+4293915773&4294967295,M=O+(L<<15&4294967295|L>>>17),L=P+(O^(M|~T))+D[1]+2240044497&4294967295,P=M+(L<<21&4294967295|L>>>11),L=T+(M^(P|~O))+D[8]+1873313359&4294967295,T=P+(L<<6&4294967295|L>>>26),L=O+(P^(T|~M))+D[15]+4264355552&4294967295,O=T+(L<<10&4294967295|L>>>22),L=M+(T^(O|~P))+D[6]+2734768916&4294967295,M=O+(L<<15&4294967295|L>>>17),L=P+(O^(M|~T))+D[13]+1309151649&4294967295,P=M+(L<<21&4294967295|L>>>11),L=T+(M^(P|~O))+D[4]+4149444226&4294967295,T=P+(L<<6&4294967295|L>>>26),L=O+(P^(T|~M))+D[11]+3174756917&4294967295,O=T+(L<<10&4294967295|L>>>22),L=M+(T^(O|~P))+D[2]+718787259&4294967295,M=O+(L<<15&4294967295|L>>>17),L=P+(O^(M|~T))+D[9]+3951481745&4294967295,S.g[0]=S.g[0]+T&4294967295,S.g[1]=S.g[1]+(M+(L<<21&4294967295|L>>>11))&4294967295,S.g[2]=S.g[2]+M&4294967295,S.g[3]=S.g[3]+O&4294967295}s.prototype.u=function(S,T){T===void 0&&(T=S.length);for(var P=T-this.blockSize,D=this.B,M=this.h,O=0;O<T;){if(M==0)for(;O<=P;)i(this,S,O),O+=this.blockSize;if(typeof S=="string"){for(;O<T;)if(D[M++]=S.charCodeAt(O++),M==this.blockSize){i(this,D),M=0;break}}else for(;O<T;)if(D[M++]=S[O++],M==this.blockSize){i(this,D),M=0;break}}this.h=M,this.o+=T},s.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var T=1;T<S.length-8;++T)S[T]=0;var P=8*this.o;for(T=S.length-8;T<S.length;++T)S[T]=P&255,P/=256;for(this.u(S),S=Array(16),T=P=0;4>T;++T)for(var D=0;32>D;D+=8)S[P++]=this.g[T]>>>D&255;return S};function r(S,T){var P=a;return Object.prototype.hasOwnProperty.call(P,S)?P[S]:P[S]=T(S)}function o(S,T){this.h=T;for(var P=[],D=!0,M=S.length-1;0<=M;M--){var O=S[M]|0;D&&O==T||(P[M]=O,D=!1)}this.g=P}var a={};function l(S){return-128<=S&&128>S?r(S,function(T){return new o([T|0],0>T?-1:0)}):new o([S|0],0>S?-1:0)}function u(S){if(isNaN(S)||!isFinite(S))return f;if(0>S)return k(u(-S));for(var T=[],P=1,D=0;S>=P;D++)T[D]=S/P|0,P*=4294967296;return new o(T,0)}function d(S,T){if(S.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(S.charAt(0)=="-")return k(d(S.substring(1),T));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=u(Math.pow(T,8)),D=f,M=0;M<S.length;M+=8){var O=Math.min(8,S.length-M),L=parseInt(S.substring(M,M+O),T);8>O?(O=u(Math.pow(T,O)),D=D.j(O).add(u(L))):(D=D.j(P),D=D.add(u(L)))}return D}var f=l(0),p=l(1),m=l(16777216);n=o.prototype,n.m=function(){if(E(this))return-k(this).m();for(var S=0,T=1,P=0;P<this.g.length;P++){var D=this.i(P);S+=(0<=D?D:4294967296+D)*T,T*=4294967296}return S},n.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(y(this))return"0";if(E(this))return"-"+k(this).toString(S);for(var T=u(Math.pow(S,6)),P=this,D="";;){var M=N(P,T).g;P=v(P,M.j(T));var O=((0<P.g.length?P.g[0]:P.h)>>>0).toString(S);if(P=M,y(P))return O+D;for(;6>O.length;)O="0"+O;D=O+D}},n.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function y(S){if(S.h!=0)return!1;for(var T=0;T<S.g.length;T++)if(S.g[T]!=0)return!1;return!0}function E(S){return S.h==-1}n.l=function(S){return S=v(this,S),E(S)?-1:y(S)?0:1};function k(S){for(var T=S.g.length,P=[],D=0;D<T;D++)P[D]=~S.g[D];return new o(P,~S.h).add(p)}n.abs=function(){return E(this)?k(this):this},n.add=function(S){for(var T=Math.max(this.g.length,S.g.length),P=[],D=0,M=0;M<=T;M++){var O=D+(this.i(M)&65535)+(S.i(M)&65535),L=(O>>>16)+(this.i(M)>>>16)+(S.i(M)>>>16);D=L>>>16,O&=65535,L&=65535,P[M]=L<<16|O}return new o(P,P[P.length-1]&-2147483648?-1:0)};function v(S,T){return S.add(k(T))}n.j=function(S){if(y(this)||y(S))return f;if(E(this))return E(S)?k(this).j(k(S)):k(k(this).j(S));if(E(S))return k(this.j(k(S)));if(0>this.l(m)&&0>S.l(m))return u(this.m()*S.m());for(var T=this.g.length+S.g.length,P=[],D=0;D<2*T;D++)P[D]=0;for(D=0;D<this.g.length;D++)for(var M=0;M<S.g.length;M++){var O=this.i(D)>>>16,L=this.i(D)&65535,ne=S.i(M)>>>16,Ne=S.i(M)&65535;P[2*D+2*M]+=L*Ne,A(P,2*D+2*M),P[2*D+2*M+1]+=O*Ne,A(P,2*D+2*M+1),P[2*D+2*M+1]+=L*ne,A(P,2*D+2*M+1),P[2*D+2*M+2]+=O*ne,A(P,2*D+2*M+2)}for(D=0;D<T;D++)P[D]=P[2*D+1]<<16|P[2*D];for(D=T;D<2*T;D++)P[D]=0;return new o(P,0)};function A(S,T){for(;(S[T]&65535)!=S[T];)S[T+1]+=S[T]>>>16,S[T]&=65535,T++}function C(S,T){this.g=S,this.h=T}function N(S,T){if(y(T))throw Error("division by zero");if(y(S))return new C(f,f);if(E(S))return T=N(k(S),T),new C(k(T.g),k(T.h));if(E(T))return T=N(S,k(T)),new C(k(T.g),T.h);if(30<S.g.length){if(E(S)||E(T))throw Error("slowDivide_ only works with positive integers.");for(var P=p,D=T;0>=D.l(S);)P=F(P),D=F(D);var M=V(P,1),O=V(D,1);for(D=V(D,2),P=V(P,2);!y(D);){var L=O.add(D);0>=L.l(S)&&(M=M.add(P),O=L),D=V(D,1),P=V(P,1)}return T=v(S,M.j(T)),new C(M,T)}for(M=f;0<=S.l(T);){for(P=Math.max(1,Math.floor(S.m()/T.m())),D=Math.ceil(Math.log(P)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),O=u(P),L=O.j(T);E(L)||0<L.l(S);)P-=D,O=u(P),L=O.j(T);y(O)&&(O=p),M=M.add(O),S=v(S,L)}return new C(M,S)}n.A=function(S){return N(this,S).h},n.and=function(S){for(var T=Math.max(this.g.length,S.g.length),P=[],D=0;D<T;D++)P[D]=this.i(D)&S.i(D);return new o(P,this.h&S.h)},n.or=function(S){for(var T=Math.max(this.g.length,S.g.length),P=[],D=0;D<T;D++)P[D]=this.i(D)|S.i(D);return new o(P,this.h|S.h)},n.xor=function(S){for(var T=Math.max(this.g.length,S.g.length),P=[],D=0;D<T;D++)P[D]=this.i(D)^S.i(D);return new o(P,this.h^S.h)};function F(S){for(var T=S.g.length+1,P=[],D=0;D<T;D++)P[D]=S.i(D)<<1|S.i(D-1)>>>31;return new o(P,S.h)}function V(S,T){var P=T>>5;T%=32;for(var D=S.g.length-P,M=[],O=0;O<D;O++)M[O]=0<T?S.i(O+P)>>>T|S.i(O+P+1)<<32-T:S.i(O+P);return new o(M,S.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,KR=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Jl=o}).apply(typeof Ix<"u"?Ix:typeof self<"u"?self:typeof window<"u"?window:{});var Em=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XR,Ld,YR,Km,oE,QR,JR,ZR;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,g,_){return h==Array.prototype||h==Object.prototype||(h[g]=_.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Em=="object"&&Em];for(var g=0;g<h.length;++g){var _=h[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function i(h,g){if(g)e:{var _=s;h=h.split(".");for(var R=0;R<h.length-1;R++){var j=h[R];if(!(j in _))break e;_=_[j]}h=h[h.length-1],R=_[h],g=g(R),g!=R&&g!=null&&e(_,h,{configurable:!0,writable:!0,value:g})}}function r(h,g){h instanceof String&&(h+="");var _=0,R=!1,j={next:function(){if(!R&&_<h.length){var B=_++;return{value:g(B,h[B]),done:!1}}return R=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}i("Array.prototype.values",function(h){return h||function(){return r(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(h){var g=typeof h;return g=g!="object"?g:h?Array.isArray(h)?"array":g:"null",g=="array"||g=="object"&&typeof h.length=="number"}function u(h){var g=typeof h;return g=="object"&&h!=null||g=="function"}function d(h,g,_){return h.call.apply(h.bind,arguments)}function f(h,g,_){if(!h)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,R),h.apply(g,j)}}return function(){return h.apply(g,arguments)}}function p(h,g,_){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,p.apply(null,arguments)}function m(h,g){var _=Array.prototype.slice.call(arguments,1);return function(){var R=_.slice();return R.push.apply(R,arguments),h.apply(this,R)}}function y(h,g){function _(){}_.prototype=g.prototype,h.aa=g.prototype,h.prototype=new _,h.prototype.constructor=h,h.Qb=function(R,j,B){for(var X=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)X[Je-2]=arguments[Je];return g.prototype[j].apply(R,X)}}function E(h){const g=h.length;if(0<g){const _=Array(g);for(let R=0;R<g;R++)_[R]=h[R];return _}return[]}function k(h,g){for(let _=1;_<arguments.length;_++){const R=arguments[_];if(l(R)){const j=h.length||0,B=R.length||0;h.length=j+B;for(let X=0;X<B;X++)h[j+X]=R[X]}else h.push(R)}}class v{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function A(h){return/^[\s\xa0]*$/.test(h)}function C(){var h=a.navigator;return h&&(h=h.userAgent)?h:""}function N(h){return N[" "](h),h}N[" "]=function(){};var F=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function V(h,g,_){for(const R in h)g.call(_,h[R],R,h)}function S(h,g){for(const _ in h)g.call(void 0,h[_],_,h)}function T(h){const g={};for(const _ in h)g[_]=h[_];return g}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(h,g){let _,R;for(let j=1;j<arguments.length;j++){R=arguments[j];for(_ in R)h[_]=R[_];for(let B=0;B<P.length;B++)_=P[B],Object.prototype.hasOwnProperty.call(R,_)&&(h[_]=R[_])}}function M(h){var g=1;h=h.split(":");const _=[];for(;0<g&&h.length;)_.push(h.shift()),g--;return h.length&&_.push(h.join(":")),_}function O(h){a.setTimeout(()=>{throw h},0)}function L(){var h=$;let g=null;return h.g&&(g=h.g,h.g=h.g.next,h.g||(h.h=null),g.next=null),g}class ne{constructor(){this.h=this.g=null}add(g,_){const R=Ne.get();R.set(g,_),this.h?this.h.next=R:this.g=R,this.h=R}}var Ne=new v(()=>new de,h=>h.reset());class de{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,z=!1,$=new ne,q=()=>{const h=a.Promise.resolve(void 0);Y=()=>{h.then(oe)}};var oe=()=>{for(var h;h=L();){try{h.h.call(h.g)}catch(_){O(_)}var g=Ne;g.j(h),100>g.h&&(g.h++,h.next=g.g,g.g=h)}z=!1};function se(){this.s=this.s,this.C=this.C}se.prototype.s=!1,se.prototype.ma=function(){this.s||(this.s=!0,this.N())},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(h,g){this.type=h,this.g=this.target=g,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var Ge=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var h=!1,g=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const _=()=>{};a.addEventListener("test",_,g),a.removeEventListener("test",_,g)}catch{}return h}();function _e(h,g){if(J.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var _=this.type=h.type,R=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=g,g=h.relatedTarget){if(F){e:{try{N(g.nodeName);var j=!0;break e}catch{}j=!1}j||(g=null)}}else _=="mouseover"?g=h.fromElement:_=="mouseout"&&(g=h.toElement);this.relatedTarget=g,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Be[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&_e.aa.h.call(this)}}y(_e,J);var Be={2:"touch",3:"pen",4:"mouse"};_e.prototype.h=function(){_e.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var be="closure_listenable_"+(1e6*Math.random()|0),Qs=0;function Da(h,g,_,R,j){this.listener=h,this.proxy=null,this.src=g,this.type=_,this.capture=!!R,this.ha=j,this.key=++Qs,this.da=this.fa=!1}function lr(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Sc(h){this.src=h,this.g={},this.h=0}Sc.prototype.add=function(h,g,_,R,j){var B=h.toString();h=this.g[B],h||(h=this.g[B]=[],this.h++);var X=Kh(h,g,R,j);return-1<X?(g=h[X],_||(g.fa=!1)):(g=new Da(g,this.src,B,!!R,j),g.fa=_,h.push(g)),g};function qh(h,g){var _=g.type;if(_ in h.g){var R=h.g[_],j=Array.prototype.indexOf.call(R,g,void 0),B;(B=0<=j)&&Array.prototype.splice.call(R,j,1),B&&(lr(g),h.g[_].length==0&&(delete h.g[_],h.h--))}}function Kh(h,g,_,R){for(var j=0;j<h.length;++j){var B=h[j];if(!B.da&&B.listener==g&&B.capture==!!_&&B.ha==R)return j}return-1}var Xh="closure_lm_"+(1e6*Math.random()|0),Yh={};function Fg(h,g,_,R,j){if(Array.isArray(g)){for(var B=0;B<g.length;B++)Fg(h,g[B],_,R,j);return null}return _=Zh(_),h&&h[be]?h.K(g,_,u(R)?!!R.capture:!1,j):Mv(h,g,_,!1,R,j)}function Mv(h,g,_,R,j,B){if(!g)throw Error("Invalid event type");var X=u(j)?!!j.capture:!!j,Je=Jh(h);if(Je||(h[Xh]=Je=new Sc(h)),_=Je.add(g,_,R,X,B),_.proxy)return _;if(R=Ov(),_.proxy=R,R.src=h,R.listener=_,h.addEventListener)Ge||(j=X),j===void 0&&(j=!1),h.addEventListener(g.toString(),R,j);else if(h.attachEvent)h.attachEvent(jg(g.toString()),R);else if(h.addListener&&h.removeListener)h.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Ov(){function h(_){return g.call(h.src,h.listener,_)}const g=Fv;return h}function Vg(h,g,_,R,j){if(Array.isArray(g))for(var B=0;B<g.length;B++)Vg(h,g[B],_,R,j);else R=u(R)?!!R.capture:!!R,_=Zh(_),h&&h[be]?(h=h.i,g=String(g).toString(),g in h.g&&(B=h.g[g],_=Kh(B,_,R,j),-1<_&&(lr(B[_]),Array.prototype.splice.call(B,_,1),B.length==0&&(delete h.g[g],h.h--)))):h&&(h=Jh(h))&&(g=h.g[g.toString()],h=-1,g&&(h=Kh(g,_,R,j)),(_=-1<h?g[h]:null)&&Qh(_))}function Qh(h){if(typeof h!="number"&&h&&!h.da){var g=h.src;if(g&&g[be])qh(g.i,h);else{var _=h.type,R=h.proxy;g.removeEventListener?g.removeEventListener(_,R,h.capture):g.detachEvent?g.detachEvent(jg(_),R):g.addListener&&g.removeListener&&g.removeListener(R),(_=Jh(g))?(qh(_,h),_.h==0&&(_.src=null,g[Xh]=null)):lr(h)}}}function jg(h){return h in Yh?Yh[h]:Yh[h]="on"+h}function Fv(h,g){if(h.da)h=!0;else{g=new _e(g,this);var _=h.listener,R=h.ha||h.src;h.fa&&Qh(h),h=_.call(R,g)}return h}function Jh(h){return h=h[Xh],h instanceof Sc?h:null}var xc="__closure_events_fn_"+(1e9*Math.random()>>>0);function Zh(h){return typeof h=="function"?h:(h[xc]||(h[xc]=function(g){return h.handleEvent(g)}),h[xc])}function Ht(){se.call(this),this.i=new Sc(this),this.M=this,this.F=null}y(Ht,se),Ht.prototype[be]=!0,Ht.prototype.removeEventListener=function(h,g,_,R){Vg(this,h,g,_,R)};function Wt(h,g){var _,R=h.F;if(R)for(_=[];R;R=R.F)_.push(R);if(h=h.M,R=g.type||g,typeof g=="string")g=new J(g,h);else if(g instanceof J)g.target=g.target||h;else{var j=g;g=new J(R,h),D(g,j)}if(j=!0,_)for(var B=_.length-1;0<=B;B--){var X=g.g=_[B];j=Ic(X,R,!0,g)&&j}if(X=g.g=h,j=Ic(X,R,!0,g)&&j,j=Ic(X,R,!1,g)&&j,_)for(B=0;B<_.length;B++)X=g.g=_[B],j=Ic(X,R,!1,g)&&j}Ht.prototype.N=function(){if(Ht.aa.N.call(this),this.i){var h=this.i,g;for(g in h.g){for(var _=h.g[g],R=0;R<_.length;R++)lr(_[R]);delete h.g[g],h.h--}}this.F=null},Ht.prototype.K=function(h,g,_,R){return this.i.add(String(h),g,!1,_,R)},Ht.prototype.L=function(h,g,_,R){return this.i.add(String(h),g,!0,_,R)};function Ic(h,g,_,R){if(g=h.i.g[String(g)],!g)return!0;g=g.concat();for(var j=!0,B=0;B<g.length;++B){var X=g[B];if(X&&!X.da&&X.capture==_){var Je=X.listener,en=X.ha||X.src;X.fa&&qh(h.i,X),j=Je.call(en,R)!==!1&&j}}return j&&!R.defaultPrevented}function ed(h,g,_){if(typeof h=="function")_&&(h=p(h,_));else if(h&&typeof h.handleEvent=="function")h=p(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(h,g||0)}function Ug(h){h.g=ed(()=>{h.g=null,h.i&&(h.i=!1,Ug(h))},h.l);const g=h.h;h.h=null,h.m.apply(null,g)}class Vv extends se{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Ug(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function La(h){se.call(this),this.h=h,this.g={}}y(La,se);var td=[];function nd(h){V(h.g,function(g,_){this.g.hasOwnProperty(_)&&Qh(g)},h),h.g={}}La.prototype.N=function(){La.aa.N.call(this),nd(this)},La.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var U=a.JSON.stringify,re=a.JSON.parse,Ee=class{stringify(h){return a.JSON.stringify(h,void 0)}parse(h){return a.JSON.parse(h,void 0)}};function Qe(){}Qe.prototype.h=null;function Ze(h){return h.h||(h.h=h.i())}function cr(){}var sd={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function jv(){J.call(this,"d")}y(jv,J);function Uv(){J.call(this,"c")}y(Uv,J);var Ma={},YT=null;function Bg(){return YT=YT||new Ht}Ma.La="serverreachability";function QT(h){J.call(this,Ma.La,h)}y(QT,J);function id(h){const g=Bg();Wt(g,new QT(g))}Ma.STAT_EVENT="statevent";function JT(h,g){J.call(this,Ma.STAT_EVENT,h),this.stat=g}y(JT,J);function Dn(h){const g=Bg();Wt(g,new JT(g,h))}Ma.Ma="timingevent";function ZT(h,g){J.call(this,Ma.Ma,h),this.size=g}y(ZT,J);function rd(h,g){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){h()},g)}function od(){this.g=!0}od.prototype.xa=function(){this.g=!1};function S2(h,g,_,R,j,B){h.info(function(){if(h.g)if(B)for(var X="",Je=B.split("&"),en=0;en<Je.length;en++){var Fe=Je[en].split("=");if(1<Fe.length){var gn=Fe[0];Fe=Fe[1];var mn=gn.split("_");X=2<=mn.length&&mn[1]=="type"?X+(gn+"="+Fe+"&"):X+(gn+"=redacted&")}}else X=null;else X=B;return"XMLHTTP REQ ("+R+") [attempt "+j+"]: "+g+`
`+_+`
`+X})}function x2(h,g,_,R,j,B,X){h.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+j+"]: "+g+`
`+_+`
`+B+" "+X})}function Cc(h,g,_,R){h.info(function(){return"XMLHTTP TEXT ("+g+"): "+C2(h,_)+(R?" "+R:"")})}function I2(h,g){h.info(function(){return"TIMEOUT: "+g})}od.prototype.info=function(){};function C2(h,g){if(!h.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(h=0;h<_.length;h++)if(Array.isArray(_[h])){var R=_[h];if(!(2>R.length)){var j=R[1];if(Array.isArray(j)&&!(1>j.length)){var B=j[0];if(B!="noop"&&B!="stop"&&B!="close")for(var X=1;X<j.length;X++)j[X]=""}}}}return U(_)}catch{return g}}var zg={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},eS={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Bv;function $g(){}y($g,Qe),$g.prototype.g=function(){return new XMLHttpRequest},$g.prototype.i=function(){return{}},Bv=new $g;function ho(h,g,_,R){this.j=h,this.i=g,this.l=_,this.R=R||1,this.U=new La(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new tS}function tS(){this.i=null,this.g="",this.h=!1}var nS={},zv={};function $v(h,g,_){h.L=1,h.v=qg(ur(g)),h.m=_,h.P=!0,sS(h,null)}function sS(h,g){h.F=Date.now(),Hg(h),h.A=ur(h.v);var _=h.A,R=h.R;Array.isArray(R)||(R=[String(R)]),yS(_.i,"t",R),h.C=0,_=h.j.J,h.h=new tS,h.g=MS(h.j,_?g:null,!h.m),0<h.O&&(h.M=new Vv(p(h.Y,h,h.g),h.O)),g=h.U,_=h.g,R=h.ca;var j="readystatechange";Array.isArray(j)||(j&&(td[0]=j.toString()),j=td);for(var B=0;B<j.length;B++){var X=Fg(_,j[B],R||g.handleEvent,!1,g.h||g);if(!X)break;g.g[X.key]=X}g=h.H?T(h.H):{},h.m?(h.u||(h.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,g)):(h.u="GET",h.g.ea(h.A,h.u,null,g)),id(),S2(h.i,h.u,h.A,h.l,h.R,h.m)}ho.prototype.ca=function(h){h=h.target;const g=this.M;g&&hr(h)==3?g.j():this.Y(h)},ho.prototype.Y=function(h){try{if(h==this.g)e:{const mn=hr(this.g);var g=this.g.Ba();const Pc=this.g.Z();if(!(3>mn)&&(mn!=3||this.g&&(this.h.h||this.g.oa()||TS(this.g)))){this.J||mn!=4||g==7||(g==8||0>=Pc?id(3):id(2)),Hv(this);var _=this.g.Z();this.X=_;t:if(iS(this)){var R=TS(this.g);h="";var j=R.length,B=hr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Oa(this),ad(this);var X="";break t}this.h.i=new a.TextDecoder}for(g=0;g<j;g++)this.h.h=!0,h+=this.h.i.decode(R[g],{stream:!(B&&g==j-1)});R.length=0,this.h.g+=h,this.C=0,X=this.h.g}else X=this.g.oa();if(this.o=_==200,x2(this.i,this.u,this.A,this.l,this.R,mn,_),this.o){if(this.T&&!this.K){t:{if(this.g){var Je,en=this.g;if((Je=en.g?en.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(Je)){var Fe=Je;break t}}Fe=null}if(_=Fe)Cc(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wv(this,_);else{this.o=!1,this.s=3,Dn(12),Oa(this),ad(this);break e}}if(this.P){_=!0;let Js;for(;!this.J&&this.C<X.length;)if(Js=k2(this,X),Js==zv){mn==4&&(this.s=4,Dn(14),_=!1),Cc(this.i,this.l,null,"[Incomplete Response]");break}else if(Js==nS){this.s=4,Dn(15),Cc(this.i,this.l,X,"[Invalid Chunk]"),_=!1;break}else Cc(this.i,this.l,Js,null),Wv(this,Js);if(iS(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mn!=4||X.length!=0||this.h.h||(this.s=1,Dn(16),_=!1),this.o=this.o&&_,!_)Cc(this.i,this.l,X,"[Invalid Chunked Response]"),Oa(this),ad(this);else if(0<X.length&&!this.W){this.W=!0;var gn=this.j;gn.g==this&&gn.ba&&!gn.M&&(gn.j.info("Great, no buffering proxy detected. Bytes received: "+X.length),Qv(gn),gn.M=!0,Dn(11))}}else Cc(this.i,this.l,X,null),Wv(this,X);mn==4&&Oa(this),this.o&&!this.J&&(mn==4?PS(this.j,this):(this.o=!1,Hg(this)))}else G2(this.g),_==400&&0<X.indexOf("Unknown SID")?(this.s=3,Dn(12)):(this.s=0,Dn(13)),Oa(this),ad(this)}}}catch{}finally{}};function iS(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function k2(h,g){var _=h.C,R=g.indexOf(`
`,_);return R==-1?zv:(_=Number(g.substring(_,R)),isNaN(_)?nS:(R+=1,R+_>g.length?zv:(g=g.slice(R,R+_),h.C=R+_,g)))}ho.prototype.cancel=function(){this.J=!0,Oa(this)};function Hg(h){h.S=Date.now()+h.I,rS(h,h.I)}function rS(h,g){if(h.B!=null)throw Error("WatchDog timer not null");h.B=rd(p(h.ba,h),g)}function Hv(h){h.B&&(a.clearTimeout(h.B),h.B=null)}ho.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(I2(this.i,this.A),this.L!=2&&(id(),Dn(17)),Oa(this),this.s=2,ad(this)):rS(this,this.S-h)};function ad(h){h.j.G==0||h.J||PS(h.j,h)}function Oa(h){Hv(h);var g=h.M;g&&typeof g.ma=="function"&&g.ma(),h.M=null,nd(h.U),h.g&&(g=h.g,h.g=null,g.abort(),g.ma())}function Wv(h,g){try{var _=h.j;if(_.G!=0&&(_.g==h||Gv(_.h,h))){if(!h.K&&Gv(_.h,h)&&_.G==3){try{var R=_.Da.g.parse(g)}catch{R=null}if(Array.isArray(R)&&R.length==3){var j=R;if(j[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<h.F)Zg(_),Qg(_);else break e;Yv(_),Dn(18)}}else _.za=j[1],0<_.za-_.T&&37500>j[2]&&_.F&&_.v==0&&!_.C&&(_.C=rd(p(_.Za,_),6e3));if(1>=lS(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Va(_,11)}else if((h.K||_.g==h)&&Zg(_),!A(g))for(j=_.Da.g.parse(g),g=0;g<j.length;g++){let Fe=j[g];if(_.T=Fe[0],Fe=Fe[1],_.G==2)if(Fe[0]=="c"){_.K=Fe[1],_.ia=Fe[2];const gn=Fe[3];gn!=null&&(_.la=gn,_.j.info("VER="+_.la));const mn=Fe[4];mn!=null&&(_.Aa=mn,_.j.info("SVER="+_.Aa));const Pc=Fe[5];Pc!=null&&typeof Pc=="number"&&0<Pc&&(R=1.5*Pc,_.L=R,_.j.info("backChannelRequestTimeoutMs_="+R)),R=_;const Js=h.g;if(Js){const tm=Js.g?Js.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(tm){var B=R.h;B.g||tm.indexOf("spdy")==-1&&tm.indexOf("quic")==-1&&tm.indexOf("h2")==-1||(B.j=B.l,B.g=new Set,B.h&&(qv(B,B.h),B.h=null))}if(R.D){const Jv=Js.g?Js.g.getResponseHeader("X-HTTP-Session-Id"):null;Jv&&(R.ya=Jv,st(R.I,R.D,Jv))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-h.F,_.j.info("Handshake RTT: "+_.R+"ms")),R=_;var X=h;if(R.qa=LS(R,R.J?R.ia:null,R.W),X.K){cS(R.h,X);var Je=X,en=R.L;en&&(Je.I=en),Je.B&&(Hv(Je),Hg(Je)),R.g=X}else kS(R);0<_.i.length&&Jg(_)}else Fe[0]!="stop"&&Fe[0]!="close"||Va(_,7);else _.G==3&&(Fe[0]=="stop"||Fe[0]=="close"?Fe[0]=="stop"?Va(_,7):Xv(_):Fe[0]!="noop"&&_.l&&_.l.ta(Fe),_.v=0)}}id(4)}catch{}}var R2=class{constructor(h,g){this.g=h,this.map=g}};function oS(h){this.l=h||10,a.PerformanceNavigationTiming?(h=a.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function aS(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function lS(h){return h.h?1:h.g?h.g.size:0}function Gv(h,g){return h.h?h.h==g:h.g?h.g.has(g):!1}function qv(h,g){h.g?h.g.add(g):h.h=g}function cS(h,g){h.h&&h.h==g?h.h=null:h.g&&h.g.has(g)&&h.g.delete(g)}oS.prototype.cancel=function(){if(this.i=uS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function uS(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let g=h.i;for(const _ of h.g.values())g=g.concat(_.D);return g}return E(h.i)}function P2(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var g=[],_=h.length,R=0;R<_;R++)g.push(h[R]);return g}g=[],_=0;for(R in h)g[_++]=h[R];return g}function N2(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var g=[];h=h.length;for(var _=0;_<h;_++)g.push(_);return g}g=[],_=0;for(const R in h)g[_++]=R;return g}}}function hS(h,g){if(h.forEach&&typeof h.forEach=="function")h.forEach(g,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,g,void 0);else for(var _=N2(h),R=P2(h),j=R.length,B=0;B<j;B++)g.call(void 0,R[B],_&&_[B],h)}var dS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function D2(h,g){if(h){h=h.split("&");for(var _=0;_<h.length;_++){var R=h[_].indexOf("="),j=null;if(0<=R){var B=h[_].substring(0,R);j=h[_].substring(R+1)}else B=h[_];g(B,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function Fa(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Fa){this.h=h.h,Wg(this,h.j),this.o=h.o,this.g=h.g,Gg(this,h.s),this.l=h.l;var g=h.i,_=new ud;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),fS(this,_),this.m=h.m}else h&&(g=String(h).match(dS))?(this.h=!1,Wg(this,g[1]||"",!0),this.o=ld(g[2]||""),this.g=ld(g[3]||"",!0),Gg(this,g[4]),this.l=ld(g[5]||"",!0),fS(this,g[6]||"",!0),this.m=ld(g[7]||"")):(this.h=!1,this.i=new ud(null,this.h))}Fa.prototype.toString=function(){var h=[],g=this.j;g&&h.push(cd(g,pS,!0),":");var _=this.g;return(_||g=="file")&&(h.push("//"),(g=this.o)&&h.push(cd(g,pS,!0),"@"),h.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&h.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&h.push("/"),h.push(cd(_,_.charAt(0)=="/"?O2:M2,!0))),(_=this.i.toString())&&h.push("?",_),(_=this.m)&&h.push("#",cd(_,V2)),h.join("")};function ur(h){return new Fa(h)}function Wg(h,g,_){h.j=_?ld(g,!0):g,h.j&&(h.j=h.j.replace(/:$/,""))}function Gg(h,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);h.s=g}else h.s=null}function fS(h,g,_){g instanceof ud?(h.i=g,j2(h.i,h.h)):(_||(g=cd(g,F2)),h.i=new ud(g,h.h))}function st(h,g,_){h.i.set(g,_)}function qg(h){return st(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function ld(h,g){return h?g?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function cd(h,g,_){return typeof h=="string"?(h=encodeURI(h).replace(g,L2),_&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function L2(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var pS=/[#\/\?@]/g,M2=/[#\?:]/g,O2=/[#\?]/g,F2=/[#\?@]/g,V2=/#/g;function ud(h,g){this.h=this.g=null,this.i=h||null,this.j=!!g}function fo(h){h.g||(h.g=new Map,h.h=0,h.i&&D2(h.i,function(g,_){h.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=ud.prototype,n.add=function(h,g){fo(this),this.i=null,h=kc(this,h);var _=this.g.get(h);return _||this.g.set(h,_=[]),_.push(g),this.h+=1,this};function gS(h,g){fo(h),g=kc(h,g),h.g.has(g)&&(h.i=null,h.h-=h.g.get(g).length,h.g.delete(g))}function mS(h,g){return fo(h),g=kc(h,g),h.g.has(g)}n.forEach=function(h,g){fo(this),this.g.forEach(function(_,R){_.forEach(function(j){h.call(g,j,R,this)},this)},this)},n.na=function(){fo(this);const h=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let R=0;R<g.length;R++){const j=h[R];for(let B=0;B<j.length;B++)_.push(g[R])}return _},n.V=function(h){fo(this);let g=[];if(typeof h=="string")mS(this,h)&&(g=g.concat(this.g.get(kc(this,h))));else{h=Array.from(this.g.values());for(let _=0;_<h.length;_++)g=g.concat(h[_])}return g},n.set=function(h,g){return fo(this),this.i=null,h=kc(this,h),mS(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[g]),this.h+=1,this},n.get=function(h,g){return h?(h=this.V(h),0<h.length?String(h[0]):g):g};function yS(h,g,_){gS(h,g),0<_.length&&(h.i=null,h.g.set(kc(h,g),E(_)),h.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var R=g[_];const B=encodeURIComponent(String(R)),X=this.V(R);for(R=0;R<X.length;R++){var j=B;X[R]!==""&&(j+="="+encodeURIComponent(String(X[R]))),h.push(j)}}return this.i=h.join("&")};function kc(h,g){return g=String(g),h.j&&(g=g.toLowerCase()),g}function j2(h,g){g&&!h.j&&(fo(h),h.i=null,h.g.forEach(function(_,R){var j=R.toLowerCase();R!=j&&(gS(this,R),yS(this,j,_))},h)),h.j=g}function U2(h,g){const _=new od;if(a.Image){const R=new Image;R.onload=m(po,_,"TestLoadImage: loaded",!0,g,R),R.onerror=m(po,_,"TestLoadImage: error",!1,g,R),R.onabort=m(po,_,"TestLoadImage: abort",!1,g,R),R.ontimeout=m(po,_,"TestLoadImage: timeout",!1,g,R),a.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=h}else g(!1)}function B2(h,g){const _=new od,R=new AbortController,j=setTimeout(()=>{R.abort(),po(_,"TestPingServer: timeout",!1,g)},1e4);fetch(h,{signal:R.signal}).then(B=>{clearTimeout(j),B.ok?po(_,"TestPingServer: ok",!0,g):po(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(j),po(_,"TestPingServer: error",!1,g)})}function po(h,g,_,R,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),R(_)}catch{}}function z2(){this.g=new Ee}function $2(h,g,_){const R=_||"";try{hS(h,function(j,B){let X=j;u(j)&&(X=U(j)),g.push(R+B+"="+encodeURIComponent(X))})}catch(j){throw g.push(R+"type="+encodeURIComponent("_badmap")),j}}function Kg(h){this.l=h.Ub||null,this.j=h.eb||!1}y(Kg,Qe),Kg.prototype.g=function(){return new Xg(this.l,this.j)},Kg.prototype.i=function(h){return function(){return h}}({});function Xg(h,g){Ht.call(this),this.D=h,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Xg,Ht),n=Xg.prototype,n.open=function(h,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=g,this.readyState=1,dd(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(g.body=h),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,hd(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,dd(this)),this.g&&(this.readyState=3,dd(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_S(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function _S(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var g=h.value?h.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!h.done}))&&(this.response=this.responseText+=g)}h.done?hd(this):dd(this),this.readyState==3&&_S(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,hd(this))},n.Qa=function(h){this.g&&(this.response=h,hd(this))},n.ga=function(){this.g&&hd(this)};function hd(h){h.readyState=4,h.l=null,h.j=null,h.v=null,dd(h)}n.setRequestHeader=function(h,g){this.u.append(h,g)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,h.push(_[0]+": "+_[1]),_=g.next();return h.join(`\r
`)};function dd(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Xg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function vS(h){let g="";return V(h,function(_,R){g+=R,g+=":",g+=_,g+=`\r
`}),g}function Kv(h,g,_){e:{for(R in _){var R=!1;break e}R=!0}R||(_=vS(_),typeof h=="string"?_!=null&&encodeURIComponent(String(_)):st(h,g,_))}function wt(h){Ht.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(wt,Ht);var H2=/^https?$/i,W2=["POST","PUT"];n=wt.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,g,_,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);g=g?g.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Bv.g(),this.v=this.o?Ze(this.o):Ze(Bv),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(g,String(h),!0),this.B=!1}catch(B){wS(this,B);return}if(h=_||"",_=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var j in R)_.set(j,R[j]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const B of R.keys())_.set(B,R.get(B));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(_.keys()).find(B=>B.toLowerCase()=="content-type"),j=a.FormData&&h instanceof a.FormData,!(0<=Array.prototype.indexOf.call(W2,g,void 0))||R||j||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[B,X]of _)this.g.setRequestHeader(B,X);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{bS(this),this.u=!0,this.g.send(h),this.u=!1}catch(B){wS(this,B)}};function wS(h,g){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=g,h.m=5,ES(h),Yg(h)}function ES(h){h.A||(h.A=!0,Wt(h,"complete"),Wt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Wt(this,"complete"),Wt(this,"abort"),Yg(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yg(this,!0)),wt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?AS(this):this.bb())},n.bb=function(){AS(this)};function AS(h){if(h.h&&typeof o<"u"&&(!h.v[1]||hr(h)!=4||h.Z()!=2)){if(h.u&&hr(h)==4)ed(h.Ea,0,h);else if(Wt(h,"readystatechange"),hr(h)==4){h.h=!1;try{const X=h.Z();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var R;if(R=X===0){var j=String(h.D).match(dS)[1]||null;!j&&a.self&&a.self.location&&(j=a.self.location.protocol.slice(0,-1)),R=!H2.test(j?j.toLowerCase():"")}_=R}if(_)Wt(h,"complete"),Wt(h,"success");else{h.m=6;try{var B=2<hr(h)?h.g.statusText:""}catch{B=""}h.l=B+" ["+h.Z()+"]",ES(h)}}finally{Yg(h)}}}}function Yg(h,g){if(h.g){bS(h);const _=h.g,R=h.v[0]?()=>{}:null;h.g=null,h.v=null,g||Wt(h,"ready");try{_.onreadystatechange=R}catch{}}}function bS(h){h.I&&(a.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function hr(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<hr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var g=this.g.responseText;return h&&g.indexOf(h)==0&&(g=g.substring(h.length)),re(g)}};function TS(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function G2(h){const g={};h=(h.g&&2<=hr(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<h.length;R++){if(A(h[R]))continue;var _=M(h[R]);const j=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const B=g[j]||[];g[j]=B,B.push(_)}S(g,function(R){return R.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function fd(h,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[h]||g}function SS(h){this.Aa=0,this.i=[],this.j=new od,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=fd("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=fd("baseRetryDelayMs",5e3,h),this.cb=fd("retryDelaySeedMs",1e4,h),this.Wa=fd("forwardChannelMaxRetries",2,h),this.wa=fd("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new oS(h&&h.concurrentRequestLimit),this.Da=new z2,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=SS.prototype,n.la=8,n.G=1,n.connect=function(h,g,_,R){Dn(0),this.W=h,this.H=g||{},_&&R!==void 0&&(this.H.OSID=_,this.H.OAID=R),this.F=this.X,this.I=LS(this,null,this.W),Jg(this)};function Xv(h){if(xS(h),h.G==3){var g=h.U++,_=ur(h.I);if(st(_,"SID",h.K),st(_,"RID",g),st(_,"TYPE","terminate"),pd(h,_),g=new ho(h,h.j,g),g.L=2,g.v=qg(ur(_)),_=!1,a.navigator&&a.navigator.sendBeacon)try{_=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&a.Image&&(new Image().src=g.v,_=!0),_||(g.g=MS(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Hg(g)}DS(h)}function Qg(h){h.g&&(Qv(h),h.g.cancel(),h.g=null)}function xS(h){Qg(h),h.u&&(a.clearTimeout(h.u),h.u=null),Zg(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&a.clearTimeout(h.s),h.s=null)}function Jg(h){if(!aS(h.h)&&!h.s){h.s=!0;var g=h.Ga;Y||q(),z||(Y(),z=!0),$.add(g,h),h.B=0}}function q2(h,g){return lS(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=g.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=rd(p(h.Ga,h,g),NS(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const j=new ho(this,this.j,h);let B=this.o;if(this.S&&(B?(B=T(B),D(B,this.S)):B=this.S),this.m!==null||this.O||(j.H=B,B=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var R=this.i[_];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(g+=R,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=CS(this,j,g),_=ur(this.I),st(_,"RID",h),st(_,"CVER",22),this.D&&st(_,"X-HTTP-Session-Id",this.D),pd(this,_),B&&(this.O?g="headers="+encodeURIComponent(String(vS(B)))+"&"+g:this.m&&Kv(_,this.m,B)),qv(this.h,j),this.Ua&&st(_,"TYPE","init"),this.P?(st(_,"$req",g),st(_,"SID","null"),j.T=!0,$v(j,_,null)):$v(j,_,g),this.G=2}}else this.G==3&&(h?IS(this,h):this.i.length==0||aS(this.h)||IS(this))};function IS(h,g){var _;g?_=g.l:_=h.U++;const R=ur(h.I);st(R,"SID",h.K),st(R,"RID",_),st(R,"AID",h.T),pd(h,R),h.m&&h.o&&Kv(R,h.m,h.o),_=new ho(h,h.j,_,h.B+1),h.m===null&&(_.H=h.o),g&&(h.i=g.D.concat(h.i)),g=CS(h,_,1e3),_.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),qv(h.h,_),$v(_,R,g)}function pd(h,g){h.H&&V(h.H,function(_,R){st(g,R,_)}),h.l&&hS({},function(_,R){st(g,R,_)})}function CS(h,g,_){_=Math.min(h.i.length,_);var R=h.l?p(h.l.Na,h.l,h):null;e:{var j=h.i;let B=-1;for(;;){const X=["count="+_];B==-1?0<_?(B=j[0].g,X.push("ofs="+B)):B=0:X.push("ofs="+B);let Je=!0;for(let en=0;en<_;en++){let Fe=j[en].g;const gn=j[en].map;if(Fe-=B,0>Fe)B=Math.max(0,j[en].g-100),Je=!1;else try{$2(gn,X,"req"+Fe+"_")}catch{R&&R(gn)}}if(Je){R=X.join("&");break e}}}return h=h.i.splice(0,_),g.D=h,R}function kS(h){if(!h.g&&!h.u){h.Y=1;var g=h.Fa;Y||q(),z||(Y(),z=!0),$.add(g,h),h.v=0}}function Yv(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=rd(p(h.Fa,h),NS(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,RS(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=rd(p(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Dn(10),Qg(this),RS(this))};function Qv(h){h.A!=null&&(a.clearTimeout(h.A),h.A=null)}function RS(h){h.g=new ho(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var g=ur(h.qa);st(g,"RID","rpc"),st(g,"SID",h.K),st(g,"AID",h.T),st(g,"CI",h.F?"0":"1"),!h.F&&h.ja&&st(g,"TO",h.ja),st(g,"TYPE","xmlhttp"),pd(h,g),h.m&&h.o&&Kv(g,h.m,h.o),h.L&&(h.g.I=h.L);var _=h.g;h=h.ia,_.L=1,_.v=qg(ur(g)),_.m=null,_.P=!0,sS(_,h)}n.Za=function(){this.C!=null&&(this.C=null,Qg(this),Yv(this),Dn(19))};function Zg(h){h.C!=null&&(a.clearTimeout(h.C),h.C=null)}function PS(h,g){var _=null;if(h.g==g){Zg(h),Qv(h),h.g=null;var R=2}else if(Gv(h.h,g))_=g.D,cS(h.h,g),R=1;else return;if(h.G!=0){if(g.o)if(R==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var j=h.B;R=Bg(),Wt(R,new ZT(R,_)),Jg(h)}else kS(h);else if(j=g.s,j==3||j==0&&0<g.X||!(R==1&&q2(h,g)||R==2&&Yv(h)))switch(_&&0<_.length&&(g=h.h,g.i=g.i.concat(_)),j){case 1:Va(h,5);break;case 4:Va(h,10);break;case 3:Va(h,6);break;default:Va(h,2)}}}function NS(h,g){let _=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(_*=2),_*g}function Va(h,g){if(h.j.info("Error code "+g),g==2){var _=p(h.fb,h),R=h.Xa;const j=!R;R=new Fa(R||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Wg(R,"https"),qg(R),j?U2(R.toString(),_):B2(R.toString(),_)}else Dn(2);h.G=0,h.l&&h.l.sa(g),DS(h),xS(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Dn(2)):(this.j.info("Failed to ping google.com"),Dn(1))};function DS(h){if(h.G=0,h.ka=[],h.l){const g=uS(h.h);(g.length!=0||h.i.length!=0)&&(k(h.ka,g),k(h.ka,h.i),h.h.i.length=0,E(h.i),h.i.length=0),h.l.ra()}}function LS(h,g,_){var R=_ instanceof Fa?ur(_):new Fa(_);if(R.g!="")g&&(R.g=g+"."+R.g),Gg(R,R.s);else{var j=a.location;R=j.protocol,g=g?g+"."+j.hostname:j.hostname,j=+j.port;var B=new Fa(null);R&&Wg(B,R),g&&(B.g=g),j&&Gg(B,j),_&&(B.l=_),R=B}return _=h.D,g=h.ya,_&&g&&st(R,_,g),st(R,"VER",h.la),pd(h,R),R}function MS(h,g,_){if(g&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=h.Ca&&!h.pa?new wt(new Kg({eb:_})):new wt(h.pa),g.Ha(h.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function OS(){}n=OS.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function em(){}em.prototype.g=function(h,g){return new cs(h,g)};function cs(h,g){Ht.call(this),this.g=new SS(g),this.l=h,this.h=g&&g.messageUrlParams||null,h=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(h?h["X-WebChannel-Content-Type"]=g.messageContentType:h={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(h?h["X-WebChannel-Client-Profile"]=g.va:h={"X-WebChannel-Client-Profile":g.va}),this.g.S=h,(h=g&&g.Sb)&&!A(h)&&(this.g.m=h),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!A(g)&&(this.g.D=g,h=this.h,h!==null&&g in h&&(h=this.h,g in h&&delete h[g])),this.j=new Rc(this)}y(cs,Ht),cs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},cs.prototype.close=function(){Xv(this.g)},cs.prototype.o=function(h){var g=this.g;if(typeof h=="string"){var _={};_.__data__=h,h=_}else this.u&&(_={},_.__data__=U(h),h=_);g.i.push(new R2(g.Ya++,h)),g.G==3&&Jg(g)},cs.prototype.N=function(){this.g.l=null,delete this.j,Xv(this.g),delete this.g,cs.aa.N.call(this)};function FS(h){jv.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var g=h.__sm__;if(g){e:{for(const _ in g){h=_;break e}h=void 0}(this.i=h)&&(h=this.i,g=g!==null&&h in g?g[h]:void 0),this.data=g}else this.data=h}y(FS,jv);function VS(){Uv.call(this),this.status=1}y(VS,Uv);function Rc(h){this.g=h}y(Rc,OS),Rc.prototype.ua=function(){Wt(this.g,"a")},Rc.prototype.ta=function(h){Wt(this.g,new FS(h))},Rc.prototype.sa=function(h){Wt(this.g,new VS)},Rc.prototype.ra=function(){Wt(this.g,"b")},em.prototype.createWebChannel=em.prototype.g,cs.prototype.send=cs.prototype.o,cs.prototype.open=cs.prototype.m,cs.prototype.close=cs.prototype.close,ZR=function(){return new em},JR=function(){return Bg()},QR=Ma,oE={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},zg.NO_ERROR=0,zg.TIMEOUT=8,zg.HTTP_ERROR=6,Km=zg,eS.COMPLETE="complete",YR=eS,cr.EventType=sd,sd.OPEN="a",sd.CLOSE="b",sd.ERROR="c",sd.MESSAGE="d",Ht.prototype.listen=Ht.prototype.K,Ld=cr,wt.prototype.listenOnce=wt.prototype.L,wt.prototype.getLastError=wt.prototype.Ka,wt.prototype.getLastErrorCode=wt.prototype.Ba,wt.prototype.getStatus=wt.prototype.Z,wt.prototype.getResponseJson=wt.prototype.Oa,wt.prototype.getResponseText=wt.prototype.oa,wt.prototype.send=wt.prototype.ea,wt.prototype.setWithCredentials=wt.prototype.Ha,XR=wt}).apply(typeof Em<"u"?Em:typeof self<"u"?self:typeof window<"u"?window:{});const Cx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}In.UNAUTHENTICATED=new In(null),In.GOOGLE_CREDENTIALS=new In("google-credentials-uid"),In.FIRST_PARTY=new In("first-party-uid"),In.MOCK_USER=new In("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $h="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc=new Nb("@firebase/firestore");function bd(){return lc.logLevel}function ie(n,...e){if(lc.logLevel<=Re.DEBUG){const t=e.map(Hb);lc.debug(`Firestore (${$h}): ${n}`,...t)}}function ao(n,...e){if(lc.logLevel<=Re.ERROR){const t=e.map(Hb);lc.error(`Firestore (${$h}): ${n}`,...t)}}function Ph(n,...e){if(lc.logLevel<=Re.WARN){const t=e.map(Hb);lc.warn(`Firestore (${$h}): ${n}`,...t)}}function Hb(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(n="Unexpected state"){const e=`FIRESTORE (${$h}) INTERNAL ASSERTION FAILED: `+n;throw ao(e),new Error(e)}function We(n,e){n||pe()}function ye(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ce extends ar{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class P4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(In.UNAUTHENTICATED))}shutdown(){}}class N4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class D4{constructor(e){this.t=e,this.currentUser=In.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){We(this.o===void 0);let s=this.i;const i=l=>this.i!==s?(s=this.i,t(l)):Promise.resolve();let r=new Jr;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Jr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=r;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Jr)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(s=>this.i!==e?(ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(We(typeof s.accessToken=="string"),new eP(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return We(e===null||typeof e=="string"),new In(e)}}class L4{constructor(e,t,s){this.l=e,this.h=t,this.P=s,this.type="FirstParty",this.user=In.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class M4{constructor(e,t,s){this.l=e,this.h=t,this.P=s}getToken(){return Promise.resolve(new L4(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(In.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class O4{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class F4{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){We(this.o===void 0);const s=r=>{r.error!=null&&ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.R;return this.R=r.token,ie("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>s(r))};const i=r=>{ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(r=>i(r)),setTimeout(()=>{if(!this.appCheck){const r=this.A.getImmediate({optional:!0});r?i(r):ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(We(typeof t.token=="string"),this.R=t.token,new O4(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const i=V4(40);for(let r=0;r<i.length;++r)s.length<20&&i[r]<t&&(s+=e.charAt(i[r]%e.length))}return s}}function Ve(n,e){return n<e?-1:n>e?1:0}function Nh(n,e,t){return n.length===e.length&&n.every((s,i)=>t(s,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ce(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ce(H.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ce(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ce(H.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return $t.fromMillis(Date.now())}static fromDate(e){return $t.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*t));return new $t(t,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.timestamp=e}static fromTimestamp(e){return new me(e)}static min(){return new me(new $t(0,0))}static max(){return new me(new $t(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t,s){t===void 0?t=0:t>e.length&&pe(),s===void 0?s=e.length-t:s>e.length-t&&pe(),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Uf.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Uf?e.forEach(s=>{t.push(s)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let i=0;i<s;i++){const r=e.get(i),o=t.get(i);if(r<o)return-1;if(r>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ht extends Uf{construct(e,t,s){return new ht(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new ce(H.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter(i=>i.length>0))}return new ht(t)}static emptyPath(){return new ht([])}}const j4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class un extends Uf{construct(e,t,s){return new un(e,t,s)}static isValidIdentifier(e){return j4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),un.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new un(["__name__"])}static fromServerFormat(e){const t=[];let s="",i=0;const r=()=>{if(s.length===0)throw new ce(H.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new ce(H.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ce(H.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(s+=a,i++):(r(),i++)}if(r(),o)throw new ce(H.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new un(t)}static emptyPath(){return new un([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.path=e}static fromPath(e){return new he(ht.fromString(e))}static fromName(e){return new he(ht.fromString(e).popFirst(5))}static empty(){return new he(ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ht.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new he(new ht(e.slice()))}}function U4(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,i=me.fromTimestamp(s===1e9?new $t(t+1,0):new $t(t,s));return new wa(i,he.empty(),e)}function B4(n){return new wa(n.readTime,n.key,-1)}class wa{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new wa(me.min(),he.empty(),-1)}static max(){return new wa(me.max(),he.empty(),-1)}}function z4(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=he.comparator(n.documentKey,e.documentKey),t!==0?t:Ve(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class H4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sg(n){if(n.code!==H.FAILED_PRECONDITION||n.message!==$4)throw n;ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&pe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new W((s,i)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(s,i)},this.catchCallback=r=>{this.wrapFailure(t,r).next(s,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof W?t:W.resolve(t)}catch(t){return W.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):W.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):W.reject(t)}static resolve(e){return new W((t,s)=>{t(e)})}static reject(e){return new W((t,s)=>{s(e)})}static waitFor(e){return new W((t,s)=>{let i=0,r=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++r,o&&r===i&&t()},l=>s(l))}),o=!0,r===i&&t()})}static or(e){let t=W.resolve(!1);for(const s of e)t=t.next(i=>i?W.resolve(i):s());return t}static forEach(e,t){const s=[];return e.forEach((i,r)=>{s.push(t.call(this,i,r))}),this.waitFor(s)}static mapArray(e,t){return new W((s,i)=>{const r=e.length,o=new Array(r);let a=0;for(let l=0;l<r;l++){const u=l;t(e[u]).next(d=>{o[u]=d,++a,a===r&&s(o)},d=>i(d))}})}static doWhile(e,t){return new W((s,i)=>{const r=()=>{e()===!0?t().next(()=>{r()},i):s()};r()})}}function W4(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function xg(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this.ie(s),this.se=s=>t.writeSequenceNumber(s))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Wb.oe=-1;function lv(n){return n==null}function o_(n){return n===0&&1/n==-1/0}function G4(n){return typeof n=="number"&&Number.isInteger(n)&&!o_(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kx(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wc(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function nP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,t){this.comparator=e,this.root=t||ln.EMPTY}insert(e,t){return new vt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ln.BLACK,null,null))}remove(e){return new vt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(e,s.key);if(i===0)return t+s.left.size;i<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,s)=>(e(t,s),!1))}toString(){const e=[];return this.inorderTraversal((t,s)=>(e.push(`${t}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Am(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Am(this.root,e,this.comparator,!1)}getReverseIterator(){return new Am(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Am(this.root,e,this.comparator,!0)}}class Am{constructor(e,t,s,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?s(e.key,t):1,t&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ln{constructor(e,t,s,i,r){this.key=e,this.value=t,this.color=s??ln.RED,this.left=i??ln.EMPTY,this.right=r??ln.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,i,r){return new ln(e??this.key,t??this.value,s??this.color,i??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let i=this;const r=s(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,t,s),null):r===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ln.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return ln.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw pe();const e=this.left.check();if(e!==this.right.check())throw pe();return e+(this.isRed()?0:1)}}ln.EMPTY=null,ln.RED=!0,ln.BLACK=!1;ln.EMPTY=new class{constructor(){this.size=0}get key(){throw pe()}get value(){throw pe()}get color(){throw pe()}get left(){throw pe()}get right(){throw pe()}copy(e,t,s,i,r){return this}insert(e,t,s){return new ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.comparator=e,this.data=new vt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,s)=>(e(t),!1))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Rx(this.data.getIterator())}getIteratorFrom(e){return new Rx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(s=>{t=t.add(s)}),t}isEqual(e){if(!(e instanceof dn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,r=s.getNext().key;if(this.comparator(i,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new dn(this.comparator);return t.data=e,t}}class Rx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this.fields=e,e.sort(un.comparator)}static empty(){return new Ts([])}unionWith(e){let t=new dn(un.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Ts(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Nh(this.fields,e.fields,(t,s)=>t.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new sP("Invalid base64 string: "+r):r}}(e);return new pn(t)}static fromUint8Array(e){const t=function(i){let r="";for(let o=0;o<i.length;++o)r+=String.fromCharCode(i[o]);return r}(e);return new pn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pn.EMPTY_BYTE_STRING=new pn("");const q4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ea(n){if(We(!!n),typeof n=="string"){let e=0;const t=q4.exec(n);if(We(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:It(n.seconds),nanos:It(n.nanos)}}function It(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function cc(n){return typeof n=="string"?pn.fromBase64String(n):pn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function qb(n){const e=n.mapValue.fields.__previous_value__;return Gb(e)?qb(e):e}function Bf(n){const e=Ea(n.mapValue.fields.__local_write_time__.timestampValue);return new $t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e,t,s,i,r,o,a,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class zf{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new zf("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof zf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bm={mapValue:{}};function uc(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Gb(n)?4:Y4(n)?9007199254740991:X4(n)?10:11:pe()}function ir(n,e){if(n===e)return!0;const t=uc(n);if(t!==uc(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Bf(n).isEqual(Bf(e));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const o=Ea(i.timestampValue),a=Ea(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,r){return cc(i.bytesValue).isEqual(cc(r.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,r){return It(i.geoPointValue.latitude)===It(r.geoPointValue.latitude)&&It(i.geoPointValue.longitude)===It(r.geoPointValue.longitude)}(n,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return It(i.integerValue)===It(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const o=It(i.doubleValue),a=It(r.doubleValue);return o===a?o_(o)===o_(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Nh(n.arrayValue.values||[],e.arrayValue.values||[],ir);case 10:case 11:return function(i,r){const o=i.mapValue.fields||{},a=r.mapValue.fields||{};if(kx(o)!==kx(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ir(o[l],a[l])))return!1;return!0}(n,e);default:return pe()}}function $f(n,e){return(n.values||[]).find(t=>ir(t,e))!==void 0}function Dh(n,e){if(n===e)return 0;const t=uc(n),s=uc(e);if(t!==s)return Ve(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ve(n.booleanValue,e.booleanValue);case 2:return function(r,o){const a=It(r.integerValue||r.doubleValue),l=It(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return Px(n.timestampValue,e.timestampValue);case 4:return Px(Bf(n),Bf(e));case 5:return Ve(n.stringValue,e.stringValue);case 6:return function(r,o){const a=cc(r),l=cc(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(r,o){const a=r.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=Ve(a[u],l[u]);if(d!==0)return d}return Ve(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(r,o){const a=Ve(It(r.latitude),It(o.latitude));return a!==0?a:Ve(It(r.longitude),It(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Nx(n.arrayValue,e.arrayValue);case 10:return function(r,o){var a,l,u,d;const f=r.fields||{},p=o.fields||{},m=(a=f.value)===null||a===void 0?void 0:a.arrayValue,y=(l=p.value)===null||l===void 0?void 0:l.arrayValue,E=Ve(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0);return E!==0?E:Nx(m,y)}(n.mapValue,e.mapValue);case 11:return function(r,o){if(r===bm.mapValue&&o===bm.mapValue)return 0;if(r===bm.mapValue)return 1;if(o===bm.mapValue)return-1;const a=r.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let f=0;f<l.length&&f<d.length;++f){const p=Ve(l[f],d[f]);if(p!==0)return p;const m=Dh(a[l[f]],u[d[f]]);if(m!==0)return m}return Ve(l.length,d.length)}(n.mapValue,e.mapValue);default:throw pe()}}function Px(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ve(n,e);const t=Ea(n),s=Ea(e),i=Ve(t.seconds,s.seconds);return i!==0?i:Ve(t.nanos,s.nanos)}function Nx(n,e){const t=n.values||[],s=e.values||[];for(let i=0;i<t.length&&i<s.length;++i){const r=Dh(t[i],s[i]);if(r)return r}return Ve(t.length,s.length)}function Lh(n){return aE(n)}function aE(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const s=Ea(t);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return cc(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return he.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let s="[",i=!0;for(const r of t.values||[])i?i=!1:s+=",",s+=aE(r);return s+"]"}(n.arrayValue):"mapValue"in n?function(t){const s=Object.keys(t.fields||{}).sort();let i="{",r=!0;for(const o of s)r?r=!1:i+=",",i+=`${o}:${aE(t.fields[o])}`;return i+"}"}(n.mapValue):pe()}function lE(n){return!!n&&"integerValue"in n}function Kb(n){return!!n&&"arrayValue"in n}function Dx(n){return!!n&&"nullValue"in n}function Lx(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Xm(n){return!!n&&"mapValue"in n}function X4(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function hf(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return wc(n.mapValue.fields,(t,s)=>e.mapValue.fields[t]=hf(s)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hf(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Y4(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.value=e}static empty(){return new is({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Xm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hf(t)}setAll(e){let t=un.emptyPath(),s={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,s,i),s={},i=[],t=a.popLast()}o?s[a.lastSegment()]=hf(o):i.push(a.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,s,i)}delete(e){const t=this.field(e.popLast());Xm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ir(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let i=t.mapValue.fields[e.get(s)];Xm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,s){wc(t,(i,r)=>e[i]=r);for(const i of s)delete e[i]}clone(){return new is(hf(this.value))}}function iP(n){const e=[];return wc(n.fields,(t,s)=>{const i=new un([t]);if(Xm(s)){const r=iP(s.mapValue).fields;if(r.length===0)e.push(i);else for(const o of r)e.push(i.child(o))}else e.push(i)}),new Ts(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e,t,s,i,r,o,a){this.key=e,this.documentType=t,this.version=s,this.readTime=i,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Rn(e,0,me.min(),me.min(),me.min(),is.empty(),0)}static newFoundDocument(e,t,s,i){return new Rn(e,1,t,me.min(),s,i,0)}static newNoDocument(e,t){return new Rn(e,2,t,me.min(),me.min(),is.empty(),0)}static newUnknownDocument(e,t){return new Rn(e,3,t,me.min(),me.min(),is.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=is.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=is.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e,t){this.position=e,this.inclusive=t}}function Mx(n,e,t){let s=0;for(let i=0;i<n.position.length;i++){const r=e[i],o=n.position[i];if(r.field.isKeyField()?s=he.comparator(he.fromName(o.referenceValue),t.key):s=Dh(o,t.data.field(r.field)),r.dir==="desc"&&(s*=-1),s!==0)break}return s}function Ox(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ir(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e,t="asc"){this.field=e,this.dir=t}}function Q4(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{}class Ut extends rP{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new Z4(e,t,s):t==="array-contains"?new nU(e,s):t==="in"?new sU(e,s):t==="not-in"?new iU(e,s):t==="array-contains-any"?new rU(e,s):new Ut(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new eU(e,s):new tU(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Dh(t,this.value)):t!==null&&uc(this.value)===uc(t)&&this.matchesComparison(Dh(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return pe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rr extends rP{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new rr(e,t)}matches(e){return oP(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function oP(n){return n.op==="and"}function aP(n){return J4(n)&&oP(n)}function J4(n){for(const e of n.filters)if(e instanceof rr)return!1;return!0}function cE(n){if(n instanceof Ut)return n.field.canonicalString()+n.op.toString()+Lh(n.value);if(aP(n))return n.filters.map(e=>cE(e)).join(",");{const e=n.filters.map(t=>cE(t)).join(",");return`${n.op}(${e})`}}function lP(n,e){return n instanceof Ut?function(s,i){return i instanceof Ut&&s.op===i.op&&s.field.isEqual(i.field)&&ir(s.value,i.value)}(n,e):n instanceof rr?function(s,i){return i instanceof rr&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce((r,o,a)=>r&&lP(o,i.filters[a]),!0):!1}(n,e):void pe()}function cP(n){return n instanceof Ut?function(t){return`${t.field.canonicalString()} ${t.op} ${Lh(t.value)}`}(n):n instanceof rr?function(t){return t.op.toString()+" {"+t.getFilters().map(cP).join(" ,")+"}"}(n):"Filter"}class Z4 extends Ut{constructor(e,t,s){super(e,t,s),this.key=he.fromName(s.referenceValue)}matches(e){const t=he.comparator(e.key,this.key);return this.matchesComparison(t)}}class eU extends Ut{constructor(e,t){super(e,"in",t),this.keys=uP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class tU extends Ut{constructor(e,t){super(e,"not-in",t),this.keys=uP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function uP(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(s=>he.fromName(s.referenceValue))}class nU extends Ut{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Kb(t)&&$f(t.arrayValue,this.value)}}class sU extends Ut{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&$f(this.value.arrayValue,t)}}class iU extends Ut{constructor(e,t){super(e,"not-in",t)}matches(e){if($f(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!$f(this.value.arrayValue,t)}}class rU extends Ut{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Kb(t)||!t.arrayValue.values)&&t.arrayValue.values.some(s=>$f(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oU{constructor(e,t=null,s=[],i=[],r=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=i,this.limit=r,this.startAt=o,this.endAt=a,this.ue=null}}function Fx(n,e=null,t=[],s=[],i=null,r=null,o=null){return new oU(n,e,t,s,i,r,o)}function Xb(n){const e=ye(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(s=>cE(s)).join(","),t+="|ob:",t+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),lv(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(s=>Lh(s)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(s=>Lh(s)).join(",")),e.ue=t}return e.ue}function Yb(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Q4(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!lP(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ox(n.startAt,e.startAt)&&Ox(n.endAt,e.endAt)}function uE(n){return he.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e,t=null,s=[],i=[],r=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=i,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function aU(n,e,t,s,i,r,o,a){return new cv(n,e,t,s,i,r,o,a)}function uv(n){return new cv(n)}function Vx(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lU(n){return n.collectionGroup!==null}function df(n){const e=ye(n);if(e.ce===null){e.ce=[];const t=new Set;for(const r of e.explicitOrderBy)e.ce.push(r),t.add(r.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new dn(un.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(r=>{t.has(r.canonicalString())||r.isKeyField()||e.ce.push(new l_(r,s))}),t.has(un.keyField().canonicalString())||e.ce.push(new l_(un.keyField(),s))}return e.ce}function nr(n){const e=ye(n);return e.le||(e.le=cU(e,df(n))),e.le}function cU(n,e){if(n.limitType==="F")return Fx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const r=i.dir==="desc"?"asc":"desc";return new l_(i.field,r)});const t=n.endAt?new a_(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new a_(n.startAt.position,n.startAt.inclusive):null;return Fx(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function hE(n,e,t){return new cv(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function hv(n,e){return Yb(nr(n),nr(e))&&n.limitType===e.limitType}function hP(n){return`${Xb(nr(n))}|lt:${n.limitType}`}function Lc(n){return`Query(target=${function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map(i=>cP(i)).join(", ")}]`),lv(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map(i=>Lh(i)).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map(i=>Lh(i)).join(",")),`Target(${s})`}(nr(n))}; limitType=${n.limitType})`}function dv(n,e){return e.isFoundDocument()&&function(s,i){const r=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(r):he.isDocumentKey(s.path)?s.path.isEqual(r):s.path.isImmediateParentOf(r)}(n,e)&&function(s,i){for(const r of df(s))if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0}(n,e)&&function(s,i){for(const r of s.filters)if(!r.matches(i))return!1;return!0}(n,e)&&function(s,i){return!(s.startAt&&!function(o,a,l){const u=Mx(o,a,l);return o.inclusive?u<=0:u<0}(s.startAt,df(s),i)||s.endAt&&!function(o,a,l){const u=Mx(o,a,l);return o.inclusive?u>=0:u>0}(s.endAt,df(s),i))}(n,e)}function uU(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function dP(n){return(e,t)=>{let s=!1;for(const i of df(n)){const r=hU(i,e,t);if(r!==0)return r;s=s||i.field.isKeyField()}return 0}}function hU(n,e,t){const s=n.field.isKeyField()?he.comparator(e.key,t.key):function(r,o,a){const l=o.data.field(r),u=a.data.field(r);return l!==null&&u!==null?Dh(l,u):pe()}(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return pe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[i,r]of s)if(this.equalsFn(i,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),i=this.inner[s];if(i===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return s.length===1?delete this.inner[t]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wc(this.inner,(t,s)=>{for(const[i,r]of s)e(i,r)})}isEmpty(){return nP(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dU=new vt(he.comparator);function lo(){return dU}const fP=new vt(he.comparator);function Md(...n){let e=fP;for(const t of n)e=e.insert(t.key,t);return e}function pP(n){let e=fP;return n.forEach((t,s)=>e=e.insert(t,s.overlayedDocument)),e}function Qa(){return ff()}function gP(){return ff()}function ff(){return new Hh(n=>n.toString(),(n,e)=>n.isEqual(e))}const fU=new vt(he.comparator),pU=new dn(he.comparator);function Ce(...n){let e=pU;for(const t of n)e=e.add(t);return e}const gU=new dn(Ve);function mU(){return gU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qb(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:o_(e)?"-0":e}}function mP(n){return{integerValue:""+n}}function yP(n,e){return G4(e)?mP(e):Qb(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(){this._=void 0}}function yU(n,e,t){return n instanceof c_?function(i,r){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&Gb(r)&&(r=qb(r)),r&&(o.fields.__previous_value__=r),{mapValue:o}}(t,e):n instanceof Hf?vP(n,e):n instanceof Wf?wP(n,e):function(i,r){const o=_P(i,r),a=jx(o)+jx(i.Pe);return lE(o)&&lE(i.Pe)?mP(a):Qb(i.serializer,a)}(n,e)}function _U(n,e,t){return n instanceof Hf?vP(n,e):n instanceof Wf?wP(n,e):t}function _P(n,e){return n instanceof Gf?function(s){return lE(s)||function(r){return!!r&&"doubleValue"in r}(s)}(e)?e:{integerValue:0}:null}class c_ extends fv{}class Hf extends fv{constructor(e){super(),this.elements=e}}function vP(n,e){const t=EP(e);for(const s of n.elements)t.some(i=>ir(i,s))||t.push(s);return{arrayValue:{values:t}}}class Wf extends fv{constructor(e){super(),this.elements=e}}function wP(n,e){let t=EP(e);for(const s of n.elements)t=t.filter(i=>!ir(i,s));return{arrayValue:{values:t}}}class Gf extends fv{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function jx(n){return It(n.integerValue||n.doubleValue)}function EP(n){return Kb(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(e,t){this.field=e,this.transform=t}}function wU(n,e){return n.field.isEqual(e.field)&&function(s,i){return s instanceof Hf&&i instanceof Hf||s instanceof Wf&&i instanceof Wf?Nh(s.elements,i.elements,ir):s instanceof Gf&&i instanceof Gf?ir(s.Pe,i.Pe):s instanceof c_&&i instanceof c_}(n.transform,e.transform)}class EU{constructor(e,t){this.version=e,this.transformResults=t}}class Ai{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ai}static exists(e){return new Ai(void 0,e)}static updateTime(e){return new Ai(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ym(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class pv{}function AP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Jb(n.key,Ai.none()):new Ig(n.key,n.data,Ai.none());{const t=n.data,s=is.empty();let i=new dn(un.comparator);for(let r of e.fields)if(!i.has(r)){let o=t.field(r);o===null&&r.length>1&&(r=r.popLast(),o=t.field(r)),o===null?s.delete(r):s.set(r,o),i=i.add(r)}return new Pa(n.key,s,new Ts(i.toArray()),Ai.none())}}function AU(n,e,t){n instanceof Ig?function(i,r,o){const a=i.value.clone(),l=Bx(i.fieldTransforms,r,o.transformResults);a.setAll(l),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Pa?function(i,r,o){if(!Ym(i.precondition,r))return void r.convertToUnknownDocument(o.version);const a=Bx(i.fieldTransforms,r,o.transformResults),l=r.data;l.setAll(bP(i)),l.setAll(a),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(i,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function pf(n,e,t,s){return n instanceof Ig?function(r,o,a,l){if(!Ym(r.precondition,o))return a;const u=r.value.clone(),d=zx(r.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,s):n instanceof Pa?function(r,o,a,l){if(!Ym(r.precondition,o))return a;const u=zx(r.fieldTransforms,l,o),d=o.data;return d.setAll(bP(r)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(f=>f.field))}(n,e,t,s):function(r,o,a){return Ym(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function bU(n,e){let t=null;for(const s of n.fieldTransforms){const i=e.data.field(s.field),r=_P(s.transform,i||null);r!=null&&(t===null&&(t=is.empty()),t.set(s.field,r))}return t||null}function Ux(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&Nh(s,i,(r,o)=>wU(r,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ig extends pv{constructor(e,t,s,i=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Pa extends pv{constructor(e,t,s,i,r=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function bP(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}}),e}function Bx(n,e,t){const s=new Map;We(n.length===t.length);for(let i=0;i<t.length;i++){const r=n[i],o=r.transform,a=e.data.field(r.field);s.set(r.field,_U(o,a,t[i]))}return s}function zx(n,e,t){const s=new Map;for(const i of n){const r=i.transform,o=t.data.field(i.field);s.set(i.field,yU(r,o,e))}return s}class Jb extends pv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class TU extends pv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{constructor(e,t,s,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const r=this.mutations[i];r.key.isEqual(e.key)&&AU(r,e,s[i])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=pf(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=pf(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=gP();return this.mutations.forEach(i=>{const r=e.get(i.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=t.has(i.key)?null:a;const l=AP(o,a);l!==null&&s.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(me.min())}),s}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ce())}isEqual(e){return this.batchId===e.batchId&&Nh(this.mutations,e.mutations,(t,s)=>Ux(t,s))&&Nh(this.baseMutations,e.baseMutations,(t,s)=>Ux(t,s))}}class Zb{constructor(e,t,s,i){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=i}static from(e,t,s){We(e.mutations.length===s.length);let i=function(){return fU}();const r=e.mutations;for(let o=0;o<r.length;o++)i=i.insert(r[o].key,s[o].version);return new Zb(e,t,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IU{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pt,De;function CU(n){switch(n){default:return pe();case H.CANCELLED:case H.UNKNOWN:case H.DEADLINE_EXCEEDED:case H.RESOURCE_EXHAUSTED:case H.INTERNAL:case H.UNAVAILABLE:case H.UNAUTHENTICATED:return!1;case H.INVALID_ARGUMENT:case H.NOT_FOUND:case H.ALREADY_EXISTS:case H.PERMISSION_DENIED:case H.FAILED_PRECONDITION:case H.ABORTED:case H.OUT_OF_RANGE:case H.UNIMPLEMENTED:case H.DATA_LOSS:return!0}}function TP(n){if(n===void 0)return ao("GRPC error has no .code"),H.UNKNOWN;switch(n){case Pt.OK:return H.OK;case Pt.CANCELLED:return H.CANCELLED;case Pt.UNKNOWN:return H.UNKNOWN;case Pt.DEADLINE_EXCEEDED:return H.DEADLINE_EXCEEDED;case Pt.RESOURCE_EXHAUSTED:return H.RESOURCE_EXHAUSTED;case Pt.INTERNAL:return H.INTERNAL;case Pt.UNAVAILABLE:return H.UNAVAILABLE;case Pt.UNAUTHENTICATED:return H.UNAUTHENTICATED;case Pt.INVALID_ARGUMENT:return H.INVALID_ARGUMENT;case Pt.NOT_FOUND:return H.NOT_FOUND;case Pt.ALREADY_EXISTS:return H.ALREADY_EXISTS;case Pt.PERMISSION_DENIED:return H.PERMISSION_DENIED;case Pt.FAILED_PRECONDITION:return H.FAILED_PRECONDITION;case Pt.ABORTED:return H.ABORTED;case Pt.OUT_OF_RANGE:return H.OUT_OF_RANGE;case Pt.UNIMPLEMENTED:return H.UNIMPLEMENTED;case Pt.DATA_LOSS:return H.DATA_LOSS;default:return pe()}}(De=Pt||(Pt={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RU=new Jl([4294967295,4294967295],0);function $x(n){const e=kU().encode(n),t=new KR;return t.update(e),new Uint8Array(t.digest())}function Hx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),i=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new Jl([t,s],0),new Jl([i,r],0)]}class eT{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Od(`Invalid padding: ${t}`);if(s<0)throw new Od(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Od(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Od(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Jl.fromNumber(this.Ie)}Ee(e,t,s){let i=e.add(t.multiply(Jl.fromNumber(s)));return i.compare(RU)===1&&(i=new Jl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=$x(e),[s,i]=Hx(t);for(let r=0;r<this.hashCount;r++){const o=this.Ee(s,i,r);if(!this.de(o))return!1}return!0}static create(e,t,s){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new eT(r,i,t);return s.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=$x(e),[s,i]=Hx(t);for(let r=0;r<this.hashCount;r++){const o=this.Ee(s,i,r);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Od extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,t,s,i,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const i=new Map;return i.set(e,Cg.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new gv(me.min(),i,new vt(Ve),lo(),Ce())}}class Cg{constructor(e,t,s,i,r){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Cg(s,t,Ce(),Ce(),Ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,t,s,i){this.Re=e,this.removedTargetIds=t,this.key=s,this.Ve=i}}class SP{constructor(e,t){this.targetId=e,this.me=t}}class xP{constructor(e,t,s=pn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=i}}class Wx{constructor(){this.fe=0,this.ge=qx(),this.pe=pn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ce(),t=Ce(),s=Ce();return this.ge.forEach((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:s=s.add(i);break;default:pe()}}),new Cg(this.pe,this.ye,e,t,s)}Ce(){this.we=!1,this.ge=qx()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,We(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class PU{constructor(e){this.Le=e,this.Be=new Map,this.ke=lo(),this.qe=Gx(),this.Qe=new vt(Ve)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const s=this.Ge(t);switch(e.state){case 0:this.ze(t)&&s.De(e.resumeToken);break;case 1:s.Oe(),s.Se||s.Ce(),s.De(e.resumeToken);break;case 2:s.Oe(),s.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(s.Ne(),s.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),s.De(e.resumeToken));break;default:pe()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((s,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,s=e.me.count,i=this.Je(t);if(i){const r=i.target;if(uE(r))if(s===0){const o=new he(r.path);this.Ue(t,o,Rn.newNoDocument(o,me.min()))}else We(s===1);else{const o=this.Ye(t);if(o!==s){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:r=0}=t;let o,a;try{o=cc(s).toUint8Array()}catch(l){if(l instanceof sP)return Ph("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new eT(o,i,r)}catch(l){return Ph(l instanceof Od?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,s){return t.me.count===s-this.nt(e,t.targetId)?0:2}nt(e,t){const s=this.Le.getRemoteKeysForTarget(t);let i=0;return s.forEach(r=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,r,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((r,o)=>{const a=this.Je(o);if(a){if(r.current&&uE(a.target)){const l=new he(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Rn.newNoDocument(l,e))}r.be&&(t.set(o,r.ve()),r.Ce())}});let s=Ce();this.qe.forEach((r,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(s=s.add(r))}),this.ke.forEach((r,o)=>o.setReadTime(e));const i=new gv(e,t,this.Qe,this.ke,s);return this.ke=lo(),this.qe=Gx(),this.Qe=new vt(Ve),i}$e(e,t){if(!this.ze(e))return;const s=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,s),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,s){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),s&&(this.ke=this.ke.insert(t,s))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Wx,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new dn(Ve),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||ie("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Wx),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Gx(){return new vt(he.comparator)}function qx(){return new vt(he.comparator)}const NU={asc:"ASCENDING",desc:"DESCENDING"},DU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LU={and:"AND",or:"OR"};class MU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function dE(n,e){return n.useProto3Json||lv(e)?e:{value:e}}function u_(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function IP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function OU(n,e){return u_(n,e.toTimestamp())}function sr(n){return We(!!n),me.fromTimestamp(function(t){const s=Ea(t);return new $t(s.seconds,s.nanos)}(n))}function tT(n,e){return fE(n,e).canonicalString()}function fE(n,e){const t=function(i){return new ht(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function CP(n){const e=ht.fromString(n);return We(DP(e)),e}function pE(n,e){return tT(n.databaseId,e.path)}function Vw(n,e){const t=CP(e);if(t.get(1)!==n.databaseId.projectId)throw new ce(H.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ce(H.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new he(RP(t))}function kP(n,e){return tT(n.databaseId,e)}function FU(n){const e=CP(n);return e.length===4?ht.emptyPath():RP(e)}function gE(n){return new ht(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function RP(n){return We(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Kx(n,e,t){return{name:pE(n,e),fields:t.value.mapValue.fields}}function VU(n,e){let t;if("targetChange"in e){e.targetChange;const s=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:pe()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],r=function(u,d){return u.useProto3Json?(We(d===void 0||typeof d=="string"),pn.fromBase64String(d||"")):(We(d===void 0||d instanceof Buffer||d instanceof Uint8Array),pn.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?H.UNKNOWN:TP(u.code);return new ce(d,u.message||"")}(o);t=new xP(s,i,r,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=Vw(n,s.document.name),r=sr(s.document.updateTime),o=s.document.createTime?sr(s.document.createTime):me.min(),a=new is({mapValue:{fields:s.document.fields}}),l=Rn.newFoundDocument(i,r,o,a),u=s.targetIds||[],d=s.removedTargetIds||[];t=new Qm(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=Vw(n,s.document),r=s.readTime?sr(s.readTime):me.min(),o=Rn.newNoDocument(i,r),a=s.removedTargetIds||[];t=new Qm([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=Vw(n,s.document),r=s.removedTargetIds||[];t=new Qm([],r,i,null)}else{if(!("filter"in e))return pe();{e.filter;const s=e.filter;s.targetId;const{count:i=0,unchangedNames:r}=s,o=new IU(i,r),a=s.targetId;t=new SP(a,o)}}return t}function jU(n,e){let t;if(e instanceof Ig)t={update:Kx(n,e.key,e.value)};else if(e instanceof Jb)t={delete:pE(n,e.key)};else if(e instanceof Pa)t={update:Kx(n,e.key,e.data),updateMask:KU(e.fieldMask)};else{if(!(e instanceof TU))return pe();t={verify:pE(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(s=>function(r,o){const a=o.transform;if(a instanceof c_)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Hf)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Wf)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Gf)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw pe()}(0,s))),e.precondition.isNone||(t.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:OU(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:pe()}(n,e.precondition)),t}function UU(n,e){return n&&n.length>0?(We(e!==void 0),n.map(t=>function(i,r){let o=i.updateTime?sr(i.updateTime):sr(r);return o.isEqual(me.min())&&(o=sr(r)),new EU(o,i.transformResults||[])}(t,e))):[]}function BU(n,e){return{documents:[kP(n,e.path)]}}function zU(n,e){const t={structuredQuery:{}},s=e.path;let i;e.collectionGroup!==null?(i=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=kP(n,i);const r=function(u){if(u.length!==0)return NP(rr.create(u,"and"))}(e.filters);r&&(t.structuredQuery.where=r);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:Mc(p.field),direction:WU(p.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=dE(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:i}}function $U(n){let e=FU(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let i=null;if(s>0){We(s===1);const d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let r=[];t.where&&(r=function(f){const p=PP(f);return p instanceof rr&&aP(p)?p.getFilters():[p]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(p=>function(y){return new l_(Oc(y.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(t.orderBy));let a=null;t.limit&&(a=function(f){let p;return p=typeof f=="object"?f.value:f,lv(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(f){const p=!!f.before,m=f.values||[];return new a_(m,p)}(t.startAt));let u=null;return t.endAt&&(u=function(f){const p=!f.before,m=f.values||[];return new a_(m,p)}(t.endAt)),aU(e,i,o,r,a,"F",l,u)}function HU(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return pe()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function PP(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Oc(t.unaryFilter.field);return Ut.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=Oc(t.unaryFilter.field);return Ut.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Oc(t.unaryFilter.field);return Ut.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Oc(t.unaryFilter.field);return Ut.create(o,"!=",{nullValue:"NULL_VALUE"});default:return pe()}}(n):n.fieldFilter!==void 0?function(t){return Ut.create(Oc(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return pe()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return rr.create(t.compositeFilter.filters.map(s=>PP(s)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return pe()}}(t.compositeFilter.op))}(n):pe()}function WU(n){return NU[n]}function GU(n){return DU[n]}function qU(n){return LU[n]}function Mc(n){return{fieldPath:n.canonicalString()}}function Oc(n){return un.fromServerFormat(n.fieldPath)}function NP(n){return n instanceof Ut?function(t){if(t.op==="=="){if(Lx(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NAN"}};if(Dx(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Lx(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NOT_NAN"}};if(Dx(t.value))return{unaryFilter:{field:Mc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mc(t.field),op:GU(t.op),value:t.value}}}(n):n instanceof rr?function(t){const s=t.getFilters().map(i=>NP(i));return s.length===1?s[0]:{compositeFilter:{op:qU(t.op),filters:s}}}(n):pe()}function KU(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function DP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e,t,s,i,r=me.min(),o=me.min(),a=pn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new sa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new sa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new sa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new sa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(e){this.ct=e}}function YU(n){const e=$U({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?hE(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QU{constructor(){this.un=new JU}addToCollectionParentIndex(e,t){return this.un.add(t),W.resolve()}getCollectionParents(e,t){return W.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return W.resolve()}deleteFieldIndex(e,t){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,t){return W.resolve()}getDocumentsMatchingTarget(e,t){return W.resolve(null)}getIndexType(e,t){return W.resolve(0)}getFieldIndexes(e,t){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,t){return W.resolve(wa.min())}getMinOffsetFromCollectionGroup(e,t){return W.resolve(wa.min())}updateCollectionGroup(e,t,s){return W.resolve()}updateIndexEntries(e,t){return W.resolve()}}class JU{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t]||new dn(ht.comparator),r=!i.has(s);return this.index[t]=i.add(s),r}has(e){const t=e.lastSegment(),s=e.popLast(),i=this.index[t];return i&&i.has(s)}getEntries(e){return(this.index[e]||new dn(ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Mh(0)}static kn(){return new Mh(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(){this.changes=new Hh(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Rn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?W.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eB{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tB{constructor(e,t,s,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=i}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(s=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(s!==null&&pf(s.mutation,i,Ts.empty(),$t.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.getLocalViewOfDocuments(e,s,Ce()).next(()=>s))}getLocalViewOfDocuments(e,t,s=Ce()){const i=Qa();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,s).next(r=>{let o=Md();return r.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const s=Qa();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,Ce()))}populateOverlays(e,t,s){const i=[];return s.forEach(r=>{t.has(r)||i.push(r)}),this.documentOverlayCache.getOverlays(e,i).next(r=>{r.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,s,i){let r=lo();const o=ff(),a=function(){return ff()}();return t.forEach((l,u)=>{const d=s.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof Pa)?r=r.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),pf(d.mutation,u,d.mutation.getFieldMask(),$t.now())):o.set(u.key,Ts.empty())}),this.recalculateAndSaveOverlays(e,r).next(l=>(l.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var f;return a.set(u,new eB(d,(f=o.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const s=ff();let i=new vt((o,a)=>o-a),r=Ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let d=s.get(l)||Ts.empty();d=a.applyToLocalView(u,d),s.set(l,d);const f=(i.get(a.batchId)||Ce()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,f=gP();d.forEach(p=>{if(!r.has(p)){const m=AP(t.get(p),s.get(p));m!==null&&f.set(p,m),r=r.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return W.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,t,s,i){return function(o){return he.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lU(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,i):this.getDocumentsMatchingCollectionQuery(e,t,s,i)}getNextDocuments(e,t,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,i).next(r=>{const o=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,i-r.size):W.resolve(Qa());let a=-1,l=r;return o.next(u=>W.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),r.get(d)?W.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,u,r)).next(()=>this.computeViews(e,l,u,Ce())).next(d=>({batchId:a,changes:pP(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new he(t)).next(s=>{let i=Md();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,s,i){const r=t.collectionGroup;let o=Md();return this.indexManager.getCollectionParents(e,r).next(a=>W.forEach(a,l=>{const u=function(f,p){return new cv(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(r));return this.getDocumentsMatchingCollectionQuery(e,u,s,i).next(d=>{d.forEach((f,p)=>{o=o.insert(f,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,s,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,r,i))).next(o=>{r.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Rn.newInvalidDocument(d)))});let a=Md();return o.forEach((l,u)=>{const d=r.get(l);d!==void 0&&pf(d.mutation,u,Ts.empty(),$t.now()),dv(t,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nB{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return W.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:sr(i.createTime)}}(t)),W.resolve()}getNamedQuery(e,t){return W.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:YU(i.bundledQuery),readTime:sr(i.readTime)}}(t)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sB{constructor(){this.overlays=new vt(he.comparator),this.Ir=new Map}getOverlay(e,t){return W.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Qa();return W.forEach(t,i=>this.getOverlay(e,i).next(r=>{r!==null&&s.set(i,r)})).next(()=>s)}saveOverlays(e,t,s){return s.forEach((i,r)=>{this.ht(e,t,r)}),W.resolve()}removeOverlaysForBatchId(e,t,s){const i=this.Ir.get(s);return i!==void 0&&(i.forEach(r=>this.overlays=this.overlays.remove(r)),this.Ir.delete(s)),W.resolve()}getOverlaysForCollection(e,t,s){const i=Qa(),r=t.length+1,o=new he(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===r&&l.largestBatchId>s&&i.set(l.getKey(),l)}return W.resolve(i)}getOverlaysForCollectionGroup(e,t,s,i){let r=new vt((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>s){let d=r.get(u.largestBatchId);d===null&&(d=Qa(),r=r.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=Qa(),l=r.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return W.resolve(a)}ht(e,t,s){const i=this.overlays.get(s.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(s.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new xU(t,s));let r=this.Ir.get(t);r===void 0&&(r=Ce(),this.Ir.set(t,r)),this.Ir.set(t,r.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB{constructor(){this.sessionToken=pn.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(){this.Tr=new dn(Qt.Er),this.dr=new dn(Qt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const s=new Qt(e,t);this.Tr=this.Tr.add(s),this.dr=this.dr.add(s)}Rr(e,t){e.forEach(s=>this.addReference(s,t))}removeReference(e,t){this.Vr(new Qt(e,t))}mr(e,t){e.forEach(s=>this.removeReference(s,t))}gr(e){const t=new he(new ht([])),s=new Qt(t,e),i=new Qt(t,e+1),r=[];return this.dr.forEachInRange([s,i],o=>{this.Vr(o),r.push(o.key)}),r}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new he(new ht([])),s=new Qt(t,e),i=new Qt(t,e+1);let r=Ce();return this.dr.forEachInRange([s,i],o=>{r=r.add(o.key)}),r}containsKey(e){const t=new Qt(e,0),s=this.Tr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Qt{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return he.comparator(e.key,t.key)||Ve(e.wr,t.wr)}static Ar(e,t){return Ve(e.wr,t.wr)||he.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rB{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new dn(Qt.Er)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,i){const r=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new SU(r,t,s,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new Qt(a.key,r)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return W.resolve(o)}lookupMutationBatch(e,t){return W.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,i=this.vr(s),r=i<0?0:i;return W.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Qt(t,0),i=new Qt(t,Number.POSITIVE_INFINITY),r=[];return this.br.forEachInRange([s,i],o=>{const a=this.Dr(o.wr);r.push(a)}),W.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new dn(Ve);return t.forEach(i=>{const r=new Qt(i,0),o=new Qt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([r,o],a=>{s=s.add(a.wr)})}),W.resolve(this.Cr(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,i=s.length+1;let r=s;he.isDocumentKey(r)||(r=r.child(""));const o=new Qt(new he(r),0);let a=new dn(Ve);return this.br.forEachWhile(l=>{const u=l.key.path;return!!s.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.wr)),!0)},o),W.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(s=>{const i=this.Dr(s);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){We(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let s=this.br;return W.forEach(t.mutations,i=>{const r=new Qt(i.key,t.batchId);return s=s.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=s})}On(e){}containsKey(e,t){const s=new Qt(t,0),i=this.br.firstAfterOrEqual(s);return W.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oB{constructor(e){this.Mr=e,this.docs=function(){return new vt(he.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,i=this.docs.get(s),r=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return W.resolve(s?s.document.mutableCopy():Rn.newInvalidDocument(t))}getEntries(e,t){let s=lo();return t.forEach(i=>{const r=this.docs.get(i);s=s.insert(i,r?r.document.mutableCopy():Rn.newInvalidDocument(i))}),W.resolve(s)}getDocumentsMatchingQuery(e,t,s,i){let r=lo();const o=t.path,a=new he(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||z4(B4(d),s)<=0||(i.has(d.key)||dv(t,d))&&(r=r.insert(d.key,d.mutableCopy()))}return W.resolve(r)}getAllFromCollectionGroup(e,t,s,i){pe()}Or(e,t){return W.forEach(this.docs,s=>t(s))}newChangeBuffer(e){return new aB(this)}getSize(e){return W.resolve(this.size)}}class aB extends ZU{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((s,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(s)}),W.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lB{constructor(e){this.persistence=e,this.Nr=new Hh(t=>Xb(t),Yb),this.lastRemoteSnapshotVersion=me.min(),this.highestTargetId=0,this.Lr=0,this.Br=new nT,this.targetCount=0,this.kr=Mh.Bn()}forEachTarget(e,t){return this.Nr.forEach((s,i)=>t(i)),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.Lr&&(this.Lr=t),W.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Mh(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,W.resolve()}updateTargetData(e,t){return this.Kn(t),W.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,t,s){let i=0;const r=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&s.get(a.targetId)===null&&(this.Nr.delete(o),r.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),W.waitFor(r).next(()=>i)}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,t){const s=this.Nr.get(t)||null;return W.resolve(s)}addMatchingKeys(e,t,s){return this.Br.Rr(t,s),W.resolve()}removeMatchingKeys(e,t,s){this.Br.mr(t,s);const i=this.persistence.referenceDelegate,r=[];return i&&t.forEach(o=>{r.push(i.markPotentiallyOrphaned(e,o))}),W.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),W.resolve()}getMatchingKeysForTargetId(e,t){const s=this.Br.yr(t);return W.resolve(s)}containsKey(e,t){return W.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cB{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Wb(0),this.Kr=!1,this.Kr=!0,this.$r=new iB,this.referenceDelegate=e(this),this.Ur=new lB(this),this.indexManager=new QU,this.remoteDocumentCache=function(i){return new oB(i)}(s=>this.referenceDelegate.Wr(s)),this.serializer=new XU(t),this.Gr=new nB(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new sB,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.qr[e.toKey()];return s||(s=new rB(t,this.referenceDelegate),this.qr[e.toKey()]=s),s}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,s){ie("MemoryPersistence","Starting transaction:",e);const i=new uB(this.Qr.next());return this.referenceDelegate.zr(),s(i).next(r=>this.referenceDelegate.jr(i).next(()=>r)).toPromise().then(r=>(i.raiseOnCommittedEvent(),r))}Hr(e,t){return W.or(Object.values(this.qr).map(s=>()=>s.containsKey(e,t)))}}class uB extends H4{constructor(e){super(),this.currentSequenceNumber=e}}class sT{constructor(e){this.persistence=e,this.Jr=new nT,this.Yr=null}static Zr(e){return new sT(e)}get Xr(){if(this.Yr)return this.Yr;throw pe()}addReference(e,t,s){return this.Jr.addReference(s,t),this.Xr.delete(s.toString()),W.resolve()}removeReference(e,t,s){return this.Jr.removeReference(s,t),this.Xr.add(s.toString()),W.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),W.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(r=>this.Xr.add(r.toString()))}).next(()=>s.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.Xr,s=>{const i=he.fromPath(s);return this.ei(e,i).next(r=>{r||t.removeEntry(i,me.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(s=>{s?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return W.or([()=>W.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(e,t,s,i){this.targetId=e,this.fromCache=t,this.$i=s,this.Ui=i}static Wi(e,t){let s=Ce(),i=Ce();for(const r of t.docChanges)switch(r.type){case 0:s=s.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new iT(e,t.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hB{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dB{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return tF()?8:W4(Nn())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,s,i){const r={result:null};return this.Yi(e,t).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.Zi(e,t,i,s).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new hB;return this.Xi(e,t,o).next(a=>{if(r.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>r.result)}es(e,t,s,i){return s.documentReadCount<this.ji?(bd()<=Re.DEBUG&&ie("QueryEngine","SDK will not create cache indexes for query:",Lc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),W.resolve()):(bd()<=Re.DEBUG&&ie("QueryEngine","Query:",Lc(t),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.Hi*i?(bd()<=Re.DEBUG&&ie("QueryEngine","The SDK decides to create cache indexes for query:",Lc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,nr(t))):W.resolve())}Yi(e,t){if(Vx(t))return W.resolve(null);let s=nr(t);return this.indexManager.getIndexType(e,s).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=hE(t,null,"F"),s=nr(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next(r=>{const o=Ce(...r);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(l=>{const u=this.ts(t,a);return this.ns(t,u,o,l.readTime)?this.Yi(e,hE(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,s,i){return Vx(t)||i.isEqual(me.min())?W.resolve(null):this.Ji.getDocuments(e,s).next(r=>{const o=this.ts(t,r);return this.ns(t,o,s,i)?W.resolve(null):(bd()<=Re.DEBUG&&ie("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Lc(t)),this.rs(e,o,t,U4(i,-1)).next(a=>a))})}ts(e,t){let s=new dn(dP(e));return t.forEach((i,r)=>{dv(e,r)&&(s=s.add(r))}),s}ns(e,t,s,i){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const r=e.limitType==="F"?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Xi(e,t,s){return bd()<=Re.DEBUG&&ie("QueryEngine","Using full collection scan to execute query:",Lc(t)),this.Ji.getDocumentsMatchingQuery(e,t,wa.min(),s)}rs(e,t,s,i){return this.Ji.getDocumentsMatchingQuery(e,s,i).next(r=>(t.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fB{constructor(e,t,s,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new vt(Ve),this._s=new Hh(r=>Xb(r),Yb),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(s)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tB(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function pB(n,e,t,s){return new fB(n,e,t,s)}async function LP(n,e){const t=ye(n);return await t.persistence.runTransaction("Handle user change","readonly",s=>{let i;return t.mutationQueue.getAllMutationBatches(s).next(r=>(i=r,t.ls(e),t.mutationQueue.getAllMutationBatches(s))).next(r=>{const o=[],a=[];let l=Ce();for(const u of i){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of r){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(s,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})}function gB(n,e){const t=ye(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const i=e.batch.keys(),r=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const f=u.batch,p=f.keys();let m=W.resolve();return p.forEach(y=>{m=m.next(()=>d.getEntry(l,y)).next(E=>{const k=u.docVersions.get(y);We(k!==null),E.version.compareTo(k)<0&&(f.applyToRemoteDocument(E,u),E.isValidDocument()&&(E.setReadTime(u.commitVersion),d.addEntry(E)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,s,e,r).next(()=>r.apply(s)).next(()=>t.mutationQueue.performConsistencyCheck(s)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(s,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(a){let l=Ce();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(s,i))})}function MP(n){const e=ye(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function mB(n,e){const t=ye(n),s=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const a=[];e.targetChanges.forEach((d,f)=>{const p=i.get(f);if(!p)return;a.push(t.Ur.removeMatchingKeys(r,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(r,d.addedDocuments,f)));let m=p.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(f)!==null?m=m.withResumeToken(pn.EMPTY_BYTE_STRING,me.min()).withLastLimboFreeSnapshotVersion(me.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,s)),i=i.insert(f,m),function(E,k,v){return E.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(p,m,d)&&a.push(t.Ur.updateTargetData(r,m))});let l=lo(),u=Ce();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(r,d))}),a.push(yB(r,o,e.documentUpdates).next(d=>{l=d.Ps,u=d.Is})),!s.isEqual(me.min())){const d=t.Ur.getLastRemoteSnapshotVersion(r).next(f=>t.Ur.setTargetsMetadata(r,r.currentSequenceNumber,s));a.push(d)}return W.waitFor(a).next(()=>o.apply(r)).next(()=>t.localDocuments.getLocalViewOfDocuments(r,l,u)).next(()=>l)}).then(r=>(t.os=i,r))}function yB(n,e,t){let s=Ce(),i=Ce();return t.forEach(r=>s=s.add(r)),e.getEntries(n,s).next(r=>{let o=lo();return t.forEach((a,l)=>{const u=r.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(me.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ie("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function _B(n,e){const t=ye(n);return t.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function vB(n,e){const t=ye(n);return t.persistence.runTransaction("Allocate target","readwrite",s=>{let i;return t.Ur.getTargetData(s,e).next(r=>r?(i=r,W.resolve(i)):t.Ur.allocateTargetId(s).next(o=>(i=new sa(e,o,"TargetPurposeListen",s.currentSequenceNumber),t.Ur.addTargetData(s,i).next(()=>i))))}).then(s=>{const i=t.os.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(s.targetId,s),t._s.set(e,s.targetId)),s})}async function mE(n,e,t){const s=ye(n),i=s.os.get(e),r=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",r,o=>s.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!xg(o))throw o;ie("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.os=s.os.remove(e),s._s.delete(i.target)}function Xx(n,e,t){const s=ye(n);let i=me.min(),r=Ce();return s.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const f=ye(l),p=f._s.get(d);return p!==void 0?W.resolve(f.os.get(p)):f.Ur.getTargetData(u,d)}(s,o,nr(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,s.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{r=l})}).next(()=>s.ss.getDocumentsMatchingQuery(o,e,t?i:me.min(),t?r:Ce())).next(a=>(wB(s,uU(e),a),{documents:a,Ts:r})))}function wB(n,e,t){let s=n.us.get(e)||me.min();t.forEach((i,r)=>{r.readTime.compareTo(s)>0&&(s=r.readTime)}),n.us.set(e,s)}class Yx{constructor(){this.activeTargetIds=mU()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class EB{constructor(){this.so=new Yx,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,s){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Yx,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AB{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ie("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ie("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tm=null;function jw(){return Tm===null?Tm=function(){return 268435456+Math.round(2147483648*Math.random())}():Tm++,"0x"+Tm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TB{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vn="WebChannelConnection";class SB extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const s=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=s+"://"+t.host,this.vo=`projects/${i}/databases/${r}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${r}`}get Fo(){return!1}Mo(t,s,i,r,o){const a=jw(),l=this.xo(t,s.toUriEncodedString());ie("RestConnection",`Sending RPC '${t}' ${a}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,r,o),this.No(t,l,u,i).then(d=>(ie("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Ph("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(t,s,i,r,o,a){return this.Mo(t,s,i,r,o)}Oo(t,s,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+$h}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach((r,o)=>t[o]=r),i&&i.headers.forEach((r,o)=>t[o]=r)}xo(t,s){const i=bB[t];return`${this.Do}/v1/${s}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,s,i){const r=jw();return new Promise((o,a)=>{const l=new XR;l.setWithCredentials(!0),l.listenOnce(YR.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Km.NO_ERROR:const d=l.getResponseJson();ie(vn,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(d)),o(d);break;case Km.TIMEOUT:ie(vn,`RPC '${e}' ${r} timed out`),a(new ce(H.DEADLINE_EXCEEDED,"Request time out"));break;case Km.HTTP_ERROR:const f=l.getStatus();if(ie(vn,`RPC '${e}' ${r} failed with status:`,f,"response text:",l.getResponseText()),f>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p==null?void 0:p.error;if(m&&m.status&&m.message){const y=function(k){const v=k.toLowerCase().replace(/_/g,"-");return Object.values(H).indexOf(v)>=0?v:H.UNKNOWN}(m.status);a(new ce(y,m.message))}else a(new ce(H.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ce(H.UNAVAILABLE,"Connection failed."));break;default:pe()}}finally{ie(vn,`RPC '${e}' ${r} completed.`)}});const u=JSON.stringify(i);ie(vn,`RPC '${e}' ${r} sending request:`,i),l.send(t,"POST",u,s,15)})}Bo(e,t,s){const i=jw(),r=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=ZR(),a=JR(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,s),l.encodeInitMessageHeaders=!0;const d=r.join("");ie(vn,`Creating RPC '${e}' stream ${i}: ${d}`,l);const f=o.createWebChannel(d,l);let p=!1,m=!1;const y=new TB({Io:k=>{m?ie(vn,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(p||(ie(vn,`Opening RPC '${e}' stream ${i} transport.`),f.open(),p=!0),ie(vn,`RPC '${e}' stream ${i} sending:`,k),f.send(k))},To:()=>f.close()}),E=(k,v,A)=>{k.listen(v,C=>{try{A(C)}catch(N){setTimeout(()=>{throw N},0)}})};return E(f,Ld.EventType.OPEN,()=>{m||(ie(vn,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),E(f,Ld.EventType.CLOSE,()=>{m||(m=!0,ie(vn,`RPC '${e}' stream ${i} transport closed`),y.So())}),E(f,Ld.EventType.ERROR,k=>{m||(m=!0,Ph(vn,`RPC '${e}' stream ${i} transport errored:`,k),y.So(new ce(H.UNAVAILABLE,"The operation could not be completed")))}),E(f,Ld.EventType.MESSAGE,k=>{var v;if(!m){const A=k.data[0];We(!!A);const C=A,N=C.error||((v=C[0])===null||v===void 0?void 0:v.error);if(N){ie(vn,`RPC '${e}' stream ${i} received error:`,N);const F=N.status;let V=function(P){const D=Pt[P];if(D!==void 0)return TP(D)}(F),S=N.message;V===void 0&&(V=H.INTERNAL,S="Unknown error status: "+F+" with message "+N.message),m=!0,y.So(new ce(V,S)),f.close()}else ie(vn,`RPC '${e}' stream ${i} received:`,A),y.bo(A)}}),E(a,QR.STAT_EVENT,k=>{k.stat===oE.PROXY?ie(vn,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===oE.NOPROXY&&ie(vn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}function Uw(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mv(n){return new MU(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,t,s=1e3,i=1.5,r=6e4){this.ui=e,this.timerId=t,this.ko=s,this.qo=i,this.Qo=r,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),s=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-s);i>0&&ie("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e,t,s,i,r,o,a,l){this.ui=e,this.Ho=s,this.Jo=i,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new OP(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===H.RESOURCE_EXHAUSTED?(ao(t.toString()),ao("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===H.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,i])=>{this.Yo===t&&this.P_(s,i)},s=>{e(()=>{const i=new ce(H.UNKNOWN,"Fetching auth token failed: "+s.message);return this.I_(i)})})}P_(e,t){const s=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{s(()=>this.listener.Eo())}),this.stream.Ro(()=>{s(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{s(()=>this.I_(i))}),this.stream.onMessage(i=>{s(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ie("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(ie("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class xB extends FP{constructor(e,t,s,i,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,i,o),this.serializer=r}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=VU(this.serializer,e),s=function(r){if(!("targetChange"in r))return me.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?me.min():o.readTime?sr(o.readTime):me.min()}(e);return this.listener.d_(t,s)}A_(e){const t={};t.database=gE(this.serializer),t.addTarget=function(r,o){let a;const l=o.target;if(a=uE(l)?{documents:BU(r,l)}:{query:zU(r,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=IP(r,o.resumeToken);const u=dE(r,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(me.min())>0){a.readTime=u_(r,o.snapshotVersion.toTimestamp());const u=dE(r,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const s=HU(this.serializer,e);s&&(t.labels=s),this.a_(t)}R_(e){const t={};t.database=gE(this.serializer),t.removeTarget=e,this.a_(t)}}class IB extends FP{constructor(e,t,s,i,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,i,o),this.serializer=r}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return We(!!e.streamToken),this.lastStreamToken=e.streamToken,We(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){We(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=UU(e.writeResults,e.commitTime),s=sr(e.commitTime);return this.listener.g_(s,t)}p_(){const e={};e.database=gE(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(s=>jU(this.serializer,s))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CB extends class{}{constructor(e,t,s,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ce(H.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.Mo(e,fE(t,s),i,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new ce(H.UNKNOWN,r.toString())})}Lo(e,t,s,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,fE(t,s),i,o,a,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===H.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ce(H.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class kB{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ao(t),this.D_=!1):ie("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RB{constructor(e,t,s,i,r){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=r,this.k_._o(o=>{s.enqueueAndForget(async()=>{Ec(this)&&(ie("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=ye(l);u.L_.add(4),await kg(u),u.q_.set("Unknown"),u.L_.delete(4),await yv(u)}(this))})}),this.q_=new kB(s,i)}}async function yv(n){if(Ec(n))for(const e of n.B_)await e(!0)}async function kg(n){for(const e of n.B_)await e(!1)}function VP(n,e){const t=ye(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),lT(t)?aT(t):Wh(t).r_()&&oT(t,e))}function rT(n,e){const t=ye(n),s=Wh(t);t.N_.delete(e),s.r_()&&jP(t,e),t.N_.size===0&&(s.r_()?s.o_():Ec(t)&&t.q_.set("Unknown"))}function oT(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(me.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Wh(n).A_(e)}function jP(n,e){n.Q_.xe(e),Wh(n).R_(e)}function aT(n){n.Q_=new PU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Wh(n).start(),n.q_.v_()}function lT(n){return Ec(n)&&!Wh(n).n_()&&n.N_.size>0}function Ec(n){return ye(n).L_.size===0}function UP(n){n.Q_=void 0}async function PB(n){n.q_.set("Online")}async function NB(n){n.N_.forEach((e,t)=>{oT(n,e)})}async function DB(n,e){UP(n),lT(n)?(n.q_.M_(e),aT(n)):n.q_.set("Unknown")}async function LB(n,e,t){if(n.q_.set("Online"),e instanceof xP&&e.state===2&&e.cause)try{await async function(i,r){const o=r.cause;for(const a of r.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(n,e)}catch(s){ie("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await h_(n,s)}else if(e instanceof Qm?n.Q_.Ke(e):e instanceof SP?n.Q_.He(e):n.Q_.We(e),!t.isEqual(me.min()))try{const s=await MP(n.localStore);t.compareTo(s)>=0&&await function(r,o){const a=r.Q_.rt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=r.N_.get(u);d&&r.N_.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=r.N_.get(l);if(!d)return;r.N_.set(l,d.withResumeToken(pn.EMPTY_BYTE_STRING,d.snapshotVersion)),jP(r,l);const f=new sa(d.target,l,u,d.sequenceNumber);oT(r,f)}),r.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(s){ie("RemoteStore","Failed to raise snapshot:",s),await h_(n,s)}}async function h_(n,e,t){if(!xg(e))throw e;n.L_.add(1),await kg(n),n.q_.set("Offline"),t||(t=()=>MP(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ie("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await yv(n)})}function BP(n,e){return e().catch(t=>h_(n,t,e))}async function _v(n){const e=ye(n),t=Aa(e);let s=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;MB(e);)try{const i=await _B(e.localStore,s);if(i===null){e.O_.length===0&&t.o_();break}s=i.batchId,OB(e,i)}catch(i){await h_(e,i)}zP(e)&&$P(e)}function MB(n){return Ec(n)&&n.O_.length<10}function OB(n,e){n.O_.push(e);const t=Aa(n);t.r_()&&t.V_&&t.m_(e.mutations)}function zP(n){return Ec(n)&&!Aa(n).n_()&&n.O_.length>0}function $P(n){Aa(n).start()}async function FB(n){Aa(n).p_()}async function VB(n){const e=Aa(n);for(const t of n.O_)e.m_(t.mutations)}async function jB(n,e,t){const s=n.O_.shift(),i=Zb.from(s,e,t);await BP(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await _v(n)}async function UB(n,e){e&&Aa(n).V_&&await async function(s,i){if(function(o){return CU(o)&&o!==H.ABORTED}(i.code)){const r=s.O_.shift();Aa(s).s_(),await BP(s,()=>s.remoteSyncer.rejectFailedWrite(r.batchId,i)),await _v(s)}}(n,e),zP(n)&&$P(n)}async function Jx(n,e){const t=ye(n);t.asyncQueue.verifyOperationInProgress(),ie("RemoteStore","RemoteStore received new credentials");const s=Ec(t);t.L_.add(3),await kg(t),s&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await yv(t)}async function BB(n,e){const t=ye(n);e?(t.L_.delete(2),await yv(t)):e||(t.L_.add(2),await kg(t),t.q_.set("Unknown"))}function Wh(n){return n.K_||(n.K_=function(t,s,i){const r=ye(t);return r.w_(),new xB(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{Eo:PB.bind(null,n),Ro:NB.bind(null,n),mo:DB.bind(null,n),d_:LB.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),lT(n)?aT(n):n.q_.set("Unknown")):(await n.K_.stop(),UP(n))})),n.K_}function Aa(n){return n.U_||(n.U_=function(t,s,i){const r=ye(t);return r.w_(),new IB(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:FB.bind(null,n),mo:UB.bind(null,n),f_:VB.bind(null,n),g_:jB.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await _v(n)):(await n.U_.stop(),n.O_.length>0&&(ie("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e,t,s,i,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=i,this.removalCallback=r,this.deferred=new Jr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,i,r){const o=Date.now()+s,a=new cT(e,t,o,i,r);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ce(H.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uT(n,e){if(ao("AsyncQueue",`${e}: ${n}`),xg(n))return new ce(H.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e){this.comparator=e?(t,s)=>e(t,s)||he.comparator(t.key,s.key):(t,s)=>he.comparator(t.key,s.key),this.keyedMap=Md(),this.sortedSet=new vt(this.comparator)}static emptySet(e){return new mu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,s)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof mu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,r=s.getNext().key;if(!i.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new mu;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx{constructor(){this.W_=new vt(he.comparator)}track(e){const t=e.doc.key,s=this.W_.get(t);s?e.type!==0&&s.type===3?this.W_=this.W_.insert(t,e):e.type===3&&s.type!==1?this.W_=this.W_.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.W_=this.W_.remove(t):e.type===1&&s.type===2?this.W_=this.W_.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):pe():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,s)=>{e.push(s)}),e}}class Oh{constructor(e,t,s,i,r,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,s,i,r){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Oh(e,t,mu.emptySet(t),o,s,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==s[i].type||!t[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zB{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class $B{constructor(){this.queries=eI(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,s){const i=ye(t),r=i.queries;i.queries=eI(),r.forEach((o,a)=>{for(const l of a.j_)l.onError(s)})})(this,new ce(H.ABORTED,"Firestore shutting down"))}}function eI(){return new Hh(n=>hP(n),hv)}async function hT(n,e){const t=ye(n);let s=3;const i=e.query;let r=t.queries.get(i);r?!r.H_()&&e.J_()&&(s=2):(r=new zB,s=e.J_()?0:1);try{switch(s){case 0:r.z_=await t.onListen(i,!0);break;case 1:r.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=uT(o,`Initialization of query '${Lc(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,r),r.j_.push(e),e.Z_(t.onlineState),r.z_&&e.X_(r.z_)&&fT(t)}async function dT(n,e){const t=ye(n),s=e.query;let i=3;const r=t.queries.get(s);if(r){const o=r.j_.indexOf(e);o>=0&&(r.j_.splice(o,1),r.j_.length===0?i=e.J_()?0:1:!r.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function HB(n,e){const t=ye(n);let s=!1;for(const i of e){const r=i.query,o=t.queries.get(r);if(o){for(const a of o.j_)a.X_(i)&&(s=!0);o.z_=i}}s&&fT(t)}function WB(n,e,t){const s=ye(n),i=s.queries.get(e);if(i)for(const r of i.j_)r.onError(t);s.queries.delete(e)}function fT(n){n.Y_.forEach(e=>{e.next()})}var yE,tI;(tI=yE||(yE={})).ea="default",tI.Cache="cache";class pT{constructor(e,t,s){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=s||{}}X_(e){if(!this.options.includeMetadataChanges){const s=[];for(const i of e.docChanges)i.type!==3&&s.push(i);e=new Oh(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const s=t!=="Offline";return(!this.options._a||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Oh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==yE.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e){this.key=e}}class WP{constructor(e){this.key=e}}class GB{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ce(),this.mutatedKeys=Ce(),this.Aa=dP(e),this.Ra=new mu(this.Aa)}get Va(){return this.Ta}ma(e,t){const s=t?t.fa:new Zx,i=t?t.Ra:this.Ra;let r=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{const p=i.get(d),m=dv(this.query,f)?f:null,y=!!p&&this.mutatedKeys.has(p.key),E=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let k=!1;p&&m?p.data.isEqual(m.data)?y!==E&&(s.track({type:3,doc:m}),k=!0):this.ga(p,m)||(s.track({type:2,doc:m}),k=!0,(l&&this.Aa(m,l)>0||u&&this.Aa(m,u)<0)&&(a=!0)):!p&&m?(s.track({type:0,doc:m}),k=!0):p&&!m&&(s.track({type:1,doc:p}),k=!0,(l||u)&&(a=!0)),k&&(m?(o=o.add(m),r=E?r.add(d):r.delete(d)):(o=o.delete(d),r=r.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),r=r.delete(d.key),s.track({type:1,doc:d})}return{Ra:o,fa:s,ns:a,mutatedKeys:r}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,i){const r=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,f)=>function(m,y){const E=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pe()}};return E(m)-E(y)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(s),i=i!=null&&i;const a=t&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new Oh(this.query,e.Ra,r,o,e.mutatedKeys,l===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Zx,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ce(),this.Ra.forEach(s=>{this.Sa(s.key)&&(this.da=this.da.add(s.key))});const t=[];return e.forEach(s=>{this.da.has(s)||t.push(new WP(s))}),this.da.forEach(s=>{e.has(s)||t.push(new HP(s))}),t}ba(e){this.Ta=e.Ts,this.da=Ce();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Oh.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class qB{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class KB{constructor(e){this.key=e,this.va=!1}}class XB{constructor(e,t,s,i,r,o){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Hh(a=>hP(a),hv),this.Ma=new Map,this.xa=new Set,this.Oa=new vt(he.comparator),this.Na=new Map,this.La=new nT,this.Ba={},this.ka=new Map,this.qa=Mh.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function YB(n,e,t=!0){const s=QP(n);let i;const r=s.Fa.get(e);return r?(s.sharedClientState.addLocalQueryTarget(r.targetId),i=r.view.Da()):i=await GP(s,e,t,!0),i}async function QB(n,e){const t=QP(n);await GP(t,e,!0,!1)}async function GP(n,e,t,s){const i=await vB(n.localStore,nr(e)),r=i.targetId,o=n.sharedClientState.addLocalQueryTarget(r,t);let a;return s&&(a=await JB(n,e,r,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&VP(n.remoteStore,i),a}async function JB(n,e,t,s,i){n.Ka=(f,p,m)=>async function(E,k,v,A){let C=k.view.ma(v);C.ns&&(C=await Xx(E.localStore,k.query,!1).then(({documents:S})=>k.view.ma(S,C)));const N=A&&A.targetChanges.get(k.targetId),F=A&&A.targetMismatches.get(k.targetId)!=null,V=k.view.applyChanges(C,E.isPrimaryClient,N,F);return sI(E,k.targetId,V.wa),V.snapshot}(n,f,p,m);const r=await Xx(n.localStore,e,!0),o=new GB(e,r.Ts),a=o.ma(r.documents),l=Cg.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",i),u=o.applyChanges(a,n.isPrimaryClient,l);sI(n,t,u.wa);const d=new qB(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot}async function ZB(n,e,t){const s=ye(n),i=s.Fa.get(e),r=s.Ma.get(i.targetId);if(r.length>1)return s.Ma.set(i.targetId,r.filter(o=>!hv(o,e))),void s.Fa.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await mE(s.localStore,i.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(i.targetId),t&&rT(s.remoteStore,i.targetId),_E(s,i.targetId)}).catch(Sg)):(_E(s,i.targetId),await mE(s.localStore,i.targetId,!0))}async function e3(n,e){const t=ye(n),s=t.Fa.get(e),i=t.Ma.get(s.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),rT(t.remoteStore,s.targetId))}async function t3(n,e,t){const s=l3(n);try{const i=await function(o,a){const l=ye(o),u=$t.now(),d=a.reduce((m,y)=>m.add(y.key),Ce());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=lo(),E=Ce();return l.cs.getEntries(m,d).next(k=>{y=k,y.forEach((v,A)=>{A.isValidDocument()||(E=E.add(v))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(k=>{f=k;const v=[];for(const A of a){const C=bU(A,f.get(A.key).overlayedDocument);C!=null&&v.push(new Pa(A.key,C,iP(C.value.mapValue),Ai.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,v,a)}).next(k=>{p=k;const v=k.applyToLocalDocumentSet(f,E);return l.documentOverlayCache.saveOverlays(m,k.batchId,v)})}).then(()=>({batchId:p.batchId,changes:pP(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new vt(Ve)),u=u.insert(a,l),o.Ba[o.currentUser.toKey()]=u}(s,i.batchId,t),await Rg(s,i.changes),await _v(s.remoteStore)}catch(i){const r=uT(i,"Failed to persist write");t.reject(r)}}async function qP(n,e){const t=ye(n);try{const s=await mB(t.localStore,e);e.targetChanges.forEach((i,r)=>{const o=t.Na.get(r);o&&(We(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?We(o.va):i.removedDocuments.size>0&&(We(o.va),o.va=!1))}),await Rg(t,s,e)}catch(s){await Sg(s)}}function nI(n,e,t){const s=ye(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const i=[];s.Fa.forEach((r,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=ye(o);l.onlineState=a;let u=!1;l.queries.forEach((d,f)=>{for(const p of f.j_)p.Z_(a)&&(u=!0)}),u&&fT(l)}(s.eventManager,e),i.length&&s.Ca.d_(i),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function n3(n,e,t){const s=ye(n);s.sharedClientState.updateQueryState(e,"rejected",t);const i=s.Na.get(e),r=i&&i.key;if(r){let o=new vt(he.comparator);o=o.insert(r,Rn.newNoDocument(r,me.min()));const a=Ce().add(r),l=new gv(me.min(),new Map,new vt(Ve),o,a);await qP(s,l),s.Oa=s.Oa.remove(r),s.Na.delete(e),gT(s)}else await mE(s.localStore,e,!1).then(()=>_E(s,e,t)).catch(Sg)}async function s3(n,e){const t=ye(n),s=e.batch.batchId;try{const i=await gB(t.localStore,e);XP(t,s,null),KP(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Rg(t,i)}catch(i){await Sg(i)}}async function i3(n,e,t){const s=ye(n);try{const i=await function(o,a){const l=ye(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(f=>(We(f!==null),d=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(s.localStore,e);XP(s,e,t),KP(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Rg(s,i)}catch(i){await Sg(i)}}function KP(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function XP(n,e,t){const s=ye(n);let i=s.Ba[s.currentUser.toKey()];if(i){const r=i.get(e);r&&(t?r.reject(t):r.resolve(),i=i.remove(e)),s.Ba[s.currentUser.toKey()]=i}}function _E(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Ma.get(e))n.Fa.delete(s),t&&n.Ca.$a(s,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(s=>{n.La.containsKey(s)||YP(n,s)})}function YP(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(rT(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),gT(n))}function sI(n,e,t){for(const s of t)s instanceof HP?(n.La.addReference(s.key,e),r3(n,s)):s instanceof WP?(ie("SyncEngine","Document no longer in limbo: "+s.key),n.La.removeReference(s.key,e),n.La.containsKey(s.key)||YP(n,s.key)):pe()}function r3(n,e){const t=e.key,s=t.path.canonicalString();n.Oa.get(t)||n.xa.has(s)||(ie("SyncEngine","New document in limbo: "+t),n.xa.add(s),gT(n))}function gT(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new he(ht.fromString(e)),s=n.qa.next();n.Na.set(s,new KB(t)),n.Oa=n.Oa.insert(t,s),VP(n.remoteStore,new sa(nr(uv(t.path)),s,"TargetPurposeLimboResolution",Wb.oe))}}async function Rg(n,e,t){const s=ye(n),i=[],r=[],o=[];s.Fa.isEmpty()||(s.Fa.forEach((a,l)=>{o.push(s.Ka(l,e,t).then(u=>{var d;if((u||t)&&s.isPrimaryClient){const f=u?!u.fromCache:(d=t==null?void 0:t.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;s.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){i.push(u);const f=iT.Wi(l.targetId,u);r.push(f)}}))}),await Promise.all(o),s.Ca.d_(i),await async function(l,u){const d=ye(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>W.forEach(u,p=>W.forEach(p.$i,m=>d.persistence.referenceDelegate.addReference(f,p.targetId,m)).next(()=>W.forEach(p.Ui,m=>d.persistence.referenceDelegate.removeReference(f,p.targetId,m)))))}catch(f){if(!xg(f))throw f;ie("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const p=f.targetId;if(!f.fromCache){const m=d.os.get(p),y=m.snapshotVersion,E=m.withLastLimboFreeSnapshotVersion(y);d.os=d.os.insert(p,E)}}}(s.localStore,r))}async function o3(n,e){const t=ye(n);if(!t.currentUser.isEqual(e)){ie("SyncEngine","User change. New user:",e.toKey());const s=await LP(t.localStore,e);t.currentUser=e,function(r,o){r.ka.forEach(a=>{a.forEach(l=>{l.reject(new ce(H.CANCELLED,o))})}),r.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Rg(t,s.hs)}}function a3(n,e){const t=ye(n),s=t.Na.get(e);if(s&&s.va)return Ce().add(s.key);{let i=Ce();const r=t.Ma.get(e);if(!r)return i;for(const o of r){const a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function QP(n){const e=ye(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=qP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=a3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=n3.bind(null,e),e.Ca.d_=HB.bind(null,e.eventManager),e.Ca.$a=WB.bind(null,e.eventManager),e}function l3(n){const e=ye(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=s3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=i3.bind(null,e),e}class d_{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mv(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return pB(this.persistence,new dB,e.initialUser,this.serializer)}Ga(e){return new cB(sT.Zr,this.serializer)}Wa(e){return new EB}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}d_.provider={build:()=>new d_};class vE{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>nI(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=o3.bind(null,this.syncEngine),await BB(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $B}()}createDatastore(e){const t=mv(e.databaseInfo.databaseId),s=function(r){return new SB(r)}(e.databaseInfo);return function(r,o,a,l){return new CB(r,o,a,l)}(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return function(s,i,r,o,a){return new RB(s,i,r,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>nI(this.syncEngine,t,0),function(){return Qx.D()?new Qx:new AB}())}createSyncEngine(e,t){return function(i,r,o,a,l,u,d){const f=new XB(i,r,o,a,l,u);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const r=ye(i);ie("RemoteStore","RemoteStore shutting down."),r.L_.add(5),await kg(r),r.k_.shutdown(),r.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}vE.provider={build:()=>new vE};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ao("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(e,t,s,i,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=i,this.user=In.UNAUTHENTICATED,this.clientId=tP.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(s,async o=>{ie("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(ie("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Jr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=uT(t,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function Bw(n,e){n.asyncQueue.verifyOperationInProgress(),ie("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener(async i=>{s.isEqual(i)||(await LP(e.localStore,i),s=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function iI(n,e){n.asyncQueue.verifyOperationInProgress();const t=await u3(n);ie("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(s=>Jx(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>Jx(e.remoteStore,i)),n._onlineComponents=e}async function u3(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ie("FirestoreClient","Using user provided OfflineComponentProvider");try{await Bw(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===H.FAILED_PRECONDITION||i.code===H.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Ph("Error using user provided cache. Falling back to memory cache: "+t),await Bw(n,new d_)}}else ie("FirestoreClient","Using default OfflineComponentProvider"),await Bw(n,new d_);return n._offlineComponents}async function JP(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ie("FirestoreClient","Using user provided OnlineComponentProvider"),await iI(n,n._uninitializedComponentsProvider._online)):(ie("FirestoreClient","Using default OnlineComponentProvider"),await iI(n,new vE))),n._onlineComponents}function h3(n){return JP(n).then(e=>e.syncEngine)}async function f_(n){const e=await JP(n),t=e.eventManager;return t.onListen=YB.bind(null,e.syncEngine),t.onUnlisten=ZB.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=QB.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=e3.bind(null,e.syncEngine),t}function d3(n,e,t={}){const s=new Jr;return n.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,u){const d=new mT({next:p=>{d.Za(),o.enqueueAndForget(()=>dT(r,f));const m=p.docs.has(a);!m&&p.fromCache?u.reject(new ce(H.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&p.fromCache&&l&&l.source==="server"?u.reject(new ce(H.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new pT(uv(a.path),d,{includeMetadataChanges:!0,_a:!0});return hT(r,f)}(await f_(n),n.asyncQueue,e,t,s)),s.promise}function f3(n,e,t={}){const s=new Jr;return n.asyncQueue.enqueueAndForget(async()=>function(r,o,a,l,u){const d=new mT({next:p=>{d.Za(),o.enqueueAndForget(()=>dT(r,f)),p.fromCache&&l.source==="server"?u.reject(new ce(H.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new pT(a,d,{includeMetadataChanges:!0,_a:!0});return hT(r,f)}(await f_(n),n.asyncQueue,e,t,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZP(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eN(n,e,t){if(!t)throw new ce(H.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function p3(n,e,t,s){if(e===!0&&s===!0)throw new ce(H.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function oI(n){if(!he.isDocumentKey(n))throw new ce(H.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function aI(n){if(he.isDocumentKey(n))throw new ce(H.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function yT(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":pe()}function xs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ce(H.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=yT(n);throw new ce(H.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new ce(H.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ce(H.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}p3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZP((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ce(H.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ce(H.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ce(H.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,i){return s.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vv{constructor(e,t,s,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lI({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ce(H.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ce(H.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lI(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new P4;switch(s.type){case"firstParty":return new M4(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new ce(H.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const s=rI.get(t);s&&(ie("ComponentProvider","Removing Datastore"),rI.delete(t),s.terminate())}(this),Promise.resolve()}}function g3(n,e,t,s={}){var i;const r=(n=xs(n,vv))._getSettings(),o=`${e}:${t}`;if(r.host!=="firestore.googleapis.com"&&r.host!==o&&Ph("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},r),{host:o,ssl:!1})),s.mockUserToken){let a,l;if(typeof s.mockUserToken=="string")a=s.mockUserToken,l=In.MOCK_USER;else{a=cR(s.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const u=s.mockUserToken.sub||s.mockUserToken.user_id;if(!u)throw new ce(H.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new In(u)}n._authCredentials=new N4(new eP(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Pg(this.firestore,e,this._query)}}class Hn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ga(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Hn(this.firestore,e,this._key)}}class ga extends Pg{constructor(e,t,s){super(e,t,uv(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Hn(this.firestore,null,new he(e))}withConverter(e){return new ga(this.firestore,e,this._path)}}function gf(n,e,...t){if(n=nt(n),eN("collection","path",e),n instanceof vv){const s=ht.fromString(e,...t);return aI(s),new ga(n,null,s)}{if(!(n instanceof Hn||n instanceof ga))throw new ce(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(ht.fromString(e,...t));return aI(s),new ga(n.firestore,null,s)}}function lt(n,e,...t){if(n=nt(n),arguments.length===1&&(e=tP.newId()),eN("doc","path",e),n instanceof vv){const s=ht.fromString(e,...t);return oI(s),new Hn(n,null,new he(s))}{if(!(n instanceof Hn||n instanceof ga))throw new ce(H.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(ht.fromString(e,...t));return oI(s),new Hn(n.firestore,n instanceof ga?n.converter:null,new he(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new OP(this,"async_queue_retry"),this.Vu=()=>{const s=Uw();s&&ie("AsyncQueue","Visibility state changed to "+s.visibilityState),this.t_.jo()},this.mu=e;const t=Uw();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Uw();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Jr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!xg(e))throw e;ie("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(s=>{this.Eu=s,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(s);throw ao("INTERNAL UNHANDLED ERROR: ",i),s}).then(s=>(this.du=!1,s))));return this.mu=t,t}enqueueAfterDelay(e,t,s){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=cT.createAndSchedule(this,e,t,s,r=>this.yu(r));return this.Tu.push(i),i}fu(){this.Eu&&pe()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,s)=>t.targetTimeMs-s.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function uI(n){return function(t,s){if(typeof t!="object"||t===null)return!1;const i=t;for(const r of s)if(r in i&&typeof i[r]=="function")return!0;return!1}(n,["next","error","complete"])}class ba extends vv{constructor(e,t,s,i){super(e,t,s,i),this.type="firestore",this._queue=new cI,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new cI(e),this._firestoreClient=void 0,await e}}}function m3(n,e){const t=typeof n=="object"?n:Lb(),s=typeof n=="string"?n:"(default)",i=sv(t,"firestore").getImmediate({identifier:s});if(!i._initialized){const r=oR("firestore");r&&g3(i,...r)}return i}function wv(n){if(n._terminated)throw new ce(H.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||y3(n),n._firestoreClient}function y3(n){var e,t,s;const i=n._freezeSettings(),r=function(a,l,u,d){return new K4(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,ZP(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=i.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new c3(n._authCredentials,n._appCheckCredentials,n._queue,r,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fh(pn.fromBase64String(e))}catch(t){throw new ce(H.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Fh(pn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ce(H.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ce(H.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ce(H.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,i){if(s.length!==i.length)return!1;for(let r=0;r<s.length;++r)if(s[r]!==i[r])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _3=/^__.*__$/;class v3{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Pa(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ig(e,this.data,t,this.fieldTransforms)}}class tN{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Pa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function nN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pe()}}class wT{constructor(e,t,s,i,r,o){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=i,r===void 0&&this.vu(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new wT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:s,xu:!1});return i.Ou(e),i}Nu(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:s,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return p_(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(nN(this.Cu)&&_3.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class w3{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||mv(e)}Qu(e,t,s,i=!1){return new wT({Cu:e,methodName:t,qu:s,path:un.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sN(n){const e=n._freezeSettings(),t=mv(n._databaseId);return new w3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function E3(n,e,t,s,i,r={}){const o=n.Qu(r.merge||r.mergeFields?2:0,e,t,i);AT("Data must be an object, but it was:",o,s);const a=iN(s,o);let l,u;if(r.merge)l=new Ts(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const d=[];for(const f of r.mergeFields){const p=wE(e,f,t);if(!o.contains(p))throw new ce(H.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);oN(d,p)||d.push(p)}l=new Ts(d),u=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=o.fieldTransforms;return new v3(new is(a),l,u)}class bv extends Av{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bv}}class ET extends Av{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Gf(e.serializer,yP(e.serializer,this.$u));return new vU(e.path,t)}isEqual(e){return e instanceof ET&&this.$u===e.$u}}function A3(n,e,t,s){const i=n.Qu(1,e,t);AT("Data must be an object, but it was:",i,s);const r=[],o=is.empty();wc(s,(l,u)=>{const d=bT(e,l,t);u=nt(u);const f=i.Nu(d);if(u instanceof bv)r.push(d);else{const p=Tv(u,f);p!=null&&(r.push(d),o.set(d,p))}});const a=new Ts(r);return new tN(o,a,i.fieldTransforms)}function b3(n,e,t,s,i,r){const o=n.Qu(1,e,t),a=[wE(e,s,t)],l=[i];if(r.length%2!=0)throw new ce(H.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<r.length;p+=2)a.push(wE(e,r[p])),l.push(r[p+1]);const u=[],d=is.empty();for(let p=a.length-1;p>=0;--p)if(!oN(u,a[p])){const m=a[p];let y=l[p];y=nt(y);const E=o.Nu(m);if(y instanceof bv)u.push(m);else{const k=Tv(y,E);k!=null&&(u.push(m),d.set(m,k))}}const f=new Ts(u);return new tN(d,f,o.fieldTransforms)}function Tv(n,e){if(rN(n=nt(n)))return AT("Unsupported field value:",e,n),iN(n,e);if(n instanceof Av)return function(s,i){if(!nN(i.Cu))throw i.Bu(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${s._methodName}() is not currently supported inside arrays`);const r=s._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(s,i){const r=[];let o=0;for(const a of s){let l=Tv(a,i.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),r.push(l),o++}return{arrayValue:{values:r}}}(n,e)}return function(s,i){if((s=nt(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return yP(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const r=$t.fromDate(s);return{timestampValue:u_(i.serializer,r)}}if(s instanceof $t){const r=new $t(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:u_(i.serializer,r)}}if(s instanceof _T)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Fh)return{bytesValue:IP(i.serializer,s._byteString)};if(s instanceof Hn){const r=i.databaseId,o=s.firestore._databaseId;if(!o.isEqual(r))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:tT(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof vT)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return Qb(a.serializer,l)})}}}}}}(s,i);throw i.Bu(`Unsupported field value: ${yT(s)}`)}(n,e)}function iN(n,e){const t={};return nP(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wc(n,(s,i)=>{const r=Tv(i,e.Mu(s));r!=null&&(t[s]=r)}),{mapValue:{fields:t}}}function rN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof $t||n instanceof _T||n instanceof Fh||n instanceof Hn||n instanceof Av||n instanceof vT)}function AT(n,e,t){if(!rN(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const s=yT(t);throw s==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+s)}}function wE(n,e,t){if((e=nt(e))instanceof Ev)return e._internalPath;if(typeof e=="string")return bT(n,e);throw p_("Field path arguments must be of type string or ",n,!1,void 0,t)}const T3=new RegExp("[~\\*/\\[\\]]");function bT(n,e,t){if(e.search(T3)>=0)throw p_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ev(...e.split("."))._internalPath}catch{throw p_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function p_(n,e,t,s,i){const r=s&&!s.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(r||o)&&(l+=" (found",r&&(l+=` in field ${s}`),o&&(l+=` in document ${i}`),l+=")"),new ce(H.INVALID_ARGUMENT,a+n+l)}function oN(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e,t,s,i,r){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Hn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new S3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(lN("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class S3 extends aN{data(){return super.data()}}function lN(n,e){return typeof e=="string"?bT(n,e):e instanceof Ev?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cN(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ce(H.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class x3{convertValue(e,t="none"){switch(uc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return It(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(cc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw pe()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return wc(e,(i,r)=>{s[i]=this.convertValue(r,t)}),s}convertVectorValue(e){var t,s,i;const r=(i=(s=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||s===void 0?void 0:s.values)===null||i===void 0?void 0:i.map(o=>It(o.doubleValue));return new vT(r)}convertGeoPoint(e){return new _T(It(e.latitude),It(e.longitude))}convertArray(e,t){return(e.values||[]).map(s=>this.convertValue(s,t))}convertServerTimestamp(e,t){switch(t){case"previous":const s=qb(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Bf(e));default:return null}}convertTimestamp(e){const t=Ea(e);return new $t(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=ht.fromString(e);We(DP(s));const i=new zf(s.get(1),s.get(3)),r=new he(s.popFirst(5));return i.isEqual(t)||ao(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I3(n,e,t){let s;return s=n?n.toFirestore(e):e,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class uN extends aN{constructor(e,t,s,i,r,o){super(e,t,s,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Jm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(lN("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}}class Jm extends uN{data(e={}){return super.data(e)}}class hN{constructor(e,t,s,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Fd(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(s=>{e.call(t,new Jm(this._firestore,this._userDataWriter,s.key,s,new Fd(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ce(H.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Jm(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fd(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>r||a.type!==3).map(a=>{const l=new Jm(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fd(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:C3(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function C3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pe()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zl(n){n=xs(n,Hn);const e=xs(n.firestore,ba);return d3(wv(e),n._key).then(t=>dN(e,n,t))}class TT extends x3{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hn(this.firestore,null,t)}}function hI(n){n=xs(n,Pg);const e=xs(n.firestore,ba),t=wv(e),s=new TT(e);return cN(n._query),f3(t,n._query).then(i=>new hN(e,s,n,i))}function su(n,e,t){n=xs(n,Hn);const s=xs(n.firestore,ba),i=I3(n.converter,e);return ST(s,[E3(sN(s),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ai.none())])}function qf(n,e,t,...s){n=xs(n,Hn);const i=xs(n.firestore,ba),r=sN(i);let o;return o=typeof(e=nt(e))=="string"||e instanceof Ev?b3(r,"updateDoc",n._key,e,t,s):A3(r,"updateDoc",n._key,e),ST(i,[o.toMutation(n._key,Ai.exists(!0))])}function Dc(n){return ST(xs(n.firestore,ba),[new Jb(n._key,Ai.none())])}function zw(n,...e){var t,s,i;n=nt(n);let r={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||uI(e[o])||(r=e[o],o++);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(uI(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(s=f.error)===null||s===void 0?void 0:s.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let l,u,d;if(n instanceof Hn)u=xs(n.firestore,ba),d=uv(n._key.path),l={next:f=>{e[o]&&e[o](dN(u,n,f))},error:e[o+1],complete:e[o+2]};else{const f=xs(n,Pg);u=xs(f.firestore,ba),d=f._query;const p=new TT(u);l={next:m=>{e[o]&&e[o](new hN(u,p,f,m))},error:e[o+1],complete:e[o+2]},cN(n._query)}return function(p,m,y,E){const k=new mT(E),v=new pT(m,k,y);return p.asyncQueue.enqueueAndForget(async()=>hT(await f_(p),v)),()=>{k.Za(),p.asyncQueue.enqueueAndForget(async()=>dT(await f_(p),v))}}(wv(u),d,a,l)}function ST(n,e){return function(s,i){const r=new Jr;return s.asyncQueue.enqueueAndForget(async()=>t3(await h3(s),i,r)),r.promise}(wv(n),e)}function dN(n,e,t){const s=t.docs.get(e._key),i=new TT(n);return new uN(n,i,e._key,s,new Fd(t.hasPendingWrites,t.fromCache),e.converter)}function k3(n){return new ET("increment",n)}(function(e,t=!0){(function(i){$h=i})(_c),oc(new va("firestore",(s,{instanceIdentifier:i,options:r})=>{const o=s.getProvider("app").getImmediate(),a=new ba(new D4(s.getProvider("auth-internal")),new F4(s.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ce(H.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zf(u.options.projectId,d)}(o,i),o);return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC").setMultipleInstances(!0)),Zi(Cx,"4.7.3",e),Zi(Cx,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fN="firebasestorage.googleapis.com",pN="storageBucket",R3=2*60*1e3,P3=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt extends ar{constructor(e,t,s=0){super($w(e),`Firebase Storage: ${t} (${$w(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Tt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return $w(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var bt;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(bt||(bt={}));function $w(n){return"storage/"+n}function xT(){const n="An unknown error occurred, please check the error payload for server response.";return new Tt(bt.UNKNOWN,n)}function N3(n){return new Tt(bt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function D3(n){return new Tt(bt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function L3(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Tt(bt.UNAUTHENTICATED,n)}function M3(){return new Tt(bt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function O3(n){return new Tt(bt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function F3(){return new Tt(bt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function V3(){return new Tt(bt.CANCELED,"User canceled the upload/download.")}function j3(n){return new Tt(bt.INVALID_URL,"Invalid URL '"+n+"'.")}function U3(n){return new Tt(bt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function B3(){return new Tt(bt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+pN+"' property when initializing the app?")}function z3(){return new Tt(bt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function $3(){return new Tt(bt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function H3(n){return new Tt(bt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function EE(n){return new Tt(bt.INVALID_ARGUMENT,n)}function gN(){return new Tt(bt.APP_DELETED,"The Firebase app was deleted.")}function W3(n){return new Tt(bt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function mf(n,e){return new Tt(bt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Td(n){throw new Tt(bt.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let s;try{s=zn.makeFromUrl(e,t)}catch{return new zn(e,"")}if(s.path==="")return s;throw U3(e)}static makeFromUrl(e,t){let s=null;const i="([A-Za-z0-9.\\-_]+)";function r(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function u(N){N.path_=decodeURIComponent(N.path)}const d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",m=new RegExp(`^https?://${f}/${d}/b/${i}/o${p}`,"i"),y={bucket:1,path:3},E=t===fN?"(?:storage.googleapis.com|storage.cloud.google.com)":t,k="([^?#]*)",v=new RegExp(`^https?://${E}/${i}/${k}`,"i"),C=[{regex:a,indices:l,postModify:r},{regex:m,indices:y,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let N=0;N<C.length;N++){const F=C[N],V=F.regex.exec(e);if(V){const S=V[F.indices.bucket];let T=V[F.indices.path];T||(T=""),s=new zn(S,T),F.postModify(s);break}}if(s==null)throw j3(e);return s}}class G3{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q3(n,e,t){let s=1,i=null,r=null,o=!1,a=0;function l(){return a===2}let u=!1;function d(...k){u||(u=!0,e.apply(null,k))}function f(k){i=setTimeout(()=>{i=null,n(m,l())},k)}function p(){r&&clearTimeout(r)}function m(k,...v){if(u){p();return}if(k){p(),d.call(null,k,...v);return}if(l()||o){p(),d.call(null,k,...v);return}s<64&&(s*=2);let C;a===1?(a=2,C=0):C=(s+Math.random())*1e3,f(C)}let y=!1;function E(k){y||(y=!0,p(),!u&&(i!==null?(k||(a=2),clearTimeout(i),f(0)):k||(a=1)))}return f(0),r=setTimeout(()=>{o=!0,E(!0)},t),E}function K3(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X3(n){return n!==void 0}function Y3(n){return typeof n=="object"&&!Array.isArray(n)}function IT(n){return typeof n=="string"||n instanceof String}function dI(n){return CT()&&n instanceof Blob}function CT(){return typeof Blob<"u"}function AE(n,e,t,s){if(s<e)throw EE(`Invalid value for '${n}'. Expected ${e} or greater.`);if(s>t)throw EE(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ac(n,e,t){let s=e;return t==null&&(s=`https://${e}`),`${t}://${s}/v0${n}`}function mN(n){const e=encodeURIComponent;let t="?";for(const s in n)if(n.hasOwnProperty(s)){const i=e(s)+"="+e(n[s]);t=t+i+"&"}return t=t.slice(0,-1),t}var ec;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(ec||(ec={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q3(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,r=e.indexOf(n)!==-1;return t||i||r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(e,t,s,i,r,o,a,l,u,d,f,p=!0){this.url_=e,this.method_=t,this.headers_=s,this.body_=i,this.successCodes_=r,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=f,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,y)=>{this.resolve_=m,this.reject_=y,this.start_()})}start_(){const e=(s,i)=>{if(i){s(!1,new Sm(!1,null,!0));return}const r=this.connectionFactory_();this.pendingConnection_=r;const o=a=>{const l=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&r.addUploadProgressListener(o),r.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&r.removeUploadProgressListener(o),this.pendingConnection_=null;const a=r.getErrorCode()===ec.NO_ERROR,l=r.getStatus();if(!a||Q3(l,this.additionalRetryCodes_)&&this.retry){const d=r.getErrorCode()===ec.ABORT;s(!1,new Sm(!1,null,d));return}const u=this.successCodes_.indexOf(l)!==-1;s(!0,new Sm(u,r))})},t=(s,i)=>{const r=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());X3(l)?r(l):r()}catch(l){o(l)}else if(a!==null){const l=xT();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?gN():V3();o(l)}else{const l=F3();o(l)}};this.canceled_?t(!1,new Sm(!1,null,!0)):this.backoffId_=q3(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&K3(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Sm{constructor(e,t,s){this.wasSuccessCode=e,this.connection=t,this.canceled=!!s}}function Z3(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function ez(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function tz(n,e){e&&(n["X-Firebase-GMPID"]=e)}function nz(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function sz(n,e,t,s,i,r,o=!0){const a=mN(n.urlParams),l=n.url+a,u=Object.assign({},n.headers);return tz(u,e),Z3(u,t),ez(u,r),nz(u,s),new J3(l,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iz(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function rz(...n){const e=iz();if(e!==void 0){const t=new e;for(let s=0;s<n.length;s++)t.append(n[s]);return t.getBlob()}else{if(CT())return new Blob(n);throw new Tt(bt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function oz(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function az(n){if(typeof atob>"u")throw H3("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Hw{constructor(e,t){this.data=e,this.contentType=t||null}}function lz(n,e){switch(n){case Yi.RAW:return new Hw(yN(e));case Yi.BASE64:case Yi.BASE64URL:return new Hw(_N(n,e));case Yi.DATA_URL:return new Hw(uz(e),hz(e))}throw xT()}function yN(n){const e=[];for(let t=0;t<n.length;t++){let s=n.charCodeAt(t);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const r=s,o=n.charCodeAt(++t);s=65536|(r&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function cz(n){let e;try{e=decodeURIComponent(n)}catch{throw mf(Yi.DATA_URL,"Malformed data URL.")}return yN(e)}function _N(n,e){switch(n){case Yi.BASE64:{const i=e.indexOf("-")!==-1,r=e.indexOf("_")!==-1;if(i||r)throw mf(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Yi.BASE64URL:{const i=e.indexOf("+")!==-1,r=e.indexOf("/")!==-1;if(i||r)throw mf(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=az(e)}catch(i){throw i.message.includes("polyfill")?i:mf(n,"Invalid character found")}const s=new Uint8Array(t.length);for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return s}class vN{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw mf(Yi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=t[1]||null;s!=null&&(this.base64=dz(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function uz(n){const e=new vN(n);return e.base64?_N(Yi.BASE64,e.rest):cz(e.rest)}function hz(n){return new vN(n).contentType}function dz(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,t){let s=0,i="";dI(e)?(this.data_=e,s=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(dI(this.data_)){const s=this.data_,i=oz(s,e,t);return i===null?null:new xo(i)}else{const s=new Uint8Array(this.data_.buffer,e,t-e);return new xo(s,!0)}}static getBlob(...e){if(CT()){const t=e.map(s=>s instanceof xo?s.data_:s);return new xo(rz.apply(null,t))}else{const t=e.map(o=>IT(o)?lz(Yi.RAW,o).data:o.data_);let s=0;t.forEach(o=>{s+=o.byteLength});const i=new Uint8Array(s);let r=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[r++]=o[a]}),new xo(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT(n){let e;try{e=JSON.parse(n)}catch{return null}return Y3(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fz(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function pz(n,e){const t=e.split("/").filter(s=>s.length>0).join("/");return n.length===0?t:n+"/"+t}function wN(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gz(n,e){return e}class Mn{constructor(e,t,s,i){this.server=e,this.local=t||e,this.writable=!!s,this.xform=i||gz}}let xm=null;function mz(n){return!IT(n)||n.length<2?n:wN(n)}function RT(){if(xm)return xm;const n=[];n.push(new Mn("bucket")),n.push(new Mn("generation")),n.push(new Mn("metageneration")),n.push(new Mn("name","fullPath",!0));function e(r,o){return mz(o)}const t=new Mn("name");t.xform=e,n.push(t);function s(r,o){return o!==void 0?Number(o):o}const i=new Mn("size");return i.xform=s,n.push(i),n.push(new Mn("timeCreated")),n.push(new Mn("updated")),n.push(new Mn("md5Hash",null,!0)),n.push(new Mn("cacheControl",null,!0)),n.push(new Mn("contentDisposition",null,!0)),n.push(new Mn("contentEncoding",null,!0)),n.push(new Mn("contentLanguage",null,!0)),n.push(new Mn("contentType",null,!0)),n.push(new Mn("metadata","customMetadata",!0)),xm=n,xm}function yz(n,e){function t(){const s=n.bucket,i=n.fullPath,r=new zn(s,i);return e._makeStorageReference(r)}Object.defineProperty(n,"ref",{get:t})}function _z(n,e,t){const s={};s.type="file";const i=t.length;for(let r=0;r<i;r++){const o=t[r];s[o.local]=o.xform(s,e[o.server])}return yz(s,n),s}function EN(n,e,t){const s=kT(e);return s===null?null:_z(n,s,t)}function vz(n,e,t,s){const i=kT(e);if(i===null||!IT(i.downloadTokens))return null;const r=i.downloadTokens;if(r.length===0)return null;const o=encodeURIComponent;return r.split(",").map(u=>{const d=n.bucket,f=n.fullPath,p="/b/"+o(d)+"/o/"+o(f),m=Ac(p,t,s),y=mN({alt:"media",token:u});return m+y})[0]}function wz(n,e){const t={},s=e.length;for(let i=0;i<s;i++){const r=e[i];r.writable&&(t[r.server]=n[r.local])}return JSON.stringify(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI="prefixes",pI="items";function Ez(n,e,t){const s={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[fI])for(const i of t[fI]){const r=i.replace(/\/$/,""),o=n._makeStorageReference(new zn(e,r));s.prefixes.push(o)}if(t[pI])for(const i of t[pI]){const r=n._makeStorageReference(new zn(e,i.name));s.items.push(r)}return s}function Az(n,e,t){const s=kT(t);return s===null?null:Ez(n,e,s)}class Gh{constructor(e,t,s,i){this.url=e,this.method=t,this.handler=s,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n){if(!n)throw xT()}function AN(n,e){function t(s,i){const r=EN(n,i,e);return PT(r!==null),r}return t}function bz(n,e){function t(s,i){const r=Az(n,e,i);return PT(r!==null),r}return t}function Tz(n,e){function t(s,i){const r=EN(n,i,e);return PT(r!==null),vz(r,i,n.host,n._protocol)}return t}function NT(n){function e(t,s){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=M3():i=L3():t.getStatus()===402?i=D3(n.bucket):t.getStatus()===403?i=O3(n.path):i=s,i.status=t.getStatus(),i.serverResponse=s.serverResponse,i}return e}function Sv(n){const e=NT(n);function t(s,i){let r=e(s,i);return s.getStatus()===404&&(r=N3(n.path)),r.serverResponse=i.serverResponse,r}return t}function Sz(n,e,t){const s=e.fullServerUrl(),i=Ac(s,n.host,n._protocol),r="GET",o=n.maxOperationRetryTime,a=new Gh(i,r,AN(n,t),o);return a.errorHandler=Sv(e),a}function xz(n,e,t,s,i){const r={};e.isRoot?r.prefix="":r.prefix=e.path+"/",t.length>0&&(r.delimiter=t),s&&(r.pageToken=s),i&&(r.maxResults=i);const o=e.bucketOnlyServerUrl(),a=Ac(o,n.host,n._protocol),l="GET",u=n.maxOperationRetryTime,d=new Gh(a,l,bz(n,e.bucket),u);return d.urlParams=r,d.errorHandler=NT(e),d}function Iz(n,e,t){const s=e.fullServerUrl(),i=Ac(s,n.host,n._protocol)+"?alt=media",r="GET",o=n.maxOperationRetryTime,a=new Gh(i,r,(l,u)=>u,o);return a.errorHandler=Sv(e),a}function Cz(n,e,t){const s=e.fullServerUrl(),i=Ac(s,n.host,n._protocol),r="GET",o=n.maxOperationRetryTime,a=new Gh(i,r,Tz(n,t),o);return a.errorHandler=Sv(e),a}function kz(n,e){const t=e.fullServerUrl(),s=Ac(t,n.host,n._protocol),i="DELETE",r=n.maxOperationRetryTime;function o(l,u){}const a=new Gh(s,i,o,r);return a.successCodes=[200,204],a.errorHandler=Sv(e),a}function Rz(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Pz(n,e,t){const s=Object.assign({},t);return s.fullPath=n.path,s.size=e.size(),s.contentType||(s.contentType=Rz(null,e)),s}function Nz(n,e,t,s,i){const r=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let C="";for(let N=0;N<2;N++)C=C+Math.random().toString().slice(2);return C}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const u=Pz(e,s,i),d=wz(u,t),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+l+"--",m=xo.getBlob(f,s,p);if(m===null)throw z3();const y={name:u.fullPath},E=Ac(r,n.host,n._protocol),k="POST",v=n.maxUploadRetryTime,A=new Gh(E,k,AN(n,t),v);return A.urlParams=y,A.headers=o,A.body=m.uploadData(),A.errorHandler=NT(e),A}class bN{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ec.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ec.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ec.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,s,i){if(this.sent_)throw Td("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const r in i)i.hasOwnProperty(r)&&this.xhr_.setRequestHeader(r,i[r].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Td("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Td("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Td("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Td("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Dz extends bN{initXhr(){this.xhr_.responseType="text"}}function Ng(){return new Dz}class Lz extends bN{initXhr(){this.xhr_.responseType="arraybuffer"}}function Mz(){return new Lz}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hc{constructor(e,t){this._service=e,t instanceof zn?this._location=t:this._location=zn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new hc(e,t)}get root(){const e=new zn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return wN(this._location.path)}get storage(){return this._service}get parent(){const e=fz(this._location.path);if(e===null)return null;const t=new zn(this._location.bucket,e);return new hc(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw W3(e)}}function Oz(n,e){n._throwIfRoot("getBytes");const t=Iz(n.storage,n._location);return n.storage.makeRequestWithTokens(t,Mz).then(s=>s)}function Fz(n,e,t){n._throwIfRoot("uploadBytes");const s=Nz(n.storage,n._location,RT(),new xo(e,!0),t);return n.storage.makeRequestWithTokens(s,Ng).then(i=>({metadata:i,ref:n}))}function Vz(n){const e={prefixes:[],items:[]};return TN(n,e).then(()=>e)}async function TN(n,e,t){const i=await jz(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&await TN(n,e,i.nextPageToken)}function jz(n,e){e!=null&&typeof e.maxResults=="number"&&AE("options.maxResults",1,1e3,e.maxResults);const t=e||{},s=xz(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(s,Ng)}function Uz(n){n._throwIfRoot("getMetadata");const e=Sz(n.storage,n._location,RT());return n.storage.makeRequestWithTokens(e,Ng)}function Bz(n){n._throwIfRoot("getDownloadURL");const e=Cz(n.storage,n._location,RT());return n.storage.makeRequestWithTokens(e,Ng).then(t=>{if(t===null)throw $3();return t})}function zz(n){n._throwIfRoot("deleteObject");const e=kz(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Ng)}function $z(n,e){const t=pz(n._location.path,e),s=new zn(n._location.bucket,t);return new hc(n.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hz(n){return/^[A-Za-z]+:\/\//.test(n)}function Wz(n,e){return new hc(n,e)}function SN(n,e){if(n instanceof DT){const t=n;if(t._bucket==null)throw B3();const s=new hc(t,t._bucket);return e!=null?SN(s,e):s}else return e!==void 0?$z(n,e):n}function Gz(n,e){if(e&&Hz(e)){if(n instanceof DT)return Wz(n,e);throw EE("To use ref(service, url), the first argument must be a Storage instance.")}else return SN(n,e)}function gI(n,e){const t=e==null?void 0:e[pN];return t==null?null:zn.makeFromBucketSpec(t,n)}function qz(n,e,t,s={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=s;i&&(n._overrideAuthToken=typeof i=="string"?i:cR(i,n.app.options.projectId))}class DT{constructor(e,t,s,i,r){this.app=e,this._authProvider=t,this._appCheckProvider=s,this._url=i,this._firebaseVersion=r,this._bucket=null,this._host=fN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=R3,this._maxUploadRetryTime=P3,this._requests=new Set,i!=null?this._bucket=zn.makeFromBucketSpec(i,this._host):this._bucket=gI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=zn.makeFromBucketSpec(this._url,e):this._bucket=gI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){AE("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){AE("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new hc(this,e)}_makeRequest(e,t,s,i,r=!0){if(this._deleted)return new G3(gN());{const o=sz(e,this._appId,s,i,t,this._firebaseVersion,r);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[s,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,s,i).getPromise()}}const mI="@firebase/storage",yI="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xN="storage";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kz(n,e){return n=nt(n),Oz(n)}function Xz(n,e,t){return n=nt(n),Fz(n,e,t)}function Yz(n){return n=nt(n),Uz(n)}function yf(n){return n=nt(n),Vz(n)}function _I(n){return n=nt(n),Bz(n)}function Ww(n){return n=nt(n),zz(n)}function zr(n,e){return n=nt(n),Gz(n,e)}function Qz(n=Lb(),e){n=nt(n);const s=sv(n,xN).getImmediate({identifier:e}),i=oR("storage");return i&&Jz(s,...i),s}function Jz(n,e,t,s={}){qz(n,e,t,s)}function Zz(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),s=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new DT(t,s,i,e,_c)}function e6(){oc(new va(xN,Zz,"PUBLIC").setMultipleInstances(!0)),Zi(mI,yI,""),Zi(mI,yI,"esm2017")}e6();const IN={apiKey:"AIzaSyCPg-DCTI8xn4oSWrr0D8teFV79vpBkcts",authDomain:"state-a1.firebaseapp.com",projectId:"state-a1",storageBucket:"state-a1.firebasestorage.app",messagingSenderId:"678269987849",appId:"1:678269987849:web:98b3eeb7c2340dfa395cd8"},LT=dR(IN),Ja=k4(LT),qe=m3(LT),$r=Qz(LT),t6=n=>{let e="";for(let t=10;t<n.length&&e.length<11;t+=2)/\d/.test(n[t])&&(e+=n[t]);return e},n6=()=>Array.from({length:5},()=>"ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*26)]).join(""),Gw=()=>new Date().toLocaleDateString("en-GB"),qw=()=>new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),s6=async()=>{var i,r;let n=localStorage.getItem("DeviceName");if(n)return n;if((i=navigator.userAgentData)!=null&&i.getHighEntropyValues)try{const o=await navigator.userAgentData.getHighEntropyValues(["model"]);if((r=o.model)!=null&&r.length&&o.model!=="Unknown")return localStorage.setItem("DeviceName",o.model),o.model}catch{}const e=navigator.userAgent,t=e.match(/Android\s[\d.]+;\s([^)]+)/i);if(t)return n=t[1].trim(),localStorage.setItem("DeviceName",n),n;const s=[[/iphone/i,"iPhone"],[/ipad/i,"iPad"],[/windows/i,"Windows PC"],[/macintosh/i,"MacBook"],[/linux/i,"Linux Device"]];for(const[o,a]of s)if(o.test(e))return localStorage.setItem("DeviceName",a),a;return n=navigator.platform||"Unknown",localStorage.setItem("DeviceName",n),n},i6=({onLoginSuccess:n})=>{const[e,t]=K.useState(1),[s,i]=K.useState(""),[r,o]=K.useState(""),[a,l]=K.useState(""),[u,d]=K.useState(!1),[f,p]=K.useState(!1),[m,y]=K.useState(null),[E,k]=K.useState(!1),[v,A]=K.useState(!1),[C,N]=K.useState(!1),F=K.useRef(null),V=K.useRef(null),S=K.useRef(null);K.useEffect(()=>{var O;(O=F.current)==null||O.focus()},[]),K.useEffect(()=>((async()=>{if(Ja.currentUser){N(!0);return}try{await iE(Ja,"temrevil@gmail.com","1q2w3e"),N(!0)}catch{try{await iE(Ja,"temrevil+1@gmail.com","M074mm3d+"),N(!0)}catch(ne){console.error("Auto login failed",ne)}}})(),yj(Ja,L=>N(!!L))),[]);const T=O=>{const L=O.target.value.replace(/[^0-9]/g,"");L.length<=11&&(i(L),m&&y(null),v&&A(!1),e!==1&&(t(1),o(""),l(""),d(!1)))},P=async O=>{if(O.preventDefault(),s.length!==11)return y("ID must be exactly 11 digits");k(!0),y(null),A(!1);try{let L=!1;try{((await Zl(lt(qe,"Blocked",s))).exists()||(await hI(gf(qe,"Snitches"))).docs.some(z=>z.data()["The Login Number"]===s))&&(L=!0)}catch{}if(L){A(!0),y("ACCESS DENIED: Identity flagged."),k(!1);return}const ne=lt(qe,"Numbers",s);if((await Zl(ne)).exists()){const de=IN.apiKey,Y=de.slice(0,10)+de.slice(10).split("").reduce((z,$,q)=>z+(s[q%s.length]||"")+$,"");o(Y),d(!1)}else o(""),d(!0);t(2),setTimeout(()=>{var de;return(de=V.current)==null?void 0:de.focus()},300)}catch{y("System verification failed.")}finally{k(!1)}},D=async O=>{O.preventDefault(),k(!0);try{if(!r.startsWith("AIzaSyCPg-"))throw new Error("Invalid Token");if(r.trim().length!==68){y("Invalid Token Length"),k(!1);return}const L=t6(r);if(L!==s){try{const Y=gf(qe,"Snitches"),z=await hI(Y);z.docs.some($=>$.data()["The Login Number"]===s)||(await su(lt(Y,`Match ${z.size+1}`),{"The Login Number":s,"The Snitch":L,"Snitched Date":Gw(),"Snitched Time":qw()}),await su(lt(qe,"Blocked",s),{"Blocked Date":Gw(),"Blocked Time":qw(),Reason:"tried to snitch"}))}catch{}localStorage.setItem("Number",s),A(!0),y("SECURITY VIOLATION DETECTED"),k(!1);return}const ne=await s6(),Ne=n6();localStorage.setItem("Number",s),localStorage.setItem("Code",Ne);const de=await Zl(lt(qe,"Numbers",s));if(de.exists()){const Y=de.data(),z=Y.Devices||{},$=z["Devices Allowed"]||5,q=z["Devices Name"]||{},oe=Object.values(q);if(!oe.includes(ne)&&oe.length>=$)throw new Error("Device limit reached");const se=z.Archived||{};se[Object.keys(se).length+1]={Code:Ne,Date:Gw(),Time:qw()},oe.includes(ne)||(q[Object.keys(q).length+1]=ne),await qf(lt(qe,"Numbers",s),{Devices:{"Devices Allowed":$,"Devices Name":q,Archived:se}}),Y.Name&&Y.Name!=="Unknown"?(localStorage.setItem("Name",Y.Name),n()):(t(3),setTimeout(()=>{var J;return(J=S.current)==null?void 0:J.focus()},300))}else n()}catch(L){console.error(L),y(L.message==="Device limit reached"?"Maximum device limit reached.":"Authentication Failed.")}finally{k(!1)}},M=async O=>{if(O.preventDefault(),!!a.trim()){k(!0);try{await qf(lt(qe,"Numbers",s),{Name:a.trim()}),localStorage.setItem("Name",a.trim()),n()}catch{y("Failed to update profile.")}finally{k(!1)}}};return b.jsx("div",{className:"login-container",children:b.jsxs("div",{className:`login-card ${v?"blocked":""}`,children:[b.jsx("div",{className:"absolute top-6 right-6 flex items-center gap-2",children:b.jsx("div",{className:`rounded-full ${C?"bg-success":"bg-warning"}`,style:{width:"8px",height:"8px",boxShadow:C?"0 0 10px rgba(16, 185, 129, 0.5)":"none"}})}),b.jsxs("div",{className:"mb-8 mt-2 flex flex-col items-center",children:[b.jsx("div",{className:`rounded-full flex items-center justify-center mb-6 transition-colors ${v?"text-error bg-red-900/20":"text-white bg-surface"}`,style:{width:"72px",height:"72px",border:"1px solid var(--color-border)"},children:v?b.jsx(q0,{size:32}):e===3?b.jsx(UO,{size:32}):b.jsx(Zk,{size:32})}),b.jsx("h1",{className:"text-3xl font-bold text-white tracking-tight",children:v?"Restricted":e===3?"Setup":"The State"}),b.jsx("p",{className:`text-base text-center mt-2 font-medium ${v?"text-error":"text-muted"}`,children:e===1?"Enter identity number":e===3?"Create profile":"Confirm security token"})]}),b.jsxs("form",{onSubmit:e===1?P:e===2?D:M,className:"flex flex-col gap-4",children:[b.jsxs("div",{className:e===3?"hidden":"block",children:[b.jsx("div",{className:"flex flex-col gap-3",children:b.jsxs("div",{className:"relative",children:[b.jsx("input",{ref:F,type:"text",inputMode:"numeric",value:s,onChange:T,placeholder:"000 0000 0000",className:`login-input text-center font-mono text-xl ${m&&e===1?"error":""}`}),e===2&&b.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2",children:b.jsx(PO,{size:20,className:"text-success"})})]})}),e===2&&b.jsx("div",{className:"animate-slide-up mt-4",children:b.jsxs("div",{className:"relative",children:[b.jsx("input",{ref:V,type:"text",value:r,onChange:O=>u&&o(O.target.value),readOnly:!u,placeholder:u?"Paste security token...":"Token missing...",className:`login-input pl-4 pr-12 text-xs font-mono break-all ${u?"":"text-success cursor-default opacity-90"}`}),b.jsx("button",{type:"button",onClick:()=>{r&&(navigator.clipboard.writeText(r),p(!0),setTimeout(()=>p(!1),2e3))},className:"absolute right-2 top-1/2 -translate-y-1/2 btn-icon",children:f?b.jsx(kO,{size:16,className:"text-success"}):b.jsx(NO,{size:16})})]})})]}),b.jsx("div",{className:`${e===3?"block":"hidden"} animate-slide-up`,children:b.jsx("input",{ref:S,type:"text",value:a,onChange:O=>l(O.target.value),placeholder:"Full Name",className:"login-input text-center text-lg"})}),b.jsx("div",{style:{minHeight:"1.5rem",display:"flex",alignItems:"center",justifyContent:"center"},children:m&&b.jsxs("div",{className:"flex items-center gap-2 text-xs text-error font-medium animate-shake",children:[b.jsx(tR,{size:14})," ",m]})}),b.jsx("button",{type:"submit",disabled:E||e===1&&s.length!==11||e===3&&!a.trim(),className:`btn btn-primary w-full ${v?"btn-danger":""}`,children:E?b.jsx(du,{size:20,className:"animate-spin"}):b.jsxs(b.Fragment,{children:[e===1?"Continue":e===3?"Finish":"Authenticate"," ",e===1&&b.jsx(Jk,{size:18})]})})]}),b.jsx("div",{className:"mt-8 text-center",children:b.jsx("p",{className:"text-dim uppercase tracking-widest text-[10px] font-bold",children:"Authorized Personnel Only"})})]})})};var _f={};_f.d=(n,e)=>{for(var t in e)_f.o(e,t)&&!_f.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};_f.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var ge=globalThis.pdfjsLib={};_f.d(ge,{AbortException:()=>bc,AnnotationEditorLayer:()=>NA,AnnotationEditorParamsType:()=>Pe,AnnotationEditorType:()=>Ae,AnnotationEditorUIManager:()=>fc,AnnotationLayer:()=>Z$,AnnotationMode:()=>Io,ColorPicker:()=>__,DOMSVGFactory:()=>$T,DrawLayer:()=>MA,FeatureTest:()=>Wn,GlobalWorkerOptions:()=>Hr,ImageKind:()=>Zm,InvalidPDFException:()=>kN,MissingPDFException:()=>Dg,OPS:()=>ni,OutputScale:()=>IE,PDFDataRangeTransport:()=>SD,PDFDateString:()=>jT,PDFWorker:()=>_u,PasswordResponses:()=>l6,PermissionFlag:()=>a6,PixelsPerInch:()=>Ta,RenderingCancelledException:()=>FT,TextLayer:()=>Kf,UnexpectedResponseException:()=>kv,Util:()=>le,VerbosityLevel:()=>xv,XfaLayer:()=>ID,build:()=>D$,createValidAbsoluteUrl:()=>d6,fetchData:()=>Pv,getDocument:()=>T$,getFilenameFromUrl:()=>E6,getPdfFilenameFromUrl:()=>A6,getXfaPageViewport:()=>b6,isDataScheme:()=>Nv,isPdfFile:()=>VT,noContextMenu:()=>Si,normalizeUnicode:()=>_6,setLayerDimensions:()=>dc,shadow:()=>xe,stopEvent:()=>_i,version:()=>N$});const Bn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),CN=[1,0,0,1,0,0],bE=[.001,0,0,.001,0,0],r6=1e7,Kw=1.35,ws={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Io={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},o6="pdfjs_internal_editor_",Ae={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Pe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},a6={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},wn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Zm={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Mt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Sd={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},xv={ERRORS:0,WARNINGS:1,INFOS:5},ni={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},l6={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Iv=xv.WARNINGS;function c6(n){Number.isInteger(n)&&(Iv=n)}function u6(){return Iv}function Cv(n){Iv>=xv.INFOS&&console.log(`Info: ${n}`)}function Te(n){Iv>=xv.WARNINGS&&console.log(`Warning: ${n}`)}function Xe(n){throw new Error(n)}function Dt(n,e){n||Xe(e)}function h6(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function d6(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=y6(n)}catch{}}const s=e?new URL(n,e):new URL(n);if(h6(s))return s}catch{}return null}function xe(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Na=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class TE extends Na{constructor(e,t){super(e,"PasswordException"),this.code=t}}class SE extends Na{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class kN extends Na{constructor(e){super(e,"InvalidPDFException")}}class Dg extends Na{constructor(e){super(e,"MissingPDFException")}}class kv extends Na{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class f6 extends Na{constructor(e){super(e,"FormatError")}}class bc extends Na{constructor(e){super(e,"AbortException")}}function RN(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Xe("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),o=n.subarray(i,r);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function Rv(n){typeof n!="string"&&Xe("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function p6(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function MT(n){const e=Object.create(null);for(const[t,s]of n)e[t]=s;return e}function g6(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function m6(){try{return new Function(""),!0}catch{return!1}}class Wn{static get isLittleEndian(){return xe(this,"isLittleEndian",g6())}static get isEvalSupported(){return xe(this,"isEvalSupported",m6())}static get isOffscreenCanvasSupported(){return xe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return xe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?xe(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):xe(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return xe(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Xw=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Zr,ey,xE;class le{static makeHexColor(e,t,s){return`#${Xw[e]}${Xw[t]}${Xw[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const s=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[s,i]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s;return[i,r]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),o=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],r[0],o[0]),Math.min(s[1],i[1],r[1],o[1]),Math.max(s[0],i[0],r[0],o[0]),Math.max(s[1],i[1],r[1],o[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(s+o)/2,l=Math.sqrt((s+o)**2-4*(s*o-r*i))/2,u=a+l||1,d=a-l||1;return[Math.sqrt(u),Math.sqrt(d)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>o?null:[s,r,i,o]}static bezierBoundingBox(e,t,s,i,r,o,a,l,u){return u?(u[0]=Math.min(u[0],e,a),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,a),u[3]=Math.max(u[3],t,l)):u=[Math.min(e,a),Math.min(t,l),Math.max(e,a),Math.max(t,l)],x(this,Zr,xE).call(this,e,s,r,a,t,i,o,l,3*(-e+3*(s-r)+a),6*(e-2*s+r),3*(s-e),u),x(this,Zr,xE).call(this,e,s,r,a,t,i,o,l,3*(-t+3*(i-o)+l),6*(t-2*i+o),3*(i-t),u),u}}Zr=new WeakSet,ey=function(e,t,s,i,r,o,a,l,u,d){if(u<=0||u>=1)return;const f=1-u,p=u*u,m=p*u,y=f*(f*(f*e+3*u*t)+3*p*s)+m*i,E=f*(f*(f*r+3*u*o)+3*p*a)+m*l;d[0]=Math.min(d[0],y),d[1]=Math.min(d[1],E),d[2]=Math.max(d[2],y),d[3]=Math.max(d[3],E)},xE=function(e,t,s,i,r,o,a,l,u,d,f,p){if(Math.abs(u)<1e-12){Math.abs(d)>=1e-12&&x(this,Zr,ey).call(this,e,t,s,i,r,o,a,l,-f/d,p);return}const m=d**2-4*f*u;if(m<0)return;const y=Math.sqrt(m),E=2*u;x(this,Zr,ey).call(this,e,t,s,i,r,o,a,l,(-d+y)/E,p),x(this,Zr,ey).call(this,e,t,s,i,r,o,a,l,(-d-y)/E,p)},I(le,Zr);function y6(n){return decodeURIComponent(escape(n))}let Yw=null,vI=null;function _6(n){return Yw||(Yw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,vI=new Map([["","t"]])),n.replaceAll(Yw,(e,t,s)=>t?t.normalize("NFKC"):vI.get(s))}function v6(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),RN(n)}const OT="pdfjs_internal_id_",dr={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};function w6(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(RN(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const fr="http://www.w3.org/2000/svg",Ga=class Ga{};ue(Ga,"CSS",96),ue(Ga,"PDF",72),ue(Ga,"PDF_TO_CSS_UNITS",Ga.CSS/Ga.PDF);let Ta=Ga;async function Pv(n,e="text"){if(Vd(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Lg{constructor({viewBox:e,scale:t,rotation:s,offsetX:i=0,offsetY:r=0,dontFlip:o=!1}){this.viewBox=e,this.scale=t,this.rotation=s,this.offsetX=i,this.offsetY=r;const a=(e[2]+e[0])/2,l=(e[3]+e[1])/2;let u,d,f,p;switch(s%=360,s<0&&(s+=360),s){case 180:u=-1,d=0,f=0,p=1;break;case 90:u=0,d=1,f=1,p=0;break;case 270:u=0,d=-1,f=-1,p=0;break;case 0:u=1,d=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(f=-f,p=-p);let m,y,E,k;u===0?(m=Math.abs(l-e[1])*t+i,y=Math.abs(a-e[0])*t+r,E=(e[3]-e[1])*t,k=(e[2]-e[0])*t):(m=Math.abs(a-e[0])*t+i,y=Math.abs(l-e[1])*t+r,E=(e[2]-e[0])*t,k=(e[3]-e[1])*t),this.transform=[u*t,d*t,f*t,p*t,m-u*t*a-f*t*l,y-d*t*a-p*t*l],this.width=E,this.height=k}get rawDims(){const{viewBox:e}=this;return xe(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new Lg({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){return le.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=le.applyTransform([e[0],e[1]],this.transform),s=le.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return le.applyInverseTransform([e,t],this.transform)}}class FT extends Na{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Nv(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function VT(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function E6(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function A6(n,e="document.pdf"){if(typeof n!="string")return e;if(Nv(n))return Te('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class wI{constructor(){ue(this,"started",Object.create(null));ue(this,"times",[])}time(e){e in this.started&&Te(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Te(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function Vd(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function Si(n){n.preventDefault()}function _i(n){n.preventDefault(),n.stopPropagation()}function EI(n){console.log("Deprecated API usage: "+n)}var Yf;class jT{static toDateObject(e){if(!e||typeof e!="string")return null;c(this,Yf)||w(this,Yf,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=c(this,Yf).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,u==="-"?(o+=d,a+=f):u==="+"&&(o-=d,a-=f),new Date(Date.UTC(s,i,r,o,a,l))}}Yf=new WeakMap,I(jT,Yf);function b6(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new Lg({viewBox:r,scale:e,rotation:t})}function UT(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Te(`Not a valid color format: "${n}"`),[0,0,0])}function T6(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,UT(s))}e.remove()}function at(n){const{a:e,b:t,c:s,d:i,e:r,f:o}=n.getTransform();return[e,t,s,i,r,o]}function Ii(n){const{a:e,b:t,c:s,d:i,e:r,f:o}=n.getTransform().invertSelf();return[e,t,s,i,r,o]}function dc(n,e,t=!1,s=!0){if(e instanceof Lg){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:o}=n,a=Wn.isCSSRoundSupported,l=`var(--scale-factor) * ${i}px`,u=`var(--scale-factor) * ${r}px`,d=a?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,f=a?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=d,o.height=f):(o.width=f,o.height=d)}s&&n.setAttribute("data-main-rotation",e.rotation)}class IE{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Co,Za,si,el,Qf,Jf,E_,PN,Gn,NN,DN,ty,LN,kE;const yr=class yr{constructor(e){I(this,Gn);I(this,Co,null);I(this,Za,null);I(this,si);I(this,el,null);I(this,Qf,null);w(this,si,e),c(yr,Jf)||w(yr,Jf,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=w(this,Co,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=c(this,si)._uiManager._signal;e.addEventListener("contextmenu",Si,{signal:t}),e.addEventListener("pointerdown",x(yr,E_,PN),{signal:t});const s=w(this,el,document.createElement("div"));s.className="buttons",e.append(s);const i=c(this,si).toolbarPosition;if(i){const{style:r}=e,o=c(this,si)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return x(this,Gn,LN).call(this),e}get div(){return c(this,Co)}hide(){var e;c(this,Co).classList.add("hidden"),(e=c(this,Za))==null||e.hideDropdown()}show(){var e;c(this,Co).classList.remove("hidden"),(e=c(this,Qf))==null||e.shown()}async addAltText(e){const t=await e.render();x(this,Gn,ty).call(this,t),c(this,el).prepend(t,c(this,Gn,kE)),w(this,Qf,e)}addColorPicker(e){w(this,Za,e);const t=e.renderButton();x(this,Gn,ty).call(this,t),c(this,el).prepend(t,c(this,Gn,kE))}remove(){var e;c(this,Co).remove(),(e=c(this,Za))==null||e.destroy(),w(this,Za,null)}};Co=new WeakMap,Za=new WeakMap,si=new WeakMap,el=new WeakMap,Qf=new WeakMap,Jf=new WeakMap,E_=new WeakSet,PN=function(e){e.stopPropagation()},Gn=new WeakSet,NN=function(e){c(this,si)._focusEventsAllowed=!1,_i(e)},DN=function(e){c(this,si)._focusEventsAllowed=!0,_i(e)},ty=function(e){const t=c(this,si)._uiManager._signal;e.addEventListener("focusin",x(this,Gn,NN).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",x(this,Gn,DN).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Si,{signal:t})},LN=function(){const{editorType:e,_uiManager:t}=c(this,si),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",c(yr,Jf)[e]),x(this,Gn,ty).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),c(this,el).append(s)},kE=function(){const e=document.createElement("div");return e.className="divider",e},I(yr,E_),I(yr,Jf,null);let CE=yr;var Zf,tl,nl,Sa,MN,ON,FN;class S6{constructor(e){I(this,Sa);I(this,Zf,null);I(this,tl,null);I(this,nl);w(this,nl,e)}show(e,t,s){const[i,r]=x(this,Sa,ON).call(this,t,s),{style:o}=c(this,tl)||w(this,tl,x(this,Sa,MN).call(this));e.append(c(this,tl)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){c(this,tl).remove()}}Zf=new WeakMap,tl=new WeakMap,nl=new WeakMap,Sa=new WeakSet,MN=function(){const e=w(this,tl,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Si,{signal:c(this,nl)._signal});const t=w(this,Zf,document.createElement("div"));return t.className="buttons",e.append(t),x(this,Sa,FN).call(this),e},ON=function(e,t){let s=0,i=0;for(const r of e){const o=r.y+r.height;if(o<s)continue;const a=r.x+(t?r.width:0);if(o>s){i=a,s=o;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,s]},FN=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=c(this,nl)._signal;e.addEventListener("contextmenu",Si,{signal:s}),e.addEventListener("click",()=>{c(this,nl).highlightSelection("floating_button")},{signal:s}),c(this,Zf).append(e)};function g_(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var A_;class x6{constructor(){I(this,A_,0)}get id(){return`${o6}${Ln(this,A_)._++}`}}A_=new WeakMap;var vu,ep,bn,wu,ny;const WT=class WT{constructor(){I(this,wu);I(this,vu,v6());I(this,ep,0);I(this,bn,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return xe(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return x(this,wu,ny).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return x(this,wu,ny).call(this,e,e)}async getFromBlob(e,t){const s=await t;return x(this,wu,ny).call(this,e,s)}async getFromId(e){c(this,bn)||w(this,bn,new Map);const t=c(this,bn).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){c(this,bn)||w(this,bn,new Map);let s=c(this,bn).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${c(this,vu)}_${Ln(this,ep)._++}`,refCounter:1,isSvg:!1},c(this,bn).set(e,s),c(this,bn).set(s.id,s),s}getSvgUrl(e){const t=c(this,bn).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;c(this,bn)||w(this,bn,new Map);const t=c(this,bn).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${c(this,vu)}_`)}};vu=new WeakMap,ep=new WeakMap,bn=new WeakMap,wu=new WeakSet,ny=async function(e,t){c(this,bn)||w(this,bn,new Map);let s=c(this,bn).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${c(this,vu)}_${Ln(this,ep)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await Pv(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=WT._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((u,d)=>{a.onload=()=>{s.bitmap=a,s.isSvg=!0,u()},o.onload=async()=>{const f=s.svgUrl=o.result;a.src=await r?`${f}#svgView(preserveAspectRatio(none))`:f},a.onerror=o.onerror=d});o.readAsDataURL(i),await l}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){Te(i),s=null}return c(this,bn).set(e,s),s&&c(this,bn).set(s.id,s),s};let RE=WT;var St,ko,tp,dt;class I6{constructor(e=128){I(this,St,[]);I(this,ko,!1);I(this,tp);I(this,dt,-1);w(this,tp,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(i&&e(),c(this,ko))return;const l={cmd:e,undo:t,post:s,type:r};if(c(this,dt)===-1){c(this,St).length>0&&(c(this,St).length=0),w(this,dt,0),c(this,St).push(l);return}if(o&&c(this,St)[c(this,dt)].type===r){a&&(l.undo=c(this,St)[c(this,dt)].undo),c(this,St)[c(this,dt)]=l;return}const u=c(this,dt)+1;u===c(this,tp)?c(this,St).splice(0,1):(w(this,dt,u),u<c(this,St).length&&c(this,St).splice(u)),c(this,St).push(l)}undo(){if(c(this,dt)===-1)return;w(this,ko,!0);const{undo:e,post:t}=c(this,St)[c(this,dt)];e(),t==null||t(),w(this,ko,!1),w(this,dt,c(this,dt)-1)}redo(){if(c(this,dt)<c(this,St).length-1){w(this,dt,c(this,dt)+1),w(this,ko,!0);const{cmd:e,post:t}=c(this,St)[c(this,dt)];e(),t==null||t(),w(this,ko,!1)}}hasSomethingToUndo(){return c(this,dt)!==-1}hasSomethingToRedo(){return c(this,dt)<c(this,St).length-1}cleanType(e){if(c(this,dt)!==-1){for(let t=c(this,dt);t>=0;t--)if(c(this,St)[t].type!==e){c(this,St).splice(t+1,c(this,dt)-t),w(this,dt,t);return}c(this,St).length=0,w(this,dt,-1)}}destroy(){w(this,St,null)}}St=new WeakMap,ko=new WeakMap,tp=new WeakMap,dt=new WeakMap;var b_,VN;class Mg{constructor(e){I(this,b_);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Wn.platform;for(const[s,i,r={}]of e)for(const o of s){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(x(this,b_,VN).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:o=[],checker:a=null}}=s;a&&!a(e,t)||(i.bind(e,...o,t)(),r||_i(t))}}b_=new WeakSet,VN=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const T_=class T_{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return T6(e),xe(this,"_colors",e)}convert(e){const t=UT(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,o)=>r===t[o]))return T_._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?le.makeHexColor(...t):e}};ue(T_,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let PE=T_;var Eu,us,Ft,tn,Au,wr,bu,Ls,Ro,sl,Tu,il,Pi,ii,rl,np,sp,Su,ip,Ni,Po,xu,No,Di,S_,Do,rp,Lo,ol,op,ap,Gt,ze,Er,al,lp,cp,Mo,Li,Ar,up,Ms,Q,sy,NE,jN,UN,iy,BN,zN,$N,DE,HN,LE,ME,WN,On,pr,GN,qN,OE,KN,jd,FE;const iu=class iu{constructor(e,t,s,i,r,o,a,l,u,d,f,p){I(this,Q);I(this,Eu,new AbortController);I(this,us,null);I(this,Ft,new Map);I(this,tn,new Map);I(this,Au,null);I(this,wr,null);I(this,bu,null);I(this,Ls,new I6);I(this,Ro,null);I(this,sl,null);I(this,Tu,0);I(this,il,new Set);I(this,Pi,null);I(this,ii,null);I(this,rl,new Set);ue(this,"_editorUndoBar",null);I(this,np,!1);I(this,sp,!1);I(this,Su,!1);I(this,ip,null);I(this,Ni,null);I(this,Po,null);I(this,xu,null);I(this,No,!1);I(this,Di,null);I(this,S_,new x6);I(this,Do,!1);I(this,rp,!1);I(this,Lo,null);I(this,ol,null);I(this,op,null);I(this,ap,null);I(this,Gt,Ae.NONE);I(this,ze,new Set);I(this,Er,null);I(this,al,null);I(this,lp,null);I(this,cp,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});I(this,Mo,[0,0]);I(this,Li,null);I(this,Ar,null);I(this,up,null);I(this,Ms,null);const m=this._signal=c(this,Eu).signal;w(this,Ar,e),w(this,up,t),w(this,Au,s),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:m}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),i._on("setpreference",this.onSetPreference.bind(this),{signal:m}),i._on("switchannotationeditorparams",y=>this.updateParams(y.type,y.value),{signal:m}),x(this,Q,BN).call(this),x(this,Q,WN).call(this),x(this,Q,DE).call(this),w(this,wr,r.annotationStorage),w(this,ip,r.filterFactory),w(this,al,o),w(this,xu,a||null),w(this,np,l),w(this,sp,u),w(this,Su,d),w(this,ap,f||null),this.viewParameters={realScale:Ta.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null}static get _keyboardManager(){const e=iu.prototype,t=o=>c(o,Ar).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return xe(this,"_keyboardManager",new Mg([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&c(o,Ar).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&c(o,Ar).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r;(e=c(this,Ms))==null||e.resolve(),w(this,Ms,null),(t=c(this,Eu))==null||t.abort(),w(this,Eu,null),this._signal=null;for(const o of c(this,tn).values())o.destroy();c(this,tn).clear(),c(this,Ft).clear(),c(this,rl).clear(),w(this,us,null),c(this,ze).clear(),c(this,Ls).destroy(),(s=c(this,Au))==null||s.destroy(),(i=c(this,Di))==null||i.hide(),w(this,Di,null),c(this,Ni)&&(clearTimeout(c(this,Ni)),w(this,Ni,null)),c(this,Li)&&(clearTimeout(c(this,Li)),w(this,Li,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return c(this,ap)}get useNewAltTextFlow(){return c(this,sp)}get useNewAltTextWhenAddingImage(){return c(this,Su)}get hcmFilter(){return xe(this,"hcmFilter",c(this,al)?c(this,ip).addHCMFilter(c(this,al).foreground,c(this,al).background):"none")}get direction(){return xe(this,"direction",getComputedStyle(c(this,Ar)).direction)}get highlightColors(){return xe(this,"highlightColors",c(this,xu)?new Map(c(this,xu).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return xe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),w(this,sl,e)}setMainHighlightColorPicker(e){w(this,op,e)}editAltText(e,t=!1){var s;(s=c(this,Au))==null||s.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":w(this,Su,t);break}}onPageChanging({pageNumber:e}){w(this,Tu,e-1)}focusMainContainer(){c(this,Ar).focus()}findParent(e,t){for(const s of c(this,tn).values()){const{x:i,y:r,width:o,height:a}=s.div.getBoundingClientRect();if(e>=i&&e<=i+o&&t>=r&&t<=r+a)return s}return null}disableUserSelect(e=!1){c(this,up).classList.toggle("noUserSelect",e)}addShouldRescale(e){c(this,rl).add(e)}removeShouldRescale(e){c(this,rl).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Ta.PDF_TO_CSS_UNITS;for(const s of c(this,rl))s.onScaleChanging();(t=c(this,sl))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o}=t,a=t.toString(),u=x(this,Q,sy).call(this,t).closest(".textLayer"),d=this.getSelectionBoxes(u);if(!d)return;t.empty();const f=x(this,Q,NE).call(this,u),p=c(this,Gt)===Ae.NONE,m=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:d,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o,text:a}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(Ae.HIGHLIGHT,m);return}m()}addToAnnotationStorage(e){!e.isEmpty()&&c(this,wr)&&!c(this,wr).has(e.id)&&c(this,wr).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,c(this,No)&&(w(this,No,!1),x(this,Q,iy).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of c(this,ze))if(t.div.contains(e)){w(this,ol,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!c(this,ol))return;const[e,t]=c(this,ol);w(this,ol,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){x(this,Q,DE).call(this),x(this,Q,LE).call(this)}removeEditListeners(){x(this,Q,HN).call(this),x(this,Q,ME).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of c(this,ii))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of c(this,ii))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=c(this,us))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of c(this,ze)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const o of c(this,ii))if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){Te(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const l of s){const u=await i.deserialize(l);if(!u)return;r.push(u)}const o=()=>{for(const l of r)x(this,Q,OE).call(this,l);x(this,Q,FE).call(this,r)},a=()=>{for(const l of r)l.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){Te(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),c(this,Gt)!==Ae.NONE&&!this.isEditorHandlingKeyboard&&iu._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,c(this,No)&&(w(this,No,!1),x(this,Q,iy).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(x(this,Q,zN).call(this),x(this,Q,LE).call(this),x(this,Q,On).call(this,{isEditing:c(this,Gt)!==Ae.NONE,isEmpty:x(this,Q,jd).call(this),hasSomethingToUndo:c(this,Ls).hasSomethingToUndo(),hasSomethingToRedo:c(this,Ls).hasSomethingToRedo(),hasSelectedEditor:!1})):(x(this,Q,$N).call(this),x(this,Q,ME).call(this),x(this,Q,On).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!c(this,ii)){w(this,ii,e);for(const t of c(this,ii))x(this,Q,pr).call(this,t.defaultPropertiesToUpdate)}}getId(){return c(this,S_).id}get currentLayer(){return c(this,tn).get(c(this,Tu))}getLayer(e){return c(this,tn).get(e)}get currentPageIndex(){return c(this,Tu)}addLayer(e){c(this,tn).set(e.pageIndex,e),c(this,Do)?e.enable():e.disable()}removeLayer(e){c(this,tn).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){var i;if(c(this,Gt)!==e&&!(c(this,Ms)&&(await c(this,Ms).promise,!c(this,Ms)))){if(w(this,Ms,Promise.withResolvers()),w(this,Gt,e),e===Ae.NONE){this.setEditingState(!1),x(this,Q,qN).call(this),(i=this._editorUndoBar)==null||i.hide(),c(this,Ms).resolve();return}this.setEditingState(!0),await x(this,Q,GN).call(this),this.unselectAll();for(const r of c(this,tn).values())r.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),c(this,Ms).resolve();return}for(const r of c(this,Ft).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();c(this,Ms).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==c(this,Gt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var s;if(c(this,ii)){switch(e){case Pe.CREATE:this.currentLayer.addNewEditor();return;case Pe.HIGHLIGHT_DEFAULT_COLOR:(s=c(this,op))==null||s.updateColor(t);break;case Pe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(c(this,lp)||w(this,lp,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of c(this,ze))i.updateParams(e,t);for(const i of c(this,ii))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const o of c(this,Ft).values())o.editorType===e&&o.show(t);(((r=c(this,lp))==null?void 0:r.get(Pe.HIGHLIGHT_SHOW_ALL))??!0)!==t&&x(this,Q,pr).call(this,[[Pe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(c(this,rp)!==e){w(this,rp,e);for(const t of c(this,tn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of c(this,Ft).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return c(this,Ft).get(e)}addEditor(e){c(this,Ft).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(c(this,Ni)&&clearTimeout(c(this,Ni)),w(this,Ni,setTimeout(()=>{this.focusMainContainer(),w(this,Ni,null)},0))),c(this,Ft).delete(e.id),this.unselect(e),(!e.annotationElementId||!c(this,il).has(e.annotationElementId))&&((t=c(this,wr))==null||t.remove(e.id))}addDeletedAnnotationElement(e){c(this,il).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return c(this,il).has(e)}removeDeletedAnnotationElement(e){c(this,il).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){c(this,us)!==e&&(w(this,us,e),e&&x(this,Q,pr).call(this,e.propertiesToUpdate))}updateUI(e){c(this,Q,KN)===e&&x(this,Q,pr).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){x(this,Q,pr).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(c(this,ze).has(e)){c(this,ze).delete(e),e.unselect(),x(this,Q,On).call(this,{hasSelectedEditor:this.hasSelection});return}c(this,ze).add(e),e.select(),x(this,Q,pr).call(this,e.propertiesToUpdate),x(this,Q,On).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=c(this,sl))==null||t.commitOrRemove();for(const s of c(this,ze))s!==e&&s.unselect();c(this,ze).clear(),c(this,ze).add(e),e.select(),x(this,Q,pr).call(this,e.propertiesToUpdate),x(this,Q,On).call(this,{hasSelectedEditor:!0})}isSelected(e){return c(this,ze).has(e)}get firstSelectedEditor(){return c(this,ze).values().next().value}unselect(e){e.unselect(),c(this,ze).delete(e),x(this,Q,On).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return c(this,ze).size!==0}get isEnterHandled(){return c(this,ze).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;c(this,Ls).undo(),x(this,Q,On).call(this,{hasSomethingToUndo:c(this,Ls).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:x(this,Q,jd).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){c(this,Ls).redo(),x(this,Q,On).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:c(this,Ls).hasSomethingToRedo(),isEmpty:x(this,Q,jd).call(this)})}addCommands(e){c(this,Ls).add(e),x(this,Q,On).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:x(this,Q,jd).call(this)})}cleanUndoStack(e){c(this,Ls).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...c(this,ze)],s=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},i=()=>{for(const o of t)x(this,Q,OE).call(this,o)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=c(this,us))==null||e.commitOrRemove()}hasSomethingToControl(){return c(this,us)||this.hasSelection}selectAll(){for(const e of c(this,ze))e.commit();x(this,Q,FE).call(this,c(this,Ft).values())}unselectAll(){var e;if(!(c(this,us)&&(c(this,us).commitOrRemove(),c(this,Gt)!==Ae.NONE))&&!((e=c(this,sl))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of c(this,ze))t.unselect();c(this,ze).clear(),x(this,Q,On).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;c(this,Mo)[0]+=e,c(this,Mo)[1]+=t;const[i,r]=c(this,Mo),o=[...c(this,ze)],a=1e3;c(this,Li)&&clearTimeout(c(this,Li)),w(this,Li,setTimeout(()=>{w(this,Li,null),c(this,Mo)[0]=c(this,Mo)[1]=0,this.addCommands({cmd:()=>{for(const l of o)c(this,Ft).has(l.id)&&l.translateInPage(i,r)},undo:()=>{for(const l of o)c(this,Ft).has(l.id)&&l.translateInPage(-i,-r)},mustExec:!1})},a));for(const l of o)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),w(this,Pi,new Map);for(const e of c(this,ze))c(this,Pi).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!c(this,Pi))return!1;this.disableUserSelect(!1);const e=c(this,Pi);w(this,Pi,null);let t=!1;for(const[{x:i,y:r,pageIndex:o},a]of e)a.newX=i,a.newY=r,a.newPageIndex=o,t||(t=i!==a.savedX||r!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const s=(i,r,o,a)=>{if(c(this,Ft).has(i.id)){const l=c(this,tn).get(a);l?i._setParentAndPosition(l,r,o):(i.pageIndex=a,i.x=r,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:o,newPageIndex:a}]of e)s(i,r,o,a)},undo:()=>{for(const[i,{savedX:r,savedY:o,savedPageIndex:a}]of e)s(i,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(c(this,Pi))for(const s of c(this,Pi).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||c(this,ze).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return c(this,us)===e}getActive(){return c(this,us)}getMode(){return c(this,Gt)}get imageManager(){return xe(this,"imageManager",new RE)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,d=t.rangeCount;u<d;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(u,d,f,p)=>({x:(d-i)/o,y:1-(u+f-s)/r,width:p/o,height:f/r});break;case"180":a=(u,d,f,p)=>({x:1-(u+f-s)/r,y:1-(d+p-i)/o,width:f/r,height:p/o});break;case"270":a=(u,d,f,p)=>({x:1-(d+p-i)/o,y:(u-s)/r,width:p/o,height:f/r});break;default:a=(u,d,f,p)=>({x:(u-s)/r,y:(d-i)/o,width:f/r,height:p/o});break}const l=[];for(let u=0,d=t.rangeCount;u<d;u++){const f=t.getRangeAt(u);if(!f.collapsed)for(const{x:p,y:m,width:y,height:E}of f.getClientRects())y===0||E===0||l.push(a(p,m,y,E))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(c(this,bu)||w(this,bu,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=c(this,bu))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=c(this,bu))==null?void 0:i.get(e.data.id);if(!t)return;const s=c(this,wr).getRawValue(t);s&&(c(this,Gt)===Ae.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}};Eu=new WeakMap,us=new WeakMap,Ft=new WeakMap,tn=new WeakMap,Au=new WeakMap,wr=new WeakMap,bu=new WeakMap,Ls=new WeakMap,Ro=new WeakMap,sl=new WeakMap,Tu=new WeakMap,il=new WeakMap,Pi=new WeakMap,ii=new WeakMap,rl=new WeakMap,np=new WeakMap,sp=new WeakMap,Su=new WeakMap,ip=new WeakMap,Ni=new WeakMap,Po=new WeakMap,xu=new WeakMap,No=new WeakMap,Di=new WeakMap,S_=new WeakMap,Do=new WeakMap,rp=new WeakMap,Lo=new WeakMap,ol=new WeakMap,op=new WeakMap,ap=new WeakMap,Gt=new WeakMap,ze=new WeakMap,Er=new WeakMap,al=new WeakMap,lp=new WeakMap,cp=new WeakMap,Mo=new WeakMap,Li=new WeakMap,Ar=new WeakMap,up=new WeakMap,Ms=new WeakMap,Q=new WeakSet,sy=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},NE=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of c(this,tn).values())if(s.hasTextLayer(e))return s;return null},jN=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=x(this,Q,sy).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(c(this,Di)||w(this,Di,new S6(this)),c(this,Di).show(s,i,this.direction==="ltr"))},UN=function(){var r,o,a;const e=document.getSelection();if(!e||e.isCollapsed){c(this,Er)&&((r=c(this,Di))==null||r.hide(),w(this,Er,null),x(this,Q,On).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===c(this,Er))return;const i=x(this,Q,sy).call(this,e).closest(".textLayer");if(!i){c(this,Er)&&((o=c(this,Di))==null||o.hide(),w(this,Er,null),x(this,Q,On).call(this,{hasSelectedText:!1}));return}if((a=c(this,Di))==null||a.hide(),w(this,Er,t),x(this,Q,On).call(this,{hasSelectedText:!0}),!(c(this,Gt)!==Ae.HIGHLIGHT&&c(this,Gt)!==Ae.NONE)&&(c(this,Gt)===Ae.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),w(this,No,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=c(this,Gt)===Ae.HIGHLIGHT?x(this,Q,NE).call(this,i):null;l==null||l.toggleDrawing();const u=new AbortController,d=this.combinedSignal(u),f=p=>{p.type==="pointerup"&&p.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),p.type==="pointerup"&&x(this,Q,iy).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}},iy=function(e=""){c(this,Gt)===Ae.HIGHLIGHT?this.highlightSelection(e):c(this,np)&&x(this,Q,jN).call(this)},BN=function(){document.addEventListener("selectionchange",x(this,Q,UN).bind(this),{signal:this._signal})},zN=function(){if(c(this,Po))return;w(this,Po,new AbortController);const e=this.combinedSignal(c(this,Po));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},$N=function(){var e;(e=c(this,Po))==null||e.abort(),w(this,Po,null)},DE=function(){if(c(this,Lo))return;w(this,Lo,new AbortController);const e=this.combinedSignal(c(this,Lo));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},HN=function(){var e;(e=c(this,Lo))==null||e.abort(),w(this,Lo,null)},LE=function(){if(c(this,Ro))return;w(this,Ro,new AbortController);const e=this.combinedSignal(c(this,Ro));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},ME=function(){var e;(e=c(this,Ro))==null||e.abort(),w(this,Ro,null)},WN=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},On=function(e){Object.entries(e).some(([s,i])=>c(this,cp)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(c(this,cp),e)}),c(this,Gt)===Ae.HIGHLIGHT&&e.hasSelectedEditor===!1&&x(this,Q,pr).call(this,[[Pe.HIGHLIGHT_FREE,!0]]))},pr=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},GN=async function(){if(!c(this,Do)){w(this,Do,!0);const e=[];for(const t of c(this,tn).values())e.push(t.enable());await Promise.all(e);for(const t of c(this,Ft).values())t.enable()}},qN=function(){if(this.unselectAll(),c(this,Do)){w(this,Do,!1);for(const e of c(this,tn).values())e.disable();for(const e of c(this,Ft).values())e.disable()}},OE=function(e){const t=c(this,tn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},KN=function(){let e=null;for(e of c(this,ze));return e},jd=function(){if(c(this,Ft).size===0)return!0;if(c(this,Ft).size===1)for(const e of c(this,Ft).values())return e.isEmpty();return!1},FE=function(e){for(const t of c(this,ze))t.unselect();c(this,ze).clear();for(const t of e)t.isEmpty()||(c(this,ze).add(t),t.select());x(this,Q,On).call(this,{hasSelectedEditor:this.hasSelection})},ue(iu,"TRANSLATE_SMALL",1),ue(iu,"TRANSLATE_BIG",10);let fc=iu;var qt,Mi,ri,Iu,Oi,hs,Cu,Fi,Jn,br,ll,Vi,Oo,vi,Ud,ry;const Fn=class Fn{constructor(e){I(this,vi);I(this,qt,null);I(this,Mi,!1);I(this,ri,null);I(this,Iu,null);I(this,Oi,null);I(this,hs,null);I(this,Cu,!1);I(this,Fi,null);I(this,Jn,null);I(this,br,null);I(this,ll,null);I(this,Vi,!1);w(this,Jn,e),w(this,Vi,e._uiManager.useNewAltTextFlow),c(Fn,Oo)||w(Fn,Oo,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Fn._l10n??(Fn._l10n=e)}async render(){const e=w(this,ri,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=w(this,Iu,document.createElement("span"));e.append(t),c(this,Vi)?(e.classList.add("new"),e.setAttribute("data-l10n-id",c(Fn,Oo).missing),t.setAttribute("data-l10n-id",c(Fn,Oo)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=c(this,Jn)._uiManager._signal;e.addEventListener("contextmenu",Si,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),c(this,Jn)._uiManager.editAltText(c(this,Jn)),c(this,Vi)&&c(this,Jn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:c(this,vi,Ud)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(w(this,Cu,!0),i(r))},{signal:s}),await x(this,vi,ry).call(this),e}finish(){c(this,ri)&&(c(this,ri).focus({focusVisible:c(this,Cu)}),w(this,Cu,!1))}isEmpty(){return c(this,Vi)?c(this,qt)===null:!c(this,qt)&&!c(this,Mi)}hasData(){return c(this,Vi)?c(this,qt)!==null||!!c(this,br):this.isEmpty()}get guessedText(){return c(this,br)}async setGuessedText(e){c(this,qt)===null&&(w(this,br,e),w(this,ll,await Fn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),x(this,vi,ry).call(this))}toggleAltTextBadge(e=!1){var t;if(!c(this,Vi)||c(this,qt)){(t=c(this,Fi))==null||t.remove(),w(this,Fi,null);return}if(!c(this,Fi)){const s=w(this,Fi,document.createElement("div"));s.className="noAltTextBadge",c(this,Jn).div.append(s)}c(this,Fi).classList.toggle("hidden",!e)}serialize(e){let t=c(this,qt);return!e&&c(this,br)===t&&(t=c(this,ll)),{altText:t,decorative:c(this,Mi),guessedText:c(this,br),textWithDisclaimer:c(this,ll)}}get data(){return{altText:c(this,qt),decorative:c(this,Mi)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(w(this,br,s),w(this,ll,i)),!(c(this,qt)===e&&c(this,Mi)===t)&&(r||(w(this,qt,e),w(this,Mi,t)),x(this,vi,ry).call(this))}toggle(e=!1){c(this,ri)&&(!e&&c(this,hs)&&(clearTimeout(c(this,hs)),w(this,hs,null)),c(this,ri).disabled=!e)}shown(){c(this,Jn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:c(this,vi,Ud)}})}destroy(){var e,t;(e=c(this,ri))==null||e.remove(),w(this,ri,null),w(this,Iu,null),w(this,Oi,null),(t=c(this,Fi))==null||t.remove(),w(this,Fi,null)}};qt=new WeakMap,Mi=new WeakMap,ri=new WeakMap,Iu=new WeakMap,Oi=new WeakMap,hs=new WeakMap,Cu=new WeakMap,Fi=new WeakMap,Jn=new WeakMap,br=new WeakMap,ll=new WeakMap,Vi=new WeakMap,Oo=new WeakMap,vi=new WeakSet,Ud=function(){return c(this,qt)&&"added"||c(this,qt)===null&&this.guessedText&&"review"||"missing"},ry=async function(){var i,r,o;const e=c(this,ri);if(!e)return;if(c(this,Vi)){if(e.classList.toggle("done",!!c(this,qt)),e.setAttribute("data-l10n-id",c(Fn,Oo)[c(this,vi,Ud)]),(i=c(this,Iu))==null||i.setAttribute("data-l10n-id",c(Fn,Oo)[`${c(this,vi,Ud)}-label`]),!c(this,qt)){(r=c(this,Oi))==null||r.remove();return}}else{if(!c(this,qt)&&!c(this,Mi)){e.classList.remove("done"),(o=c(this,Oi))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=c(this,Oi);if(!t){w(this,Oi,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${c(this,Jn).id}`;const a=100,l=c(this,Jn)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(c(this,hs)),w(this,hs,null)},{once:!0}),e.addEventListener("mouseenter",()=>{w(this,hs,setTimeout(()=>{w(this,hs,null),c(this,Oi).classList.add("show"),c(this,Jn)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;c(this,hs)&&(clearTimeout(c(this,hs)),w(this,hs,null)),(u=c(this,Oi))==null||u.classList.remove("show")},{signal:l})}c(this,Mi)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=c(this,qt)),t.parentNode||e.append(t);const s=c(this,Jn).getImageForAltText();s==null||s.setAttribute("aria-describedby",t.id)},I(Fn,Oo,null),ue(Fn,"_l10n",null);let m_=Fn;var cl,oi,ft,ku,Fo,hp,ul,nn,hl,Vo,jo,dp,dl,Os,fp,fl,Tr,ji,Ru,Pu,Fs,pp,x_,ve,VE,gp,jE,UE,XN,YN,BE,zE,$E,HE,QN,WE,JN,ZN,eD,GE,Bd;const Ue=class Ue{constructor(e){I(this,ve);I(this,cl,null);I(this,oi,null);I(this,ft,null);I(this,ku,!1);I(this,Fo,null);I(this,hp,"");I(this,ul,!1);I(this,nn,null);I(this,hl,null);I(this,Vo,null);I(this,jo,null);I(this,dp,"");I(this,dl,!1);I(this,Os,null);I(this,fp,!1);I(this,fl,!1);I(this,Tr,!1);I(this,ji,null);I(this,Ru,0);I(this,Pu,0);I(this,Fs,null);ue(this,"_editToolbar",null);ue(this,"_initialOptions",Object.create(null));ue(this,"_initialData",null);ue(this,"_isVisible",!0);ue(this,"_uiManager",null);ue(this,"_focusEventsAllowed",!0);I(this,pp,!1);I(this,x_,Ue._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Ue.prototype._resizeWithKeyboard,t=fc.TRANSLATE_SMALL,s=fc.TRANSLATE_BIG;return xe(this,"_resizerKeyboardManager",new Mg([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],Ue.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return xe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new C6({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Ue._l10n??(Ue._l10n=e),Ue._l10nResizer||(Ue._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Ue._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);Ue._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Xe("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return c(this,pp)}set _isDraggable(e){var t;w(this,pp,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=c(this,x_)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):x(this,ve,Bd).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(c(this,dl)?w(this,dl,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,o]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/o,this.fixAndSetPosition()}translate(e,t){x(this,ve,VE).call(this,this.parentDimensions,e,t)}translateInPage(e,t){c(this,Os)||w(this,Os,[this.x,this.y,this.width,this.height]),x(this,ve,VE).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){c(this,Os)||w(this,Os,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[l,u]=this.getBaseTranslation();o+=l,a+=u;const{style:d}=s;d.left=`${(100*o).toFixed(2)}%`,d.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!c(this,Os)&&(c(this,Os)[0]!==this.x||c(this,Os)[1]!==this.y)}get _hasBeenResized(){return!!c(this,Os)&&(c(this,Os)[2]!==this.width||c(this,Os)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=Ue,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:o,width:a,height:l}=this;if(a*=s,l*=i,r*=s,o*=i,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(s-a,r)),o=Math.max(0,Math.min(i-l,o));break;case 90:r=Math.max(0,Math.min(s-l,r)),o=Math.min(i,Math.max(a,o));break;case 180:r=Math.min(s,Math.max(a,r)),o=Math.min(i,Math.max(l,o));break;case 270:r=Math.min(s,Math.max(l,r)),o=Math.max(0,Math.min(i-a,o));break}this.x=r/=s,this.y=o/=i;const[u,d]=this.getBaseTranslation();r+=u,o+=d,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return x(s=Ue,gp,jE).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return x(s=Ue,gp,jE).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,c(this,ul)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),r=!c(this,ul)&&t.endsWith("%");if(i&&r)return;const[o,a]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/o).toFixed(2)}%`),!c(this,ul)&&!r&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}_onResizing(){}altTextFinish(){var e;(e=c(this,ft))==null||e.finish()}async addEditToolbar(){return this._editToolbar||c(this,fl)?this._editToolbar:(this._editToolbar=new CE(this),this.div.append(this._editToolbar.render()),c(this,ft)&&await this._editToolbar.addAltText(c(this,ft)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=c(this,ft))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){c(this,ft)||(m_.initialize(Ue._l10n),w(this,ft,new m_(this)),c(this,cl)&&(c(this,ft).data=c(this,cl),w(this,cl,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=c(this,ft))==null?void 0:e.data}set altTextData(e){c(this,ft)&&(c(this,ft).data=e)}get guessedAltText(){var e;return(e=c(this,ft))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=c(this,ft))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=c(this,ft))==null?void 0:t.serialize(e)}hasAltText(){return!!c(this,ft)&&!c(this,ft).isEmpty()}hasAltTextData(){var e;return((e=c(this,ft))==null?void 0:e.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=c(this,ku)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),x(this,ve,WE).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),g_(this,this.div,["pointerdown"]),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(e){const{isMac:t}=Wn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(w(this,dl,!0),this._isDraggable){x(this,ve,QN).call(this,e);return}x(this,ve,HE).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){c(this,ji)&&clearTimeout(c(this,ji)),w(this,ji,setTimeout(()=>{var e;w(this,ji,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,o]=this.pageDimensions,[a,l]=this.pageTranslation,u=e/i,d=t/i,f=this.x*r,p=this.y*o,m=this.width*r,y=this.height*o;switch(s){case 0:return[f+u+a,o-p-d-y+l,f+u+m+a,o-p-d+l];case 90:return[f+d+a,o-p+u+l,f+d+y+a,o-p+u+m+l];case 180:return[f-u-m+a,o-p+d+l,f-u+a,o-p+d+y+l];case 270:return[f-d-y+a,o-p-u-m+l,f-d+a,o-p-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,o]=e,a=r-s,l=o-i;switch(this.rotation){case 0:return[s,t-o,a,l];case 90:return[s,t-i,l,a];case 180:return[r,t-i,a,l];case 270:return[r,t-o,l,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){w(this,fl,!0)}disableEditMode(){w(this,fl,!1)}isInEditMode(){return c(this,fl)}shouldGetKeyboardEvents(){return c(this,Tr)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return t<o&&i>0&&e<r&&s>0}rebuild(){x(this,ve,WE).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Xe("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,w(i,cl,e.accessibilityData);const[r,o]=i.pageDimensions,[a,l,u,d]=i.getRectInCurrentCoords(e.rect,o);return i.x=a/r,i.y=l/o,i.width=u/r,i.height=d/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e;if((e=c(this,jo))==null||e.abort(),w(this,jo,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),c(this,ji)&&(clearTimeout(c(this,ji)),w(this,ji,null)),x(this,ve,Bd).call(this),this.removeEditToolbar(),c(this,Fs)){for(const t of c(this,Fs).values())clearTimeout(t);w(this,Fs,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(x(this,ve,XN).call(this),c(this,nn).classList.remove("hidden"),g_(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),w(this,Vo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=c(this,nn).children;if(!c(this,oi)){w(this,oi,Array.from(t));const o=x(this,ve,JN).bind(this),a=x(this,ve,ZN).bind(this),l=this._uiManager._signal;for(const u of c(this,oi)){const d=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:l}),u.addEventListener("blur",a,{signal:l}),u.addEventListener("focus",x(this,ve,eD).bind(this,d),{signal:l}),u.setAttribute("data-l10n-id",Ue._l10nResizer[d])}}const s=c(this,oi)[0];let i=0;for(const o of t){if(o===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(c(this,oi).length/4);if(r!==i){if(r<i)for(let a=0;a<i-r;a++)c(this,nn).append(c(this,nn).firstChild);else if(r>i)for(let a=0;a<r-i;a++)c(this,nn).firstChild.before(c(this,nn).lastChild);let o=0;for(const a of t){const u=c(this,oi)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",Ue._l10nResizer[u])}}x(this,ve,GE).call(this,0),w(this,Tr,!0),c(this,nn).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){c(this,Tr)&&x(this,ve,$E).call(this,c(this,dp),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){x(this,ve,Bd).call(this),this.div.focus()}select(){var e,t,s;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=c(this,ft))==null||s.toggleAltTextBadge(!1)}unselect(){var e,t,s,i,r;(e=c(this,nn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=c(this,ft))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return c(this,fp)}set isEditing(e){w(this,fp,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){w(this,ul,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){c(this,Fs)||w(this,Fs,new Map);const{action:s}=e;let i=c(this,Fs).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),c(this,Fs).delete(s),c(this,Fs).size===0&&w(this,Fs,null)},Ue._telemetryTimeout),c(this,Fs).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),w(this,ku,!1)}disable(){this.div&&(this.div.tabIndex=-1),w(this,ku,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};cl=new WeakMap,oi=new WeakMap,ft=new WeakMap,ku=new WeakMap,Fo=new WeakMap,hp=new WeakMap,ul=new WeakMap,nn=new WeakMap,hl=new WeakMap,Vo=new WeakMap,jo=new WeakMap,dp=new WeakMap,dl=new WeakMap,Os=new WeakMap,fp=new WeakMap,fl=new WeakMap,Tr=new WeakMap,ji=new WeakMap,Ru=new WeakMap,Pu=new WeakMap,Fs=new WeakMap,pp=new WeakMap,x_=new WeakMap,ve=new WeakSet,VE=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},gp=new WeakSet,jE=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},UE=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},XN=function(){if(c(this,nn))return;w(this,nn,document.createElement("div")),c(this,nn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");c(this,nn).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",x(this,ve,YN).bind(this,s),{signal:t}),i.addEventListener("contextmenu",Si,{signal:t}),i.tabIndex=-1}this.div.prepend(c(this,nn))},YN=function(e,t){var d;t.preventDefault();const{isMac:s}=Wn.platform;if(t.button!==0||t.ctrlKey&&s)return;(d=c(this,ft))==null||d.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,w(this,hl,[t.screenX,t.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",x(this,ve,$E).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",_i,{passive:!1,signal:o}),window.addEventListener("contextmenu",Si,{signal:o}),w(this,Vo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var f;r.abort(),this.parent.togglePointerEvents(!0),(f=c(this,ft))==null||f.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=a,this.div.style.cursor=l,x(this,ve,zE).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},BE=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[r,o]=this.parentDimensions;this.setDims(r*s,o*i),this.fixAndSetPosition(),this._onResized()},zE=function(){if(!c(this,Vo))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=c(this,Vo);w(this,Vo,null);const r=this.x,o=this.y,a=this.width,l=this.height;r===e&&o===t&&a===s&&l===i||this.addCommands({cmd:x(this,ve,BE).bind(this,r,o,a,l),undo:x(this,ve,BE).bind(this,e,t,s,i),mustExec:!0})},$E=function(e,t){const[s,i]=this.parentDimensions,r=this.x,o=this.y,a=this.width,l=this.height,u=Ue.MIN_SIZE/s,d=Ue.MIN_SIZE/i,f=Y=>Math.round(Y*1e4)/1e4,p=x(this,ve,UE).call(this,this.rotation),m=(Y,z)=>[p[0]*Y+p[2]*z,p[1]*Y+p[3]*z],y=x(this,ve,UE).call(this,360-this.rotation),E=(Y,z)=>[y[0]*Y+y[2]*z,y[1]*Y+y[3]*z];let k,v,A=!1,C=!1;switch(e){case"topLeft":A=!0,k=(Y,z)=>[0,0],v=(Y,z)=>[Y,z];break;case"topMiddle":k=(Y,z)=>[Y/2,0],v=(Y,z)=>[Y/2,z];break;case"topRight":A=!0,k=(Y,z)=>[Y,0],v=(Y,z)=>[0,z];break;case"middleRight":C=!0,k=(Y,z)=>[Y,z/2],v=(Y,z)=>[0,z/2];break;case"bottomRight":A=!0,k=(Y,z)=>[Y,z],v=(Y,z)=>[0,0];break;case"bottomMiddle":k=(Y,z)=>[Y/2,z],v=(Y,z)=>[Y/2,0];break;case"bottomLeft":A=!0,k=(Y,z)=>[0,z],v=(Y,z)=>[Y,0];break;case"middleLeft":C=!0,k=(Y,z)=>[0,z/2],v=(Y,z)=>[Y,z/2];break}const N=k(a,l),F=v(a,l);let V=m(...F);const S=f(r+V[0]),T=f(o+V[1]);let P=1,D=1,M,O;if(t.fromKeyboard)({deltaX:M,deltaY:O}=t);else{const{screenX:Y,screenY:z}=t,[$,q]=c(this,hl);[M,O]=this.screenToPageTranslation(Y-$,z-q),c(this,hl)[0]=Y,c(this,hl)[1]=z}if([M,O]=E(M/s,O/i),A){const Y=Math.hypot(a,l);P=D=Math.max(Math.min(Math.hypot(F[0]-N[0]-M,F[1]-N[1]-O)/Y,1/a,1/l),u/a,d/l)}else C?P=Math.max(u,Math.min(1,Math.abs(F[0]-N[0]-M)))/a:D=Math.max(d,Math.min(1,Math.abs(F[1]-N[1]-O)))/l;const L=f(a*P),ne=f(l*D);V=m(...v(L,ne));const Ne=S-V[0],de=T-V[1];c(this,Os)||w(this,Os,[this.x,this.y,this.width,this.height]),this.width=L,this.height=ne,this.x=Ne,this.y=de,this.setDims(s*L,i*ne),this.fixAndSetPosition(),this._onResizing()},HE=function(e){const{isMac:t}=Wn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},QN=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();const s=new AbortController,i=this._uiManager.combinedSignal(s),r={capture:!0,passive:!1,signal:i},o=l=>{s.abort(),w(this,Fo,null),w(this,dl,!1),this._uiManager.endDragSession()||x(this,ve,HE).call(this,l)};t&&(w(this,Ru,e.clientX),w(this,Pu,e.clientY),w(this,Fo,e.pointerId),w(this,hp,e.pointerType),window.addEventListener("pointermove",l=>{const{clientX:u,clientY:d,pointerId:f}=l;if(f!==c(this,Fo)){_i(l);return}const[p,m]=this.screenToPageTranslation(u-c(this,Ru),d-c(this,Pu));w(this,Ru,u),w(this,Pu,d),this._uiManager.dragSelectedEditors(p,m)},r),window.addEventListener("touchmove",_i,r),window.addEventListener("pointerdown",l=>{l.isPrimary&&l.pointerType===c(this,hp)&&o(l),_i(l)},r)),this._onStartDragging();const a=l=>{if(!c(this,Fo)||c(this,Fo)===l.pointerId){o(l),this._onStopDragging();return}_i(l)};window.addEventListener("pointerup",a,{signal:i}),window.addEventListener("blur",a,{signal:i})},WE=function(){if(c(this,jo)||!this.div)return;w(this,jo,new AbortController);const e=this._uiManager.combinedSignal(c(this,jo));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},JN=function(e){Ue._resizerKeyboardManager.exec(this,e)},ZN=function(e){var t;c(this,Tr)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==c(this,nn)&&x(this,ve,Bd).call(this)},eD=function(e){w(this,dp,c(this,Tr)?e:"")},GE=function(e){if(c(this,oi))for(const t of c(this,oi))t.tabIndex=e},Bd=function(){w(this,Tr,!1),x(this,ve,GE).call(this,-1),x(this,ve,zE).call(this)},I(Ue,gp),ue(Ue,"_l10n",null),ue(Ue,"_l10nResizer",null),ue(Ue,"_borderLineWidth",-1),ue(Ue,"_colorManager",new PE),ue(Ue,"_zIndex",1),ue(Ue,"_telemetryTimeout",1e3);let mt=Ue;class C6 extends mt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const AI=3285377520,Ps=4294901760,Ci=65535;class tD{constructor(e){this.h1=e?e&4294967295:AI,this.h2=e?e&4294967295:AI}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let E=0,k=e.length;E<k;E++){const v=e.charCodeAt(E);v<=255?t[s++]=v:(t[s++]=v>>>8,t[s++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,o=new Uint32Array(t.buffer,0,i);let a=0,l=0,u=this.h1,d=this.h2;const f=3432918353,p=461845907,m=f&Ci,y=p&Ci;for(let E=0;E<i;E++)E&1?(a=o[E],a=a*f&Ps|a*m&Ci,a=a<<15|a>>>17,a=a*p&Ps|a*y&Ci,u^=a,u=u<<13|u>>>19,u=u*5+3864292196):(l=o[E],l=l*f&Ps|l*m&Ci,l=l<<15|l>>>17,l=l*p&Ps|l*y&Ci,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,r){case 3:a^=t[i*4+2]<<16;case 2:a^=t[i*4+1]<<8;case 1:a^=t[i*4],a=a*f&Ps|a*m&Ci,a=a<<15|a>>>17,a=a*p&Ps|a*y&Ci,i&1?u^=a:d^=a}this.h1=u,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Ps|e*36045&Ci,t=t*4283543511&Ps|((t<<16|e>>>16)*2950163797&Ps)>>>16,e^=t>>>1,e=e*444984403&Ps|e*60499&Ci,t=t*3301882366&Ps|((t<<16|e>>>16)*3120437893&Ps)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const qE=Object.freeze({map:null,hash:"",transfer:void 0});var pl,gl,Kt,I_,nD;class BT{constructor(){I(this,I_);I(this,pl,!1);I(this,gl,null);I(this,Kt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=c(this,Kt).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return c(this,Kt).get(e)}remove(e){if(c(this,Kt).delete(e),c(this,Kt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of c(this,Kt).values())if(t instanceof mt)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=c(this,Kt).get(e);let i=!1;if(s!==void 0)for(const[r,o]of Object.entries(t))s[r]!==o&&(i=!0,s[r]=o);else i=!0,c(this,Kt).set(e,t);i&&x(this,I_,nD).call(this),t instanceof mt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return c(this,Kt).has(e)}getAll(){return c(this,Kt).size>0?MT(c(this,Kt)):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return c(this,Kt).size}resetModified(){c(this,pl)&&(w(this,pl,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new sD(this)}get serializable(){if(c(this,Kt).size===0)return qE;const e=new Map,t=new tD,s=[],i=Object.create(null);let r=!1;for(const[o,a]of c(this,Kt)){const l=a instanceof mt?a.serialize(!1,i):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const o of e.values())o.bitmap&&s.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:qE}get editorStats(){let e=null;const t=new Map;for(const s of c(this,Kt).values()){if(!(s instanceof mt))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const o=e[r]||(e[r]=new Map);for(const[a,l]of Object.entries(i)){if(a==="type")continue;let u=o.get(a);u||(u=new Map,o.set(a,u));const d=u.get(l)??0;u.set(l,d+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){w(this,gl,null)}get modifiedIds(){if(c(this,gl))return c(this,gl);const e=[];for(const t of c(this,Kt).values())!(t instanceof mt)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return w(this,gl,{ids:new Set(e),hash:e.join(",")})}}pl=new WeakMap,gl=new WeakMap,Kt=new WeakMap,I_=new WeakSet,nD=function(){c(this,pl)||(w(this,pl,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var mp;class sD extends BT{constructor(t){super();I(this,mp);const{map:s,hash:i,transfer:r}=t.serializable,o=structuredClone(s,r?{transfer:r}:null);w(this,mp,{map:o,hash:i,transfer:r})}get print(){Xe("Should not call PrintAnnotationStorage.print")}get serializable(){return c(this,mp)}get modifiedIds(){return xe(this,"modifiedIds",{ids:new Set,hash:""})}}mp=new WeakMap;var Nu;class k6{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){I(this,Nu,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),c(this,Nu).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||c(this,Nu).has(e.loadedName))){if(Dt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:r}=e,o=new FontFace(s,i,r);this.addNativeFontFace(o);try{await o.load(),c(this,Nu).add(s),t==null||t(e)}catch{Te(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Xe("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw Te(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return xe(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Bn||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),xe(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Dt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return xe(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(N,F){return N.charCodeAt(F)<<24|N.charCodeAt(F+1)<<16|N.charCodeAt(F+2)<<8|N.charCodeAt(F+3)&255}function i(N,F,V,S){const T=N.substring(0,F),P=N.substring(F+V);return T+S+P}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let u=0;function d(N,F){if(++u>30){Te("Load test font never loaded."),F();return}if(l.font="30px "+N,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){F();return}setTimeout(d.bind(null,N,F))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=i(p,976,f.length,f);const y=16,E=1482184792;let k=s(p,y);for(r=0,o=f.length-3;r<o;r+=4)k=k-E+s(f,r)|0;r<f.length&&(k=k-E+s(f+"XXX",r)|0),p=i(p,y,4,p6(k));const v=`url(data:font/opentype;base64,${btoa(p)});`,A=`@font-face {font-family:"${f}";src:${v}}`;this.insertRule(A);const C=this._document.createElement("div");C.style.visibility="hidden",C.style.width=C.style.height="10px",C.style.position="absolute",C.style.top=C.style.left="0px";for(const N of[e.loadedName,f]){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=N,C.append(F)}this._document.body.append(C),d(f,()=>{C.remove(),t.complete()})}}Nu=new WeakMap;class R6{constructor(e,{disableFontFace:t=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this.disableFontFace=t===!0,this._inspectFont=s}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${w6(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let s;try{s=e.get(this.loadedName+"_path_"+t)}catch(r){Te(`getPathGenerator - ignoring character: "${r}".`)}if(!Array.isArray(s)||s.length===0)return this.compiledGlyphs[t]=function(r,o){};const i=[];for(let r=0,o=s.length;r<o;)switch(s[r++]){case dr.BEZIER_CURVE_TO:{const[a,l,u,d,f,p]=s.slice(r,r+6);i.push(m=>m.bezierCurveTo(a,l,u,d,f,p)),r+=6}break;case dr.MOVE_TO:{const[a,l]=s.slice(r,r+2);i.push(u=>u.moveTo(a,l)),r+=2}break;case dr.LINE_TO:{const[a,l]=s.slice(r,r+2);i.push(u=>u.lineTo(a,l)),r+=2}break;case dr.QUADRATIC_CURVE_TO:{const[a,l,u,d]=s.slice(r,r+4);i.push(f=>f.quadraticCurveTo(a,l,u,d)),r+=4}break;case dr.RESTORE:i.push(a=>a.restore());break;case dr.SAVE:i.push(a=>a.save());break;case dr.SCALE:Dt(i.length===2,"Scale command is only valid at the third position.");break;case dr.TRANSFORM:{const[a,l,u,d,f,p]=s.slice(r,r+6);i.push(m=>m.transform(a,l,u,d,f,p)),r+=6}break;case dr.TRANSLATE:{const[a,l]=s.slice(r,r+2);i.push(u=>u.translate(a,l)),r+=2}break}return i.push(r=>r.closePath()),this.compiledGlyphs[t]=function(o,a){i[0](o),i[1](o),o.scale(a,-a);for(let l=2,u=i.length;l<u;l++)i[l](o)}}}var yp;class iD{constructor({enableHWA:e=!1}){I(this,yp,!1);w(this,yp,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!c(this,yp)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Xe("Abstract method `_createCanvas` called.")}}yp=new WeakMap;class P6 extends iD{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class rD{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Xe("Abstract method `_fetch` called.")}}class oD extends rD{async _fetch(e){const t=await Pv(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Rv(t)}}class aD{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var ml,Du,Sr,xr,Tn,yl,_l,Z,En,zd,Fc,oy,Vc,lD,KE,jc,$d,Hd,XE,Wd;class N6 extends aD{constructor({docId:t,ownerDocument:s=globalThis.document}){super();I(this,Z);I(this,ml);I(this,Du);I(this,Sr);I(this,xr);I(this,Tn);I(this,yl);I(this,_l,0);w(this,xr,t),w(this,Tn,s)}addFilter(t){if(!t)return"none";let s=c(this,Z,En).get(t);if(s)return s;const[i,r,o]=x(this,Z,oy).call(this,t),a=t.length===1?i:`${i}${r}${o}`;if(s=c(this,Z,En).get(a),s)return c(this,Z,En).set(t,s),s;const l=`g_${c(this,xr)}_transfer_map_${Ln(this,_l)._++}`,u=x(this,Z,Vc).call(this,l);c(this,Z,En).set(t,u),c(this,Z,En).set(a,u);const d=x(this,Z,jc).call(this,l);return x(this,Z,Hd).call(this,i,r,o,d),u}addHCMFilter(t,s){var y;const i=`${t}-${s}`,r="base";let o=c(this,Z,zd).get(r);if((o==null?void 0:o.key)===i||(o?((y=o.filter)==null||y.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},c(this,Z,zd).set(r,o)),!t||!s))return o.url;const a=x(this,Z,Wd).call(this,t);t=le.makeHexColor(...a);const l=x(this,Z,Wd).call(this,s);if(s=le.makeHexColor(...l),c(this,Z,Fc).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return o.url;const u=new Array(256);for(let E=0;E<=255;E++){const k=E/255;u[E]=k<=.03928?k/12.92:((k+.055)/1.055)**2.4}const d=u.join(","),f=`g_${c(this,xr)}_hcm_filter`,p=o.filter=x(this,Z,jc).call(this,f);x(this,Z,Hd).call(this,d,d,d,p),x(this,Z,KE).call(this,p);const m=(E,k)=>{const v=a[E]/255,A=l[E]/255,C=new Array(k+1);for(let N=0;N<=k;N++)C[N]=v+N/k*(A-v);return C.join(",")};return x(this,Z,Hd).call(this,m(0,5),m(1,5),m(2,5),p),o.url=x(this,Z,Vc).call(this,f),o.url}addAlphaFilter(t){let s=c(this,Z,En).get(t);if(s)return s;const[i]=x(this,Z,oy).call(this,[t]),r=`alpha_${i}`;if(s=c(this,Z,En).get(r),s)return c(this,Z,En).set(t,s),s;const o=`g_${c(this,xr)}_alpha_map_${Ln(this,_l)._++}`,a=x(this,Z,Vc).call(this,o);c(this,Z,En).set(t,a),c(this,Z,En).set(r,a);const l=x(this,Z,jc).call(this,o);return x(this,Z,XE).call(this,i,l),a}addLuminosityFilter(t){let s=c(this,Z,En).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=x(this,Z,oy).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=c(this,Z,En).get(r),s)return c(this,Z,En).set(t,s),s;const o=`g_${c(this,xr)}_luminosity_map_${Ln(this,_l)._++}`,a=x(this,Z,Vc).call(this,o);c(this,Z,En).set(t,a),c(this,Z,En).set(r,a);const l=x(this,Z,jc).call(this,o);return x(this,Z,lD).call(this,l),t&&x(this,Z,XE).call(this,i,l),a}addHighlightHCMFilter(t,s,i,r,o){var A;const a=`${s}-${i}-${r}-${o}`;let l=c(this,Z,zd).get(t);if((l==null?void 0:l.key)===a||(l?((A=l.filter)==null||A.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},c(this,Z,zd).set(t,l)),!s||!i))return l.url;const[u,d]=[s,i].map(x(this,Z,Wd).bind(this));let f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[m,y]=[r,o].map(x(this,Z,Wd).bind(this));p<f&&([f,p,m,y]=[p,f,y,m]),c(this,Z,Fc).style.color="";const E=(C,N,F)=>{const V=new Array(256),S=(p-f)/F,T=C/255,P=(N-C)/(255*F);let D=0;for(let M=0;M<=F;M++){const O=Math.round(f+M*S),L=T+M*P;for(let ne=D;ne<=O;ne++)V[ne]=L;D=O+1}for(let M=D;M<256;M++)V[M]=V[D-1];return V.join(",")},k=`g_${c(this,xr)}_hcm_${t}_filter`,v=l.filter=x(this,Z,jc).call(this,k);return x(this,Z,KE).call(this,v),x(this,Z,Hd).call(this,E(m[0],y[0],5),E(m[1],y[1],5),E(m[2],y[2],5),v),l.url=x(this,Z,Vc).call(this,k),l.url}destroy(t=!1){var s,i,r,o;t&&((s=c(this,yl))!=null&&s.size)||((i=c(this,Sr))==null||i.parentNode.parentNode.remove(),w(this,Sr,null),(r=c(this,Du))==null||r.clear(),w(this,Du,null),(o=c(this,yl))==null||o.clear(),w(this,yl,null),w(this,_l,0))}}ml=new WeakMap,Du=new WeakMap,Sr=new WeakMap,xr=new WeakMap,Tn=new WeakMap,yl=new WeakMap,_l=new WeakMap,Z=new WeakSet,En=function(){return c(this,Du)||w(this,Du,new Map)},zd=function(){return c(this,yl)||w(this,yl,new Map)},Fc=function(){if(!c(this,Sr)){const t=c(this,Tn).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=c(this,Tn).createElementNS(fr,"svg");i.setAttribute("width",0),i.setAttribute("height",0),w(this,Sr,c(this,Tn).createElementNS(fr,"defs")),t.append(i),i.append(c(this,Sr)),c(this,Tn).body.append(t)}return c(this,Sr)},oy=function(t){if(t.length===1){const u=t[0],d=new Array(256);for(let p=0;p<256;p++)d[p]=u[p]/255;const f=d.join(",");return[f,f,f]}const[s,i,r]=t,o=new Array(256),a=new Array(256),l=new Array(256);for(let u=0;u<256;u++)o[u]=s[u]/255,a[u]=i[u]/255,l[u]=r[u]/255;return[o.join(","),a.join(","),l.join(",")]},Vc=function(t){if(c(this,ml)===void 0){w(this,ml,"");const s=c(this,Tn).URL;s!==c(this,Tn).baseURI&&(Nv(s)?Te('#createUrl: ignore "data:"-URL for performance reasons.'):w(this,ml,s.split("#",1)[0]))}return`url(${c(this,ml)}#${t})`},lD=function(t){const s=c(this,Tn).createElementNS(fr,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},KE=function(t){const s=c(this,Tn).createElementNS(fr,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},jc=function(t){const s=c(this,Tn).createElementNS(fr,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),c(this,Z,Fc).append(s),s},$d=function(t,s,i){const r=c(this,Tn).createElementNS(fr,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},Hd=function(t,s,i,r){const o=c(this,Tn).createElementNS(fr,"feComponentTransfer");r.append(o),x(this,Z,$d).call(this,o,"feFuncR",t),x(this,Z,$d).call(this,o,"feFuncG",s),x(this,Z,$d).call(this,o,"feFuncB",i)},XE=function(t,s){const i=c(this,Tn).createElementNS(fr,"feComponentTransfer");s.append(i),x(this,Z,$d).call(this,i,"feFuncA",t)},Wd=function(t){return c(this,Z,Fc).style.color=t,UT(getComputedStyle(c(this,Z,Fc)).getPropertyValue("color"))};class cD{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Xe("Abstract method `_fetch` called.")}}class uD extends cD{async _fetch(e){const t=await Pv(e,"arraybuffer");return new Uint8Array(t)}}async function hD(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class D6 extends aD{}class L6 extends iD{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class M6 extends rD{async _fetch(e){return hD(e)}}class O6 extends cD{async _fetch(e){return hD(e)}}const Cn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function YE(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class zT{getPattern(){Xe("Abstract method `getPattern` called.")}}class F6 extends zT{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Cn.STROKE||i===Cn.FILL){const o=t.current.getClippedPathBoundingBox(i,at(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",a,l),d=u.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-o[0],-o[1]),s=le.transform(s,[1,0,0,1,o[0],o[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),YE(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),r=e.createPattern(u.canvas,"no-repeat");const f=new DOMMatrix(s);r.setTransform(f)}else YE(e,this._bbox),r=this._createGradient(e);return r}}function Qw(n,e,t,s,i,r,o,a){const l=e.coords,u=e.colors,d=n.data,f=n.width*4;let p;l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=r,r=o,o=p),l[s+1]>l[i+1]&&(p=s,s=i,i=p,p=o,o=a,a=p),l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=r,r=o,o=p);const m=(l[t]+e.offsetX)*e.scaleX,y=(l[t+1]+e.offsetY)*e.scaleY,E=(l[s]+e.offsetX)*e.scaleX,k=(l[s+1]+e.offsetY)*e.scaleY,v=(l[i]+e.offsetX)*e.scaleX,A=(l[i+1]+e.offsetY)*e.scaleY;if(y>=A)return;const C=u[r],N=u[r+1],F=u[r+2],V=u[o],S=u[o+1],T=u[o+2],P=u[a],D=u[a+1],M=u[a+2],O=Math.round(y),L=Math.round(A);let ne,Ne,de,Y,z,$,q,oe;for(let se=O;se<=L;se++){if(se<k){const be=se<y?0:(y-se)/(y-k);ne=m-(m-E)*be,Ne=C-(C-V)*be,de=N-(N-S)*be,Y=F-(F-T)*be}else{let be;se>A?be=1:k===A?be=0:be=(k-se)/(k-A),ne=E-(E-v)*be,Ne=V-(V-P)*be,de=S-(S-D)*be,Y=T-(T-M)*be}let J;se<y?J=0:se>A?J=1:J=(y-se)/(y-A),z=m-(m-v)*J,$=C-(C-P)*J,q=N-(N-D)*J,oe=F-(F-M)*J;const Ge=Math.round(Math.min(ne,z)),_e=Math.round(Math.max(ne,z));let Be=f*se+Ge*4;for(let be=Ge;be<=_e;be++)J=(ne-be)/(ne-z),J<0?J=0:J>1&&(J=1),d[Be++]=Ne-(Ne-$)*J|0,d[Be++]=de-(de-q)*J|0,d[Be++]=Y-(Y-oe)*J|0,d[Be++]=255}}function V6(n,e,t){const s=e.coords,i=e.colors;let r,o;switch(e.type){case"lattice":const a=e.verticesPerRow,l=Math.floor(s.length/a)-1,u=a-1;for(r=0;r<l;r++){let d=r*a;for(let f=0;f<u;f++,d++)Qw(n,t,s[d],s[d+1],s[d+a],i[d],i[d+1],i[d+a]),Qw(n,t,s[d+a+1],s[d+1],s[d+a],i[d+a+1],i[d+1],i[d+a])}break;case"triangles":for(r=0,o=s.length;r<o;r+=3)Qw(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class j6 extends zT{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),m=u/f,y=d/p,E={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/m,scaleY:1/y},k=f+2*2,v=p+2*2,A=s.getCanvas("mesh",k,v),C=A.context,N=C.createImageData(f,p);if(t){const V=N.data;for(let S=0,T=V.length;S<T;S+=4)V[S]=t[0],V[S+1]=t[1],V[S+2]=t[2],V[S+3]=255}for(const V of this._figures)V6(N,V,E);return C.putImageData(N,2,2),{canvas:A.canvas,offsetX:a-2*m,offsetY:l-2*y,scaleX:m,scaleY:y}}getPattern(e,t,s,i){YE(e,this._bbox);let r;if(i===Cn.SHADING)r=le.singularValueDecompose2dScale(at(e));else if(r=le.singularValueDecompose2dScale(t.baseTransform),this.matrix){const a=le.singularValueDecompose2dScale(this.matrix);r=[r[0]*a[0],r[1]*a[1]]}const o=this._createMeshCanvas(r,i===Cn.SHADING?null:this._background,t.cachedCanvases);return i!==Cn.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class U6 extends zT{getPattern(){return"hotpink"}}function B6(n){switch(n[0]){case"RadialAxial":return new F6(n);case"Mesh":return new j6(n);case"Dummy":return new U6}throw new Error(`Unknown IR type: ${n[0]}`)}const bI={COLORED:1,UNCOLORED:2},C_=class C_{constructor(e,t,s,i,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:r,color:o,canvasGraphicsFactory:a}=this;let{xstep:l,ystep:u}=this;l=Math.abs(l),u=Math.abs(u),Cv("TilingType: "+r);const d=t[0],f=t[1],p=t[2],m=t[3],y=p-d,E=m-f,k=le.singularValueDecompose2dScale(this.matrix),v=le.singularValueDecompose2dScale(this.baseTransform),A=k[0]*v[0],C=k[1]*v[1];let N=y,F=E,V=!1,S=!1;const T=Math.ceil(l*A),P=Math.ceil(u*C),D=Math.ceil(y*A),M=Math.ceil(E*C);T>=D?N=l:V=!0,P>=M?F=u:S=!0;const O=this.getSizeAndScale(N,this.ctx.canvas.width,A),L=this.getSizeAndScale(F,this.ctx.canvas.height,C),ne=e.cachedCanvases.getCanvas("pattern",O.size,L.size),Ne=ne.context,de=a.createCanvasGraphics(Ne);if(de.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(de,i,o),Ne.translate(-O.scale*d,-L.scale*f),de.transform(O.scale,0,0,L.scale,0,0),Ne.save(),this.clipBbox(de,d,f,p,m),de.baseTransform=at(de.ctx),de.executeOperatorList(s),de.endDrawing(),Ne.restore(),V||S){const Y=ne.canvas;V&&(N=l),S&&(F=u);const z=this.getSizeAndScale(N,this.ctx.canvas.width,A),$=this.getSizeAndScale(F,this.ctx.canvas.height,C),q=z.size,oe=$.size,se=e.cachedCanvases.getCanvas("pattern-workaround",q,oe),J=se.context,Ge=V?Math.floor(y/l):0,_e=S?Math.floor(E/u):0;for(let Be=0;Be<=Ge;Be++)for(let be=0;be<=_e;be++)J.drawImage(Y,q*Be,oe*be,q,oe,0,0,q,oe);return{canvas:se.canvas,scaleX:z.scale,scaleY:$.scale,offsetX:d,offsetY:f}}return{canvas:ne.canvas,scaleX:O.scale,scaleY:L.scale,offsetX:d,offsetY:f}}getSizeAndScale(e,t,s){const i=Math.max(C_.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const o=i-t,a=r-s;e.ctx.rect(t,s,o,a),e.current.updateRectMinMax(at(e.ctx),[t,s,i,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case bI.COLORED:const o=this.ctx;i.fillStyle=o.fillStyle,i.strokeStyle=o.strokeStyle,r.fillColor=o.fillStyle,r.strokeColor=o.strokeStyle;break;case bI.UNCOLORED:const a=le.makeHexColor(s[0],s[1],s[2]);i.fillStyle=a,i.strokeStyle=a,r.fillColor=a,r.strokeColor=a;break;default:throw new f6(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,i){let r=s;i!==Cn.SHADING&&(r=le.transform(r,t.baseTransform),this.matrix&&(r=le.transform(r,this.matrix)));const o=this.createPatternCanvas(t);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const l=e.createPattern(o.canvas,"repeat");return l.setTransform(a),l}};ue(C_,"MAX_PATTERN_SIZE",3e3);let QE=C_;function z6({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=Wn.isLittleEndian?4278190080:255,[l,u]=o?[r,a]:[a,r],d=s>>3,f=s&7,p=n.length;t=new Uint32Array(t.buffer);let m=0;for(let y=0;y<i;y++){for(const k=e+d;e<k;e++){const v=e<p?n[e]:255;t[m++]=v&128?u:l,t[m++]=v&64?u:l,t[m++]=v&32?u:l,t[m++]=v&16?u:l,t[m++]=v&8?u:l,t[m++]=v&4?u:l,t[m++]=v&2?u:l,t[m++]=v&1?u:l}if(f===0)continue;const E=e<p?n[e++]:255;for(let k=0;k<f;k++)t[m++]=E&1<<7-k?u:l}return{srcPos:e,destPos:m}}const TI=16,SI=100,$6=15,xI=10,II=1e3,ns=16;function H6(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(s,i){e.translate(s,i),this.__originalTranslate(s,i)},n.scale=function(s,i){e.scale(s,i),this.__originalScale(s,i)},n.transform=function(s,i,r,o,a,l){e.transform(s,i,r,o,a,l),this.__originalTransform(s,i,r,o,a,l)},n.setTransform=function(s,i,r,o,a,l){e.setTransform(s,i,r,o,a,l),this.__originalSetTransform(s,i,r,o,a,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(s){e.rotate(s),this.__originalRotate(s)},n.clip=function(s){e.clip(s),this.__originalClip(s)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,o,a){e.bezierCurveTo(t,s,i,r,o,a),this.__originalBezierCurveTo(t,s,i,r,o,a)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class W6{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Im(n,e,t,s,i,r,o,a,l,u){const[d,f,p,m,y,E]=at(n);if(f===0&&p===0){const A=o*d+y,C=Math.round(A),N=a*m+E,F=Math.round(N),V=(o+l)*d+y,S=Math.abs(Math.round(V)-C)||1,T=(a+u)*m+E,P=Math.abs(Math.round(T)-F)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(m),C,F),n.drawImage(e,t,s,i,r,0,0,S,P),n.setTransform(d,f,p,m,y,E),[S,P]}if(d===0&&m===0){const A=a*p+y,C=Math.round(A),N=o*f+E,F=Math.round(N),V=(a+u)*p+y,S=Math.abs(Math.round(V)-C)||1,T=(o+l)*f+E,P=Math.abs(Math.round(T)-F)||1;return n.setTransform(0,Math.sign(f),Math.sign(p),0,C,F),n.drawImage(e,t,s,i,r,0,0,P,S),n.setTransform(d,f,p,m,y,E),[P,S]}n.drawImage(e,t,s,i,r,o,a,l,u);const k=Math.hypot(d,f),v=Math.hypot(p,m);return[k*l,v*u]}function G6(n){const{width:e,height:t}=n;if(e>II||t>II)return null;const s=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let o=new Uint8Array(r*(t+1)),a,l,u;const d=e+7&-8;let f=new Uint8Array(d*t),p=0;for(const v of n.data){let A=128;for(;A>0;)f[p++]=v&A?0:255,A>>=1}let m=0;for(p=0,f[p]!==0&&(o[0]=1,++m),l=1;l<e;l++)f[p]!==f[p+1]&&(o[l]=f[p]?2:1,++m),p++;for(f[p]!==0&&(o[l]=2,++m),a=1;a<t;a++){p=a*d,u=a*r,f[p-d]!==f[p]&&(o[u]=f[p]?1:8,++m);let v=(f[p]?4:0)+(f[p-d]?8:0);for(l=1;l<e;l++)v=(v>>2)+(f[p+1]?4:0)+(f[p-d+1]?8:0),i[v]&&(o[u+l]=i[v],++m),p++;if(f[p-d]!==f[p]&&(o[u+l]=f[p]?2:4,++m),m>s)return null}for(p=d*(t-1),u=a*r,f[p]!==0&&(o[u]=8,++m),l=1;l<e;l++)f[p]!==f[p+1]&&(o[u+l]=f[p]?4:8,++m),p++;if(f[p]!==0&&(o[u+l]=4,++m),m>s)return null;const y=new Int32Array([0,r,-1,0,-r,0,0,0,1]),E=new Path2D;for(a=0;m&&a<=t;a++){let v=a*r;const A=v+e;for(;v<A&&!o[v];)v++;if(v===A)continue;E.moveTo(v%r,a);const C=v;let N=o[v];do{const F=y[N];do v+=F;while(!o[v]);const V=o[v];V!==5&&V!==10?(N=V,o[v]=0):(N=V&51*N>>4,o[v]&=N>>2|N<<2),E.lineTo(v%r,v/r|0),o[v]||--m}while(C!==v);--a}return f=null,o=null,function(v){v.save(),v.scale(1/e,-1/t),v.translate(0,-t),v.fill(E),v.beginPath(),v.restore()}}class CI{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=CN,this.textMatrixScale=1,this.fontMatrix=bE,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=wn.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=le.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=le.applyTransform(t,e),i=le.applyTransform(t.slice(2),e),r=le.applyTransform([t[0],t[3]],e),o=le.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],i[0],r[0],o[0]),this.minY=Math.min(this.minY,s[1],i[1],r[1],o[1]),this.maxX=Math.max(this.maxX,s[0],i[0],r[0],o[0]),this.maxY=Math.max(this.maxY,s[1],i[1],r[1],o[1])}updateScalingPathMinMax(e,t){le.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,r,o,a,l,u,d){const f=le.bezierBoundingBox(t,s,i,r,o,a,l,u,d);d||this.updateRectMinMax(e,f)}getPathBoundingBox(e=Cn.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Cn.STROKE){t||Xe("Stroke bounding box must include transform.");const i=le.singularValueDecompose2dScale(t),r=i[0]*this.lineWidth/2,o=i[1]*this.lineWidth/2;s[0]-=r,s[1]-=o,s[2]+=r,s[3]+=o}return s}updateClipFromPath(){const e=le.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Cn.FILL,t=null){return le.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function kI(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%ns,r=(t-i)/ns,o=i===0?r:r+1,a=n.createImageData(s,ns);let l=0,u;const d=e.data,f=a.data;let p,m,y,E;if(e.kind===Zm.GRAYSCALE_1BPP){const k=d.byteLength,v=new Uint32Array(f.buffer,0,f.byteLength>>2),A=v.length,C=s+7>>3,N=4294967295,F=Wn.isLittleEndian?4278190080:255;for(p=0;p<o;p++){for(y=p<r?ns:i,u=0,m=0;m<y;m++){const V=k-l;let S=0;const T=V>C?s:V*8-7,P=T&-8;let D=0,M=0;for(;S<P;S+=8)M=d[l++],v[u++]=M&128?N:F,v[u++]=M&64?N:F,v[u++]=M&32?N:F,v[u++]=M&16?N:F,v[u++]=M&8?N:F,v[u++]=M&4?N:F,v[u++]=M&2?N:F,v[u++]=M&1?N:F;for(;S<T;S++)D===0&&(M=d[l++],D=128),v[u++]=M&D?N:F,D>>=1}for(;u<A;)v[u++]=0;n.putImageData(a,0,p*ns)}}else if(e.kind===Zm.RGBA_32BPP){for(m=0,E=s*ns*4,p=0;p<r;p++)f.set(d.subarray(l,l+E)),l+=E,n.putImageData(a,0,m),m+=ns;p<o&&(E=s*i*4,f.set(d.subarray(l,l+E)),n.putImageData(a,0,m))}else if(e.kind===Zm.RGB_24BPP)for(y=ns,E=s*y,p=0;p<o;p++){for(p>=r&&(y=i,E=s*y),u=0,m=E;m--;)f[u++]=d[l++],f[u++]=d[l++],f[u++]=d[l++],f[u++]=255;n.putImageData(a,0,p*ns)}else throw new Error(`bad image kind: ${e.kind}`)}function RI(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%ns,r=(t-i)/ns,o=i===0?r:r+1,a=n.createImageData(s,ns);let l=0;const u=e.data,d=a.data;for(let f=0;f<o;f++){const p=f<r?ns:i;({srcPos:l}=z6({src:u,srcPos:l,dest:d,width:s,height:p,nonBlackColor:0})),n.putImageData(a,0,f*ns)}}function xd(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Cm(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Bn){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function PI(n,e){if(e)return!0;const t=le.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*Ta.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const q6=["butt","round","square"],K6=["miter","round","bevel"],X6={},NI={};var xa,JE,ZE;const GT=class GT{constructor(e,t,s,i,r,{optionalContentConfig:o,markedContentStack:a=null},l,u){I(this,xa);this.ctx=e,this.current=new CI(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new W6(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,s){const l=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...at(this.compositeCtx))}this.ctx.save(),Cm(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=at(this.ctx)}executeOperatorList(e,t,s,i){const r=e.argsArray,o=e.fnArray;let a=t||0;const l=r.length;if(l===a)return a;const u=l-a>xI&&typeof s=="function",d=u?Date.now()+$6:0;let f=0;const p=this.commonObjs,m=this.objs;let y;for(;;){if(i!==void 0&&a===i.nextBreakPoint)return i.breakIt(a,s),a;if(y=o[a],y!==ni.dependency)this[y].apply(this,r[a]);else for(const E of r[a]){const k=E.startsWith("g_")?p:m;if(!k.has(E))return k.get(E,s),a}if(a++,a===l)return a;if(u&&++f>xI){if(Date.now()>d)return s(),a;f=0}}}endDrawing(){x(this,xa,JE).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),x(this,xa,ZE).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=s,l=i,u="prescale1",d,f;for(;r>2&&a>1||o>2&&l>1;){let p=a,m=l;r>2&&a>1&&(p=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/p),o>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/m),d=this.cachedCanvases.getCanvas(u,p,m),f=d.context,f.clearRect(0,0,p,m),f.drawImage(e,0,0,a,l,0,0,p,m),e=d.canvas,a=p,l=m,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,r=this.current.fillColor,o=this.current.patternFill,a=at(t);let l,u,d,f;if((e.bitmap||e.data)&&e.count>1){const T=e.bitmap||e.data.buffer;u=JSON.stringify(o?a:[a.slice(0,4),r]),l=this._cachedBitmapsMap.get(T),l||(l=new Map,this._cachedBitmapsMap.set(T,l));const P=l.get(u);if(P&&!o){const D=Math.round(Math.min(a[0],a[2])+a[4]),M=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:P,offsetX:D,offsetY:M}}d=P}d||(f=this.cachedCanvases.getCanvas("maskCanvas",s,i),RI(f.context,e));let p=le.transform(a,[1/s,0,0,-1/i,0,0]);p=le.transform(p,[1,0,0,1,0,-i]);const[m,y,E,k]=le.getAxialAlignedBoundingBox([0,0,s,i],p),v=Math.round(E-m)||1,A=Math.round(k-y)||1,C=this.cachedCanvases.getCanvas("fillCanvas",v,A),N=C.context,F=m,V=y;N.translate(-F,-V),N.transform(...p),d||(d=this._scaleImage(f.canvas,Ii(N)),d=d.img,l&&o&&l.set(u,d)),N.imageSmoothingEnabled=PI(at(N),e.interpolate),Im(N,d,0,0,d.width,d.height,0,0,s,i),N.globalCompositeOperation="source-in";const S=le.transform(Ii(N),[1,0,0,1,-F,-V]);return N.fillStyle=o?r.getPattern(t,this,S,Cn.FILL):r,N.fillRect(0,0,s,i),l&&!o&&(this.cachedCanvases.delete("fillCanvas"),l.set(u,C.canvas)),{canvas:C.canvas,offsetX:Math.round(F),offsetY:Math.round(V)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=q6[e]}setLineJoin(e){this.ctx.lineJoin=K6[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const r=this.ctx;r.setTransform(...at(this.suspendedCtx)),xd(this.suspendedCtx,r),H6(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),xd(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],o=i[1],a=i[2]-r,l=i[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,s,a,l,t.subtype,t.backdrop,t.transferMap,r,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,o,a,l,u,d,f){let p=e.canvas,m=l-d,y=u-f;if(o){const k=le.makeHexColor(...o);if(m<0||y<0||m+s>p.width||y+i>p.height){const v=this.cachedCanvases.getCanvas("maskExtension",s,i),A=v.context;A.drawImage(p,-m,-y),A.globalCompositeOperation="destination-atop",A.fillStyle=k,A.fillRect(0,0,s,i),A.globalCompositeOperation="source-over",p=v.canvas,m=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(m,y,s,i),e.clip(v),e.globalCompositeOperation="destination-atop",e.fillStyle=k,e.fillRect(m,y,s,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const E=new Path2D;E.rect(l,u,s,i),t.clip(E),t.globalCompositeOperation="destination-in",t.drawImage(p,m,y,s,i,l,u,s,i),t.restore()}save(){this.inSMaskMode?(xd(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),xd(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,r,o){this.ctx.transform(e,t,s,i,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const i=this.ctx,r=this.current;let o=r.x,a=r.y,l,u;const d=at(i),f=d[0]===0&&d[3]===0||d[1]===0&&d[2]===0,p=f?s.slice(0):null;for(let m=0,y=0,E=e.length;m<E;m++)switch(e[m]|0){case ni.rectangle:o=t[y++],a=t[y++];const k=t[y++],v=t[y++],A=o+k,C=a+v;i.moveTo(o,a),k===0||v===0?i.lineTo(A,C):(i.lineTo(A,a),i.lineTo(A,C),i.lineTo(o,C)),f||r.updateRectMinMax(d,[o,a,A,C]),i.closePath();break;case ni.moveTo:o=t[y++],a=t[y++],i.moveTo(o,a),f||r.updatePathMinMax(d,o,a);break;case ni.lineTo:o=t[y++],a=t[y++],i.lineTo(o,a),f||r.updatePathMinMax(d,o,a);break;case ni.curveTo:l=o,u=a,o=t[y+4],a=t[y+5],i.bezierCurveTo(t[y],t[y+1],t[y+2],t[y+3],o,a),r.updateCurvePathMinMax(d,l,u,t[y],t[y+1],t[y+2],t[y+3],o,a,p),y+=6;break;case ni.curveTo2:l=o,u=a,i.bezierCurveTo(o,a,t[y],t[y+1],t[y+2],t[y+3]),r.updateCurvePathMinMax(d,l,u,o,a,t[y],t[y+1],t[y+2],t[y+3],p),o=t[y+2],a=t[y+3],y+=4;break;case ni.curveTo3:l=o,u=a,o=t[y+2],a=t[y+3],i.bezierCurveTo(t[y],t[y+1],o,a,o,a),r.updateCurvePathMinMax(d,l,u,t[y],t[y+1],o,a,o,a,p),y+=4;break;case ni.closePath:i.closePath();break}f&&r.updateScalingPathMinMax(d,p),r.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(t.save(),t.strokeStyle=s.getPattern(t,this,Ii(t),Cn.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;let r=!1;i&&(t.save(),t.fillStyle=s.getPattern(t,this,Ii(t),Cn.FILL),r=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=X6}eoClip(){this.pendingClip=NI}beginText(){this.current.textMatrix=CN,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(const s of e)t.setTransform(...s.transform),t.translate(s.x,s.y),s.addToPath(t,s.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var d;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||bE,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Te("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",o=((d=s.systemFontInfo)==null?void 0:d.css)||`"${r}", ${s.fallbackName}`;let a="normal";s.black?a="900":s.bold&&(a="bold");const l=s.italic?"italic":"normal";let u=t;t<TI?u=TI:t>SI&&(u=SI),this.current.fontSizeScale=t/u,this.ctx.font=`${l} ${a} ${u}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,r,o){this.current.textMatrix=[e,t,s,i,r,o],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i,r){const o=this.ctx,a=this.current,l=a.font,u=a.textRenderingMode,d=a.fontSize/a.fontSizeScale,f=u&wn.FILL_STROKE_MASK,p=!!(u&wn.ADD_TO_PATH_FLAG),m=a.patternFill&&!l.missingFile,y=a.patternStroke&&!l.missingFile;let E;(l.disableFontFace||p||m||y)&&(E=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||m||y?(o.save(),o.translate(t,s),o.beginPath(),E(o,d),(f===wn.FILL||f===wn.FILL_STROKE)&&(i&&o.setTransform(...i),o.fill()),(f===wn.STROKE||f===wn.FILL_STROKE)&&(r&&o.setTransform(...r),o.stroke()),o.restore()):((f===wn.FILL||f===wn.FILL_STROKE)&&o.fillText(e,t,s),(f===wn.STROKE||f===wn.FILL_STROKE)&&o.strokeText(e,t,s)),p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:at(o),x:t,y:s,fontSize:d,addToPath:E})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return xe(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const r=this.ctx,o=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,u=t.fontDirection,d=t.textHScale*u,f=e.length,p=s.vertical,m=p?1:-1,y=s.defaultVMetrics,E=i*t.fontMatrix[0],k=t.textRenderingMode===wn.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(d,-1):r.scale(d,1);let v,A;if(t.patternFill){r.save();const S=t.fillColor.getPattern(r,this,Ii(r),Cn.FILL);v=at(r),r.restore(),r.fillStyle=S}if(t.patternStroke){r.save();const S=t.strokeColor.getPattern(r,this,Ii(r),Cn.STROKE);A=at(r),r.restore(),r.strokeStyle=S}let C=t.lineWidth;const N=t.textMatrixScale;if(N===0||C===0){const S=t.textRenderingMode&wn.FILL_STROKE_MASK;(S===wn.STROKE||S===wn.FILL_STROKE)&&(C=this.getSinglePixelWidth())}else C/=N;if(o!==1&&(r.scale(o,o),C/=o),r.lineWidth=C,s.isInvalidPDFjsFont){const S=[];let T=0;for(const P of e)S.push(P.unicode),T+=P.width;r.fillText(S.join(""),0,0),t.x+=T*E*d,r.restore(),this.compose();return}let F=0,V;for(V=0;V<f;++V){const S=e[V];if(typeof S=="number"){F+=m*S*i/1e3;continue}let T=!1;const P=(S.isSpace?l:0)+a,D=S.fontChar,M=S.accent;let O,L,ne=S.width;if(p){const de=S.vmetric||y,Y=-(S.vmetric?de[1]:ne*.5)*E,z=de[2]*E;ne=de?-de[0]:ne,O=Y/o,L=(F+z)/o}else O=F/o,L=0;if(s.remeasure&&ne>0){const de=r.measureText(D).width*1e3/i*o;if(ne<de&&this.isFontSubpixelAAEnabled){const Y=ne/de;T=!0,r.save(),r.scale(Y,1),O/=Y}else ne!==de&&(O+=(ne-de)/2e3*i/o)}if(this.contentVisible&&(S.isInFont||s.missingFile)){if(k&&!M)r.fillText(D,O,L);else if(this.paintChar(D,O,L,v,A),M){const de=O+i*M.offset.x/o,Y=L-i*M.offset.y/o;this.paintChar(M.fontChar,de,Y,v,A)}}const Ne=p?ne*E-P*u:ne*E+P*u;F+=Ne,T&&r.restore()}p?t.y-=F:t.x+=F*d,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,o=s.fontDirection,a=i.vertical?1:-1,l=s.charSpacing,u=s.wordSpacing,d=s.textHScale*o,f=s.fontMatrix||bE,p=e.length,m=s.textRenderingMode===wn.INVISIBLE;let y,E,k,v;if(!(m||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(d,o),y=0;y<p;++y){if(E=e[y],typeof E=="number"){v=a*E*r/1e3,this.ctx.translate(v,0),s.x+=v*d;continue}const A=(E.isSpace?u:0)+l,C=i.charProcOperatorList[E.operatorListId];if(!C){Te(`Type3 character "${E.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=E,this.save(),t.scale(r,r),t.transform(...f),this.executeOperatorList(C),this.restore()),k=le.applyTransform([E.width,0],f)[0]*r+A,t.translate(k,0),s.x+=k*d}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,r,o){this.ctx.rect(s,i,r-s,o-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],i=this.baseTransform||at(this.ctx),r={createCanvasGraphics:o=>new GT(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new QE(e,s,this.ctx,r,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=le.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=le.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=B6(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Ii(t),Cn.SHADING);const i=Ii(t);if(i){const{width:r,height:o}=t.canvas,[a,l,u,d]=le.getAxialAlignedBoundingBox([0,0,r,o],i);this.ctx.fillRect(a,l,u-a,d-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Xe("Should not call beginInlineImage")}beginImageData(){Xe("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=at(this.ctx),t)){const s=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],s,i),this.current.updateRectMinMax(at(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Cv("TODO: Support non-isolated groups."),e.knockout&&Te("Knockout groups not supported.");const s=at(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=le.getAxialAlignedBoundingBox(e.bbox,at(t));const r=[0,0,t.canvas.width,t.canvas.height];i=le.intersect(i,r)||[0,0,0,0];const o=Math.floor(i[0]),a=Math.floor(i[1]),l=Math.max(Math.ceil(i[2])-o,1),u=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,u]);let d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(d,l,u),p=f.context;p.translate(-o,-a),p.transform(...s),e.smask?this.smaskStack.push({canvas:f.canvas,context:p,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),xd(t,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=at(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=le.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,i,r){if(x(this,xa,JE).call(this),Cm(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],a=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a;const[l,u]=le.singularValueDecompose2dScale(at(this.ctx)),{viewportScale:d}=this,f=Math.ceil(o*this.outputScaleX*d),p=Math.ceil(a*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:m,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(l,0,0,-u,0,a*u),Cm(this.ctx)}else Cm(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],o,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new CI(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),x(this,xa,ZE).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=G6(e)),i.compiled)){i.compiled(s);return}const r=this._createMaskCanvas(e),o=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(o,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,r,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const a=this.ctx;a.save();const l=at(a);a.transform(t,s,i,r,0,0);const u=this._createMaskCanvas(e);a.setTransform(1,0,0,1,u.offsetX-l[4],u.offsetY-l[5]);for(let d=0,f=o.length;d<f;d+=2){const p=le.transform(l,[t,s,i,r,o[d],o[d+1]]),[m,y]=le.applyTransform([0,0],p);a.drawImage(u.canvas,m,y)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:o,width:a,height:l,transform:u}=r,d=this.cachedCanvases.getCanvas("maskCanvas",a,l),f=d.context;f.save();const p=this.getObject(o,r);RI(f,p),f.globalCompositeOperation="source-in",f.fillStyle=i?s.getPattern(f,this,Ii(t),Cn.FILL):s,f.fillRect(0,0,a,l),f.restore(),t.save(),t.transform(...u),t.scale(1,-1),Im(t,d.canvas,0,0,a,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Te("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){Te("Dependent image isn't ready yet");return}const o=r.width,a=r.height,l=[];for(let u=0,d=i.length;u<d;u+=2)l.push({transform:[t,0,0,s,i[u],i[u+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;if(this.save(),!Bn){const{filter:a}=i;a!=="none"&&a!==""&&(i.filter="none")}i.scale(1/t,-1/s);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,s).context;kI(l,e),r=this.applyTransferMapsToCanvas(l)}const o=this._scaleImage(r,Ii(i));i.imageSmoothingEnabled=PI(at(i),e.interpolate),Im(i,o.img,0,0,o.paintWidth,o.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const r=e.width,o=e.height,l=this.cachedCanvases.getCanvas("inlineImage",r,o).context;kI(l,e),i=this.applyTransferMapsToCanvas(l)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),Im(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===NI?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=at(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let o,a;if(s===0&&i===0){const l=Math.abs(t),u=Math.abs(r);if(l===u)if(e===0)o=a=1/l;else{const d=l*e;o=a=d<1?1/d:1}else if(e===0)o=1/l,a=1/u;else{const d=l*e,f=u*e;o=d<1?1/d:1,a=f<1?1/f:1}}else{const l=Math.abs(t*r-s*i),u=Math.hypot(t,s),d=Math.hypot(i,r);if(e===0)o=d/l,a=u/l;else{const f=e*l;o=d>f?d/f:1,a=u>f?u/f:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[i,r]=this.getScaleForStroking();if(t.lineWidth=s||1,i===1&&r===1){t.stroke();return}const o=t.getLineDash();if(e&&t.save(),t.scale(i,r),o.length>0){const a=Math.max(i,r);t.setLineDash(o.map(l=>l/a)),t.lineDashOffset/=a}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};xa=new WeakSet,JE=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ZE=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}};let yu=GT;for(const n in ni)yu.prototype[n]!==void 0&&(yu.prototype[ni[n]]=yu.prototype[n]);var _p,vp;class Hr{static get workerPort(){return c(this,_p)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");w(this,_p,e)}static get workerSrc(){return c(this,vp)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");w(this,vp,e)}}_p=new WeakMap,vp=new WeakMap,I(Hr,_p,null),I(Hr,vp,"");const km={DATA:1,ERROR:2},Rt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function DI(){}function Ns(n){switch(n instanceof Error||typeof n=="object"&&n!==null||Xe('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new bc(n.message);case"MissingPDFException":return new Dg(n.message);case"PasswordException":return new TE(n.message,n.code);case"UnexpectedResponseException":return new kv(n.message,n.status);case"UnknownErrorException":return new SE(n.message,n.details);default:return new SE(n.message,n.toString())}}var Lu,Ks,dD,fD,pD,ay;class Gd{constructor(e,t,s){I(this,Ks);I(this,Lu,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",x(this,Ks,dD).bind(this),{signal:c(this,Lu).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(o){r.reject(o)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const d=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),d.promise},pull:u=>{const d=Promise.withResolvers();return this.streamControllers[r].pullCall=d,l.postMessage({sourceName:o,targetName:a,stream:Rt.PULL,streamId:r,desiredSize:u.desiredSize}),d.promise},cancel:u=>{Dt(u instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[r].cancelCall=d,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:Rt.CANCEL,streamId:r,reason:Ns(u)}),d.promise}},s)}destroy(){var e;(e=c(this,Lu))==null||e.abort(),w(this,Lu,null)}}Lu=new WeakMap,Ks=new WeakSet,dD=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){x(this,Ks,pD).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===km.DATA)i.resolve(e.data);else if(e.callback===km.ERROR)i.reject(Ns(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(o){r.postMessage({sourceName:s,targetName:i,callback:km.DATA,callbackId:e.callbackId,data:o})},function(o){r.postMessage({sourceName:s,targetName:i,callback:km.ERROR,callbackId:e.callbackId,reason:Ns(o)})});return}if(e.streamId){x(this,Ks,fD).call(this,e);return}t(e.data)},fD=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(u,d=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=d,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:Rt.ENQUEUE,streamId:t,chunk:u},f)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Rt.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){Dt(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Rt.ERROR,streamId:t,reason:Ns(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(a,e.data,l).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Rt.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Rt.START_COMPLETE,streamId:t,reason:Ns(u)})})},pD=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Rt.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(Ns(e.reason));break;case Rt.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(Ns(e.reason));break;case Rt.PULL:if(!a){r.postMessage({sourceName:s,targetName:i,stream:Rt.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||DI).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Rt.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Rt.PULL_COMPLETE,streamId:t,reason:Ns(u)})});break;case Rt.ENQUEUE:if(Dt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Rt.CLOSE:if(Dt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),x(this,Ks,ay).call(this,o,t);break;case Rt.ERROR:Dt(o,"error should have stream controller"),o.controller.error(Ns(e.reason)),x(this,Ks,ay).call(this,o,t);break;case Rt.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(Ns(e.reason)),x(this,Ks,ay).call(this,o,t);break;case Rt.CANCEL:if(!a)break;const l=Ns(e.reason);Promise.try(a.onCancel||DI,l).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Rt.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Rt.CANCEL_COMPLETE,streamId:t,reason:Ns(u)})}),a.sinkCapability.reject(l),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},ay=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var vl,wp;class Y6{constructor({parsedData:e,rawData:t}){I(this,vl);I(this,wp);w(this,vl,e),w(this,wp,t)}getRaw(){return c(this,wp)}get(e){return c(this,vl).get(e)??null}getAll(){return MT(c(this,vl))}has(e){return c(this,vl).has(e)}}vl=new WeakMap,wp=new WeakMap;const Uc=Symbol("INTERNAL");var Ep,Ap,bp,Mu;class Q6{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){I(this,Ep,!1);I(this,Ap,!1);I(this,bp,!1);I(this,Mu,!0);w(this,Ep,!!(e&ws.DISPLAY)),w(this,Ap,!!(e&ws.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(c(this,bp))return c(this,Mu);if(!c(this,Mu))return!1;const{print:e,view:t}=this.usage;return c(this,Ep)?(t==null?void 0:t.viewState)!=="OFF":c(this,Ap)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Uc&&Xe("Internal method `_setVisible` called."),w(this,bp,s),w(this,Mu,t)}}Ep=new WeakMap,Ap=new WeakMap,bp=new WeakMap,Mu=new WeakMap;var Uo,$e,Ou,Fu,Tp,eA;class J6{constructor(e,t=ws.DISPLAY){I(this,Tp);I(this,Uo,null);I(this,$e,new Map);I(this,Ou,null);I(this,Fu,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,w(this,Fu,e.order);for(const s of e.groups)c(this,$e).set(s.id,new Q6(t,s));if(e.baseState==="OFF")for(const s of c(this,$e).values())s._setVisible(Uc,!1);for(const s of e.on)c(this,$e).get(s)._setVisible(Uc,!0);for(const s of e.off)c(this,$e).get(s)._setVisible(Uc,!1);w(this,Ou,this.getHash())}}isVisible(e){if(c(this,$e).size===0)return!0;if(!e)return Cv("Optional content group not defined."),!0;if(e.type==="OCG")return c(this,$e).has(e.id)?c(this,$e).get(e.id).visible:(Te(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return x(this,Tp,eA).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!c(this,$e).has(t))return Te(`Optional content group not found: ${t}`),!0;if(c(this,$e).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!c(this,$e).has(t))return Te(`Optional content group not found: ${t}`),!0;if(!c(this,$e).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!c(this,$e).has(t))return Te(`Optional content group not found: ${t}`),!0;if(!c(this,$e).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!c(this,$e).has(t))return Te(`Optional content group not found: ${t}`),!0;if(c(this,$e).get(t).visible)return!1}return!0}return Te(`Unknown optional content policy ${e.policy}.`),!0}return Te(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=c(this,$e).get(e);if(!i){Te(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const o of i.rbGroups)for(const a of o)a!==e&&((r=c(this,$e).get(a))==null||r._setVisible(Uc,!1,!0));i._setVisible(Uc,!!t,!0),w(this,Uo,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=c(this,$e).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}w(this,Uo,null)}get hasInitialVisibility(){return c(this,Ou)===null||this.getHash()===c(this,Ou)}getOrder(){return c(this,$e).size?c(this,Fu)?c(this,Fu).slice():[...c(this,$e).keys()]:null}getGroups(){return c(this,$e).size>0?MT(c(this,$e)):null}getGroup(e){return c(this,$e).get(e)||null}getHash(){if(c(this,Uo)!==null)return c(this,Uo);const e=new tD;for(const[t,s]of c(this,$e))e.update(`${t}:${s.visible}`);return w(this,Uo,e.hexdigest())}}Uo=new WeakMap,$e=new WeakMap,Ou=new WeakMap,Fu=new WeakMap,Tp=new WeakSet,eA=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let o;if(Array.isArray(r))o=x(this,Tp,eA).call(this,r);else if(c(this,$e).has(r))o=c(this,$e).get(r).visible;else return Te(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"};class Z6{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Dt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});Dt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Dt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new e$(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new t$(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class e${constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=VT(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class t${constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function n$(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let d=a(t);return d=unescape(d),d=l(d),d=u(d),r(d)}if(t=o(n),t){const d=u(t);return r(d)}if(t=s("filename","i").exec(n),t){t=t[1];let d=a(t);return d=u(d),r(d)}function s(d,f){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function i(d,f){if(d){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(d,{fatal:!0}),m=Rv(f);f=p.decode(m),e=!1}catch{}}return f}function r(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function o(d){const f=[];let p;const m=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=m.exec(d))!==null;){let[,E,k,v]=p;if(E=parseInt(E,10),E in f){if(E===0)break;continue}f[E]=[k,v]}const y=[];for(let E=0;E<f.length&&E in f;++E){let[k,v]=f[E];v=a(v),k&&(v=unescape(v),E===0&&(v=l(v))),y.push(v)}return y.join("")}function a(d){if(d.startsWith('"')){const f=d.slice(1).split('\\"');for(let p=0;p<f.length;++p){const m=f[p].indexOf('"');m!==-1&&(f[p]=f[p].slice(0,m),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}d=f.join('"')}return d}function l(d){const f=d.indexOf("'");if(f===-1)return d;const p=d.slice(0,f),y=d.slice(f+1).replace(/^[^']*'/,"");return i(p,y)}function u(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,m,y){if(m==="q"||m==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(E,k){return String.fromCharCode(parseInt(k,16))}),i(p,y);try{y=atob(y)}catch{}return i(p,y)})}return""}function gD(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function Dv(n){try{return new URL(n).origin}catch{}return null}function mD({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function yD(n){const e=n.get("Content-Disposition");if(e){let t=n$(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(VT(t))return t}return null}function Lv(n,e){return n===404||n===0&&e.startsWith("file:")?new Dg('Missing PDF "'+e+'".'):new kv(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function _D(n){return n===200||n===206}function vD(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function wD(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Te(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class LI{constructor(e){ue(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=gD(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Dt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new s$(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new i$(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class s${constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,vD(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Dv(r.url),!_D(r.status))throw Lv(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:a,suggestedLength:l}=mD({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=yD(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new bc("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:wD(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class i${constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const o=i.url;fetch(o,vD(r,this._withCredentials,this._abortController)).then(a=>{const l=Dv(a.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!_D(a.status))throw Lv(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:wD(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Jw=200,Zw=206;function r$(n){const e=n.response;return typeof e!="string"?e:Rv(e).buffer}class o${constructor({url:e,httpHeaders:t,withCredentials:s}){ue(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=gD(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,s){const i={begin:e,end:t};for(const r in s)i[r]=s[r];return this.request(i)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,o]of this.headers)t.setRequestHeader(r,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=Zw):i.expectedStatus=Jw,t.responseType="arraybuffer",e.onError&&(t.onerror=function(r){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){var l,u,d;const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){(l=s.onError)==null||l.call(s,i.status);return}const r=i.status||Jw;if(!(r===Jw&&s.expectedStatus===Zw)&&r!==s.expectedStatus){(u=s.onError)==null||u.call(s,i.status);return}const a=r$(i);if(r===Zw){const f=i.getResponseHeader("Content-Range"),p=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);s.onDone({begin:parseInt(p[1],10),chunk:a})}else a?s.onDone({begin:0,chunk:a}):(d=s.onError)==null||d.call(s,i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class a${constructor(e){this._source=e,this._manager=new o$(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Dt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new l$(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new c$(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class l${constructor(e,t){this._manager=e;const s={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(s),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Dv(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trim().split(/[\r\n]+/).map(a=>{const[l,...u]=a.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=mD({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=yD(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Lv(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class c${constructor(e,t,s){this._manager=e;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,s,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Dv((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Lv(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const u$=/^[a-z][a-z0-9\-+.]+:/i;function h$(n){if(u$.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class d${constructor(e){this.source=e,this.url=h$(e.url),Dt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Dt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new f$(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new p$(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class f${constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Dg(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new bc("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class p${constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const g$=1e5,Yn=30,m$=.8;var VI,Bo,Zn,Sp,xp,wl,Ir,Ip,Cp,El,Vu,ju,zo,Uu,kp,Bu,Al,Rp,Pp,bl,Tl,Np,$o,zu,co,ED,AD,tA,Is,ly,nA,bD,TD;const Ot=class Ot{constructor({textContentSource:e,container:t,viewport:s}){I(this,co);I(this,Bo,Promise.withResolvers());I(this,Zn,null);I(this,Sp,!1);I(this,xp,!!((VI=globalThis.FontInspector)!=null&&VI.enabled));I(this,wl,null);I(this,Ir,null);I(this,Ip,0);I(this,Cp,0);I(this,El,null);I(this,Vu,null);I(this,ju,0);I(this,zo,0);I(this,Uu,Object.create(null));I(this,kp,[]);I(this,Bu,null);I(this,Al,[]);I(this,Rp,new WeakMap);I(this,Pp,null);var l;if(e instanceof ReadableStream)w(this,Bu,e);else if(typeof e=="object")w(this,Bu,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');w(this,Zn,w(this,Vu,t)),w(this,zo,s.scale*(globalThis.devicePixelRatio||1)),w(this,ju,s.rotation),w(this,Ir,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:o,pageY:a}=s.rawDims;w(this,Pp,[1,0,0,-1,-o,a+r]),w(this,Cp,i),w(this,Ip,r),x(l=Ot,Is,bD).call(l),dc(t,s),c(this,Bo).promise.finally(()=>{c(Ot,zu).delete(this),w(this,Ir,null),w(this,Uu,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Wn.platform;return xe(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{c(this,El).read().then(({value:t,done:s})=>{if(s){c(this,Bo).resolve();return}c(this,wl)??w(this,wl,t.lang),Object.assign(c(this,Uu),t.styles),x(this,co,ED).call(this,t.items),e()},c(this,Bo).reject)};return w(this,El,c(this,Bu).getReader()),c(Ot,zu).add(this),e(),c(this,Bo).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==c(this,ju)&&(t==null||t(),w(this,ju,i),dc(c(this,Vu),{rotation:i})),s!==c(this,zo)){t==null||t(),w(this,zo,s);const o={div:null,properties:null,ctx:x(r=Ot,Is,ly).call(r,c(this,wl))};for(const a of c(this,Al))o.properties=c(this,Rp).get(a),o.div=a,x(this,co,tA).call(this,o)}}cancel(){var t;const e=new bc("TextLayer task cancelled.");(t=c(this,El))==null||t.cancel(e).catch(()=>{}),w(this,El,null),c(this,Bo).reject(e)}get textDivs(){return c(this,Al)}get textContentItemsStr(){return c(this,kp)}static cleanup(){if(!(c(this,zu).size>0)){c(this,bl).clear();for(const{canvas:e}of c(this,Tl).values())e.remove();c(this,Tl).clear()}}};Bo=new WeakMap,Zn=new WeakMap,Sp=new WeakMap,xp=new WeakMap,wl=new WeakMap,Ir=new WeakMap,Ip=new WeakMap,Cp=new WeakMap,El=new WeakMap,Vu=new WeakMap,ju=new WeakMap,zo=new WeakMap,Uu=new WeakMap,kp=new WeakMap,Bu=new WeakMap,Al=new WeakMap,Rp=new WeakMap,Pp=new WeakMap,bl=new WeakMap,Tl=new WeakMap,Np=new WeakMap,$o=new WeakMap,zu=new WeakMap,co=new WeakSet,ED=function(e){var i,r;if(c(this,Sp))return;(r=c(this,Ir)).ctx??(r.ctx=x(i=Ot,Is,ly).call(i,c(this,wl)));const t=c(this,Al),s=c(this,kp);for(const o of e){if(t.length>g$){Te("Ignoring additional textDivs for performance reasons."),w(this,Sp,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=c(this,Zn);w(this,Zn,document.createElement("span")),c(this,Zn).classList.add("markedContent"),o.id!==null&&c(this,Zn).setAttribute("id",`${o.id}`),a.append(c(this,Zn))}else o.type==="endMarkedContent"&&w(this,Zn,c(this,Zn).parentNode);continue}s.push(o.str),x(this,co,AD).call(this,o)}},AD=function(e){var E;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};c(this,Al).push(t);const i=le.transform(c(this,Pp),e.transform);let r=Math.atan2(i[1],i[0]);const o=c(this,Uu)[e.fontName];o.vertical&&(r+=Math.PI/2);let a=c(this,xp)&&o.fontSubstitution||o.fontFamily;a=Ot.fontFamilyMap.get(a)||a;const l=Math.hypot(i[2],i[3]),u=l*x(E=Ot,Is,TD).call(E,a,c(this,wl));let d,f;r===0?(d=i[4],f=i[5]-u):(d=i[4]+u*Math.sin(r),f=i[5]-u*Math.cos(r));const p="calc(var(--scale-factor)*",m=t.style;c(this,Zn)===c(this,Vu)?(m.left=`${(100*d/c(this,Cp)).toFixed(2)}%`,m.top=`${(100*f/c(this,Ip)).toFixed(2)}%`):(m.left=`${p}${d.toFixed(2)}px)`,m.top=`${p}${f.toFixed(2)}px)`),m.fontSize=`${p}${(c(Ot,$o)*l).toFixed(2)}px)`,m.fontFamily=a,s.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,c(this,xp)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const k=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);k!==v&&Math.max(k,v)/Math.min(k,v)>1.5&&(y=!0)}if(y&&(s.canvasWidth=o.vertical?e.height:e.width),c(this,Rp).set(t,s),c(this,Ir).div=t,c(this,Ir).properties=s,x(this,co,tA).call(this,c(this,Ir)),s.hasText&&c(this,Zn).append(t),s.hasEOL){const k=document.createElement("br");k.setAttribute("role","presentation"),c(this,Zn).append(k)}},tA=function(e){var a;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let o="";if(c(Ot,$o)>1&&(o=`scale(${1/c(Ot,$o)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=r,{canvasWidth:u,fontSize:d}=s;x(a=Ot,Is,nA).call(a,i,d*c(this,zo),l);const{width:f}=i.measureText(t.textContent);f>0&&(o=`scaleX(${u*c(this,zo)/f}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(r.transform=o)},Is=new WeakSet,ly=function(e=null){let t=c(this,Tl).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),c(this,Tl).set(e,t),c(this,Np).set(t,{size:0,family:""})}return t},nA=function(e,t,s){const i=c(this,Np).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},bD=function(){if(c(this,$o)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),w(this,$o,e.getBoundingClientRect().height),e.remove()},TD=function(e,t){const s=c(this,bl).get(e);if(s)return s;const i=x(this,Is,ly).call(this,t);i.canvas.width=i.canvas.height=Yn,x(this,Is,nA).call(this,i,Yn,e);const r=i.measureText("");let o=r.fontBoundingBoxAscent,a=Math.abs(r.fontBoundingBoxDescent);if(o){const d=o/(o+a);return c(this,bl).set(e,d),i.canvas.width=i.canvas.height=0,d}i.strokeStyle="red",i.clearRect(0,0,Yn,Yn),i.strokeText("g",0,0);let l=i.getImageData(0,0,Yn,Yn).data;a=0;for(let d=l.length-1-3;d>=0;d-=4)if(l[d]>0){a=Math.ceil(d/4/Yn);break}i.clearRect(0,0,Yn,Yn),i.strokeText("A",0,Yn),l=i.getImageData(0,0,Yn,Yn).data,o=0;for(let d=0,f=l.length;d<f;d+=4)if(l[d]>0){o=Yn-Math.floor(d/4/Yn);break}i.canvas.width=i.canvas.height=0;const u=o?o/(o+a):m$;return c(this,bl).set(e,u),u},I(Ot,Is),I(Ot,bl,new Map),I(Ot,Tl,new Map),I(Ot,Np,new WeakMap),I(Ot,$o,null),I(Ot,zu,new Set);let Kf=Ot;class Xf{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var l;if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(Xf.shouldBuildText(a))(l=r==null?void 0:r.attributes)!=null&&l.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&t.push({str:o}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const y$=65536,_$=100,v$=5e3,w$=Bn?L6:P6,E$=Bn?M6:oD,A$=Bn?D6:N6,b$=Bn?O6:uD;function T$(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new sA,{docId:t}=e,s=n.url?S$(n.url):null,i=n.data?x$(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,l=n.range instanceof SD?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:y$;let d=n.worker instanceof _u?n.worker:null;const f=n.verbosity,p=typeof n.docBaseUrl=="string"&&!Nv(n.docBaseUrl)?n.docBaseUrl:null,m=typeof n.cMapUrl=="string"?n.cMapUrl:null,y=n.cMapPacked!==!1,E=n.CMapReaderFactory||E$,k=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,v=n.StandardFontDataFactory||b$,A=n.stopAtErrors!==!0,C=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,N=n.isEvalSupported!==!1,F=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Bn,V=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Bn&&(Wn.platform.isFirefox||!globalThis.chrome),S=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,T=typeof n.disableFontFace=="boolean"?n.disableFontFace:Bn,P=n.fontExtraProperties===!0,D=n.enableXfa===!0,M=n.ownerDocument||globalThis.document,O=n.disableRange===!0,L=n.disableStream===!0,ne=n.disableAutoFetch===!0,Ne=n.pdfBug===!0,de=n.CanvasFactory||w$,Y=n.FilterFactory||A$,z=n.enableHWA===!0,$=l?l.length:n.length??NaN,q=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Bn&&!T,oe=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:E===oD&&v===uD&&m&&k&&Vd(m,document.baseURI)&&Vd(k,document.baseURI);n.canvasFactory&&EI("`canvasFactory`-instance option, please use `CanvasFactory` instead."),n.filterFactory&&EI("`filterFactory`-instance option, please use `FilterFactory` instead.");const se=null;c6(f);const J={canvasFactory:new de({ownerDocument:M,enableHWA:z}),filterFactory:new Y({docId:t,ownerDocument:M}),cMapReaderFactory:oe?null:new E({baseUrl:m,isCompressed:y}),standardFontDataFactory:oe?null:new v({baseUrl:k})};if(!d){const Be={verbosity:f,port:Hr.workerPort};d=Be.port?_u.fromPort(Be):new _u(Be),e._worker=d}const Ge={docId:t,apiVersion:"4.9.155",data:i,password:a,disableAutoFetch:ne,rangeChunkSize:u,length:$,docBaseUrl:p,enableXfa:D,evaluatorOptions:{maxImageSize:C,disableFontFace:T,ignoreErrors:A,isEvalSupported:N,isOffscreenCanvasSupported:F,isImageDecoderSupported:V,canvasMaxAreaInBytes:S,fontExtraProperties:P,useSystemFonts:q,cMapUrl:oe?m:null,standardFontDataUrl:oe?k:null}},_e={disableFontFace:T,fontExtraProperties:P,ownerDocument:M,pdfBug:Ne,styleElement:se,loadingParams:{disableAutoFetch:ne,enableXfa:D}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Be=d.messageHandler.sendWithPromise("GetDocRequest",Ge,i?[i.buffer]:null);let be;if(l)be=new Z6(l,{disableRange:O,disableStream:L});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");let Qs;if(Bn)if(Vd(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Qs=LI}else Qs=d$;else Qs=Vd(s)?LI:a$;be=new Qs({url:s,length:$,httpHeaders:r,withCredentials:o,rangeChunkSize:u,disableRange:O,disableStream:L})}return Be.then(Qs=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Da=new Gd(t,Qs,d.port),lr=new R$(Da,e,be,_e,J);e._transport=lr,Da.send("Ready",null)})}).catch(e._capability.reject),e}function S$(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Bn&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function x$(n){if(Bn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Rv(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function MI(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var k_;const R_=class R_{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ln(R_,k_)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};k_=new WeakMap,I(R_,k_,0);let sA=R_;class SD{constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Xe("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class I${constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return xe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Ho,Cr,Hs,Bc,cy;class C${constructor(e,t,s,i=!1){I(this,Hs);I(this,Ho,null);I(this,Cr,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new wI:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new xD,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new Lg({viewBox:this.view,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return xe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=Io.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:u=null,printAnnotationStorage:d=null,isEditing:f=!1}){var N,F;(N=this._stats)==null||N.time("Overall");const p=this._transport.getRenderingIntent(s,i,d,f),{renderingIntent:m,cacheKey:y}=p;w(this,Cr,!1),x(this,Hs,cy).call(this),a||(a=this._transport.getOptionalContentConfig(m));let E=this._intentStates.get(y);E||(E=Object.create(null),this._intentStates.set(y,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const k=!!(m&ws.PRINT);E.displayReadyCapability||(E.displayReadyCapability=Promise.withResolvers(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(F=this._stats)==null||F.time("Page Request"),this._pumpOperatorList(p));const v=V=>{var S;E.renderTasks.delete(A),(this._maybeCleanupAfterRender||k)&&w(this,Cr,!0),x(this,Hs,Bc).call(this,!k),V?(A.capability.reject(V),this._abortOperatorList({intentState:E,reason:V instanceof Error?V:new Error(V)})):A.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(S=globalThis.Stats)!=null&&S.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},A=new rA({callback:v,params:{canvasContext:e,viewport:t,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:u});(E.renderTasks||(E.renderTasks=new Set)).add(A);const C=A.task;return Promise.all([E.displayReadyCapability.promise,a]).then(([V,S])=>{var T;if(this.destroyed){v();return}if((T=this._stats)==null||T.time("Rendering"),!(S.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");A.initializeGraphics({transparency:V,optionalContentConfig:S}),A.operatorListChanged()}).catch(v),C}getOperatorList({intent:e="display",annotationMode:t=Io.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(e,t,s,i,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Xf.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){o.read().then(function({value:l,done:u}){if(u){s(a);return}a.lang??(a.lang=l.lang),Object.assign(a.styles,l.styles),a.items.push(...l.items),r()},i)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),w(this,Cr,!1),x(this,Hs,cy).call(this),Promise.all(e)}cleanup(e=!1){w(this,Cr,!0);const t=x(this,Hs,Bc).call(this,!1);return e&&t&&this._stats&&(this._stats=new wI),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&x(this,Hs,Bc).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:o}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},o).getReader(),u=this._intentStates.get(t);u.streamReader=l;const d=()=>{l.read().then(({value:f,done:p})=>{if(p){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,u),d())},f=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const p of u.renderTasks)p.operatorListChanged();x(this,Hs,Bc).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(f);else if(u.opListReadCapability)u.opListReadCapability.reject(f);else throw f}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof FT){let i=_$;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new bc(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Ho=new WeakMap,Cr=new WeakMap,Hs=new WeakSet,Bc=function(e=!1){if(x(this,Hs,cy).call(this),!c(this,Cr)||this.destroyed)return!1;if(e)return w(this,Ho,setTimeout(()=>{w(this,Ho,null),x(this,Hs,Bc).call(this,!1)},v$)),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),w(this,Cr,!1),!0},cy=function(){c(this,Ho)&&(clearTimeout(c(this,Ho)),w(this,Ho,null))};var kr,P_;class k${constructor(){I(this,kr,new Map);I(this,P_,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};c(this,P_).then(()=>{for(const[i]of c(this,kr))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){Te("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}c(this,kr).set(t,i)}removeEventListener(e,t){const s=c(this,kr).get(t);s==null||s(),c(this,kr).delete(t)}terminate(){for(const[,e]of c(this,kr))e==null||e();c(this,kr).clear()}}kr=new WeakMap,P_=new WeakMap;var N_,Sl,xl,$u,uy,Hu,hy;const ot=class ot{constructor({name:e=null,port:t=null,verbosity:s=u6()}={}){I(this,$u);var i;if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=c(ot,xl))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(c(ot,xl)||w(ot,xl,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Gd("main","worker",e),this._messageHandler.on("ready",function(){}),x(this,$u,uy).call(this)}_initialize(){if(c(ot,Sl)||c(ot,Hu,hy)){this._setupFakeWorker();return}let{workerSrc:e}=ot;try{ot._isSameOrigin(window.location.href,e)||(e=ot._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Gd("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:r.signal}),s.on("test",a=>{if(r.abort(),this.destroyed||!a){i();return}this._messageHandler=s,this._port=t,this._webWorker=t,x(this,$u,uy).call(this)}),s.on("ready",a=>{if(r.abort(),this.destroyed){i();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};o();return}catch{Cv("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){c(ot,Sl)||(Te("Setting up fake worker."),w(ot,Sl,!0)),ot._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new k$;this._port=t;const s=`fake${Ln(ot,N_)._++}`,i=new Gd(s+"_worker",s,t);e.setup(i,t),this._messageHandler=new Gd(s,s+"_worker",t),x(this,$u,uy).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,s;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=c(ot,xl))==null||t.delete(this._port),this._port=null,(s=this._messageHandler)==null||s.destroy(),this._messageHandler=null}static fromPort(e){var s;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(s=c(this,xl))==null?void 0:s.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new ot(e)}static get workerSrc(){if(Hr.workerSrc)return Hr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return xe(this,"_setupFakeWorkerGlobal",(async()=>c(this,Hu,hy)?c(this,Hu,hy):(await import(this.workerSrc)).WorkerMessageHandler)())}};N_=new WeakMap,Sl=new WeakMap,xl=new WeakMap,$u=new WeakSet,uy=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Hu=new WeakSet,hy=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},I(ot,Hu),I(ot,N_,0),I(ot,Sl,!1),I(ot,xl),Bn&&(w(ot,Sl,!0),Hr.workerSrc||(Hr.workerSrc="./pdf.worker.mjs")),ot._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const i=new URL(t,s);return s.origin===i.origin},ot._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let _u=ot;var Rr,Ui,Wu,Gu,Bi,Il,qd;class R${constructor(e,t,s,i,r){I(this,Il);I(this,Rr,new Map);I(this,Ui,new Map);I(this,Wu,new Map);I(this,Gu,new Map);I(this,Bi,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new xD,this.fontLoader=new k6({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return xe(this,"annotationStorage",new BT)}getRenderingIntent(e,t=Io.ENABLE,s=null,i=!1,r=!1){let o=ws.DISPLAY,a=qE;switch(e){case"any":o=ws.ANY;break;case"display":break;case"print":o=ws.PRINT;break;default:Te(`getRenderingIntent - invalid intent: ${e}`)}const l=o&ws.PRINT&&s instanceof sD?s:this.annotationStorage;switch(t){case Io.DISABLE:o+=ws.ANNOTATIONS_DISABLE;break;case Io.ENABLE:break;case Io.ENABLE_FORMS:o+=ws.ANNOTATIONS_FORMS;break;case Io.ENABLE_STORAGE:o+=ws.ANNOTATIONS_STORAGE,a=l.serializable;break;default:Te(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=ws.IS_EDITING),r&&(o+=ws.OPLIST);const{ids:u,hash:d}=l.modifiedIds,f=[o,a.hash,d];return{renderingIntent:o,cacheKey:f.join("_"),annotationStorageSerializable:a,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=c(this,Bi))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of c(this,Ui).values())e.push(i._destroy());c(this,Ui).clear(),c(this,Wu).clear(),c(this,Gu).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),c(this,Rr).clear(),this.filterFactory.destroy(),Kf.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new bc("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Dt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){i.close();return}Dt(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async s=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:o}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:o}}),e.on("GetRangeReader",(s,i)=>{Dt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){i.close();return}Dt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{r.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new I$(s,this))}),e.on("DocException",function(s){let i;switch(s.name){case"PasswordException":i=new TE(s.message,s.code);break;case"InvalidPDFException":i=new kN(s.message);break;case"MissingPDFException":i=new Dg(s.message);break;case"UnexpectedResponseException":i=new kv(s.message,s.status);break;case"UnknownErrorException":i=new SE(s.message,s.details);break;default:Xe("DocException - expected a valid Error.")}t._capability.reject(i)}),e.on("PasswordRequest",s=>{if(w(this,Bi,Promise.withResolvers()),t.onPassword){const i=r=>{r instanceof Error?c(this,Bi).reject(r):c(this,Bi).resolve({password:r})};try{t.onPassword(i,s.code)}catch(r){c(this,Bi).reject(r)}}else c(this,Bi).reject(new TE(s.message,s.code));return c(this,Bi).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;c(this,Ui).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var o;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":const{disableFontFace:a,fontExtraProperties:l,pdfBug:u}=this._params;if("error"in r){const m=r.error;Te(`Error during font loading: ${m}`),this.commonObjs.resolve(s,m);break}const d=u&&((o=globalThis.FontInspector)!=null&&o.enabled)?(m,y)=>globalThis.FontInspector.fontAdded(m,y):null,f=new R6(r,{disableFontFace:a,inspectFont:d});this.fontLoader.bind(f).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!l&&f.data&&(f.data=null),this.commonObjs.resolve(s,f)});break;case"CopyLocalImage":const{imageRef:p}=r;Dt(p,"The imageRef must be defined.");for(const m of c(this,Ui).values())for(const[,y]of m.objs)if((y==null?void 0:y.ref)===p)return y.dataLen?(this.commonObjs.resolve(s,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,o])=>{var l;if(this.destroyed)return;const a=c(this,Ui).get(i);if(!a.objs.has(s)){if(a._intentStates.size===0){(l=o==null?void 0:o.bitmap)==null||l.close();return}switch(r){case"Image":a.objs.resolve(s,o),(o==null?void 0:o.dataLen)>r6&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&Te("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=c(this,Wu).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&c(this,Gu).set(r.refStr,e);const o=new C$(t,r,this,this._params.pdfBug);return c(this,Ui).set(t,o),o});return c(this,Wu).set(t,i),i}getPageIndex(e){return MI(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return x(this,Il,qd).call(this,"GetFieldObjects")}hasJSActions(){return x(this,Il,qd).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return x(this,Il,qd).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return x(this,Il,qd).call(this,"GetOptionalContentConfig").then(t=>new J6(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=c(this,Rr).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,o;return{info:i[0],metadata:i[1]?new Y6(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return c(this,Rr).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of c(this,Ui).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),c(this,Rr).clear(),this.filterFactory.destroy(!0),Kf.cleanup()}}cachedPageNumber(e){if(!MI(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return c(this,Gu).get(t)??null}}Rr=new WeakMap,Ui=new WeakMap,Wu=new WeakMap,Gu=new WeakMap,Bi=new WeakMap,Il=new WeakSet,qd=function(e,t=null){const s=c(this,Rr).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return c(this,Rr).set(e,i),i};const Rm=Symbol("INITIAL_DATA");var ai,Dp,iA;class xD{constructor(){I(this,Dp);I(this,ai,Object.create(null))}get(e,t=null){if(t){const i=x(this,Dp,iA).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=c(this,ai)[e];if(!s||s.data===Rm)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=c(this,ai)[e];return!!t&&t.data!==Rm}resolve(e,t=null){const s=x(this,Dp,iA).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in c(this,ai)){const{data:s}=c(this,ai)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}w(this,ai,Object.create(null))}*[Symbol.iterator](){for(const e in c(this,ai)){const{data:t}=c(this,ai)[e];t!==Rm&&(yield[e,t])}}}ai=new WeakMap,Dp=new WeakSet,iA=function(e){var t;return(t=c(this,ai))[e]||(t[e]={...Promise.withResolvers(),data:Rm})};var Wo;class P${constructor(e){I(this,Wo,null);w(this,Wo,e),this.onContinue=null}get promise(){return c(this,Wo).capability.promise}cancel(e=0){c(this,Wo).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=c(this,Wo).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=c(this,Wo);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Wo=new WeakMap;var Go,Cl;const qa=class qa{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:d=!1,pdfBug:f=!1,pageColors:p=null}){I(this,Go,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new P$(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var a,l;if(this.cancelled)return;if(this._canvas){if(c(qa,Cl).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");c(qa,Cl).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:o}=this.params;this.gfx=new yu(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),c(this,Go)&&(window.cancelAnimationFrame(c(this,Go)),w(this,Go,null)),c(qa,Cl).delete(this._canvas),this.callback(e||new FT(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?w(this,Go,window.requestAnimationFrame(()=>{w(this,Go,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),c(qa,Cl).delete(this._canvas),this.callback())))}};Go=new WeakMap,Cl=new WeakMap,I(qa,Cl,new WeakSet);let rA=qa;const N$="4.9.155",D$="a4eb8407c";function OI(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Id(n){return Math.max(0,Math.min(255,255*n))}class FI{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Id(e),[e,e,e]}static G_HTML([e]){const t=OI(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Id)}static RGB_HTML(e){return`#${e.map(OI).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[Id(1-Math.min(1,e+i)),Id(1-Math.min(1,s+i)),Id(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,o=1-s,a=Math.min(i,r,o);return["CMYK",i,r,o,a]}}class L${create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Xe("Abstract method `_createSVG` called.")}}class $T extends L${_createSVG(e){return document.createElementNS(fr,e)}}class ID{static setupStorage(e,t,s,i,r){const o=i.getValue(t,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),r==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?e.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",a=>{i.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),r==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of s.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const l=a.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[l,u]of Object.entries(o))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}a&&r.addLinkAttributes(e,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(e,o.dataId,t,s)}static render(e){var f,p;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:r,linkService:s});const a=r!=="richText",l=e.div;if(l.append(o),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=m}a&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const m=document.createTextNode(i.value);o.append(m),a&&Xf.shouldBuildText(i.name)&&u.push(m)}return{textDivs:u}}const d=[[i,-1,o]];for(;d.length>0;){const[m,y,E]=d.at(-1);if(y+1===m.children.length){d.pop();continue}const k=m.children[++d.at(-1)[1]];if(k===null)continue;const{name:v}=k;if(v==="#text"){const C=document.createTextNode(k.value);u.push(C),E.append(C);continue}const A=(f=k==null?void 0:k.attributes)!=null&&f.xmlns?document.createElementNS(k.attributes.xmlns,v):document.createElement(v);if(E.append(A),k.attributes&&this.setAttributes({html:A,element:k,storage:t,intent:r,linkService:s}),((p=k.children)==null?void 0:p.length)>0)d.push([k,-1,A]);else if(k.value){const C=document.createTextNode(k.value);a&&Xf.shouldBuildText(v)&&u.push(C),A.append(C)}}for(const m of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Og=1e3,M$=9,pc=new WeakSet;function ma(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class O${static create(e){switch(e.data.annotationType){case Mt.LINK:return new CD(e);case Mt.TEXT:return new F$(e);case Mt.WIDGET:switch(e.data.fieldType){case"Tx":return new V$(e);case"Btn":return e.data.radioButton?new PD(e):e.data.checkBox?new U$(e):new B$(e);case"Ch":return new z$(e);case"Sig":return new j$(e)}return new Tc(e);case Mt.POPUP:return new aA(e);case Mt.FREETEXT:return new OD(e);case Mt.LINE:return new H$(e);case Mt.SQUARE:return new W$(e);case Mt.CIRCLE:return new G$(e);case Mt.POLYLINE:return new FD(e);case Mt.CARET:return new K$(e);case Mt.INK:return new HT(e);case Mt.POLYGON:return new q$(e);case Mt.HIGHLIGHT:return new VD(e);case Mt.UNDERLINE:return new X$(e);case Mt.SQUIGGLY:return new Y$(e);case Mt.STRIKEOUT:return new Q$(e);case Mt.STAMP:return new jD(e);case Mt.FILEATTACHMENT:return new J$(e);default:return new kt(e)}}}var kl,qu,Ku,Lp,oA;const qT=class qT{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){I(this,Lp);I(this,kl,null);I(this,qu,!1);I(this,Ku,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return qT._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;c(this,kl)||w(this,kl,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&x(this,Lp,oA).call(this,t),(s=c(this,Ku))==null||s.popup.updateEdited(e)}resetEdited(){var e;c(this,kl)&&(x(this,Lp,oA).call(this,c(this,kl).rect),(e=c(this,Ku))==null||e.popup.resetEdited(),w(this,kl,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Tc||(r.tabIndex=Og);const{style:o}=r;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof aA){const{rotation:E}=t;return!t.hasOwnCanvas&&E!==0&&this.setRotation(E,r),r}const{width:a,height:l}=ma(t.rect);if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const E=t.borderStyle.horizontalCornerRadius,k=t.borderStyle.verticalCornerRadius;if(E>0||k>0){const A=`calc(${E}px * var(--scale-factor)) / calc(${k}px * var(--scale-factor))`;o.borderRadius=A}else if(this instanceof PD){const A=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;o.borderRadius=A}switch(t.borderStyle.style){case Sd.SOLID:o.borderStyle="solid";break;case Sd.DASHED:o.borderStyle="dashed";break;case Sd.BEVELED:Te("Unimplemented border style: beveled");break;case Sd.INSET:Te("Unimplemented border style: inset");break;case Sd.UNDERLINE:o.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(w(this,qu,!0),o.borderColor=le.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):o.borderWidth=0}const u=le.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:f,pageX:p,pageY:m}=i.rawDims;o.left=`${100*(u[0]-p)/d}%`,o.top=`${100*(u[1]-m)/f}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(o.width=`${100*a/d}%`,o.height=`${100*l/f}%`):this.setRotation(y,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims,{width:r,height:o}=ma(this.data.rect);let a,l;e%180===0?(a=100*r/s,l=100*o/i):(a=100*o/s,l=100*r/i),t.style.width=`${a}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],o=r[0],a=r.slice(1);i.target.style[s]=FI[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[s]:FI[`${o}_rgb`](a)})};return xe(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const o=s[i];if(o){const a={detail:{[i]:r},target:e};o(a),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(E=>Math.fround(E));if(e.length===8){const[E,k,v,A]=e.subarray(2,6);if(i===E&&r===k&&t===v&&s===A)return}const{style:o}=this.container;let a;if(c(this,qu)){const{borderColor:E,borderWidth:k}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${E}" stroke-width="${k}">`],this.container.classList.add("hasBorder")}const l=i-t,u=r-s,{svgFactory:d}=this,f=d.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const p=d.createElement("defs");f.append(p);const m=d.createElement("clipPath"),y=`clippath_${this.data.id}`;m.setAttribute("id",y),m.setAttribute("clipPathUnits","objectBoundingBox"),p.append(m);for(let E=2,k=e.length;E<k;E+=8){const v=e[E],A=e[E+1],C=e[E+2],N=e[E+3],F=d.createElement("rect"),V=(C-t)/l,S=(r-A)/u,T=(v-C)/l,P=(A-N)/u;F.setAttribute("x",V),F.setAttribute("y",S),F.setAttribute("width",T),F.setAttribute("height",P),m.append(F),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${V}" y="${S}" width="${T}" height="${P}"/>`)}c(this,qu)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(f),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:e}=this,t=w(this,Ku,new aA({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Xe("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:o,exportValues:a}of i){if(r===-1||o===t)continue;const l=typeof a=="string"?a:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!pc.has(u)){Te(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:l,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,o=i.getAttribute("data-element-id");o!==t&&pc.has(i)&&s.push({id:o,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};kl=new WeakMap,qu=new WeakMap,Ku=new WeakMap,Lp=new WeakSet,oA=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:l}}}}=this;s==null||s.splice(0,4,...e);const{width:u,height:d}=ma(e);t.left=`${100*(e[0]-a)/r}%`,t.top=`${100*(o-e[3]+l)/o}%`,i===0?(t.width=`${100*u/r}%`,t.height=`${100*d/o}%`):this.setRotation(i)};let kt=qT;var As,za,kD,RD;class CD extends kt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});I(this,As);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(x(this,As,kD).call(this,i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(x(this,As,RD).call(this,i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&x(this,As,za).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),x(this,As,za).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const o=i.get(r);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),x(this,As,za).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),x(this,As,za).call(this),!this._fieldObjects){Te('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var f;i==null||i();const{fields:r,refs:o,include:a}=s,l=[];if(r.length!==0||o.length!==0){const p=new Set(o);for(const m of r){const y=this._fieldObjects[m]||[];for(const{id:E}of y)p.add(E)}for(const m of Object.values(this._fieldObjects))for(const y of m)p.has(y.id)===a&&l.push(y)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const u=this.annotationStorage,d=[];for(const p of l){const{id:m}=p;switch(d.push(m),p.type){case"text":{const E=p.defaultValue||"";u.setValue(m,{value:E});break}case"checkbox":case"radiobutton":{const E=p.defaultValue===p.exportValues;u.setValue(m,{value:E});break}case"combobox":case"listbox":{const E=p.defaultValue||"";u.setValue(m,{value:E});break}default:continue}const y=document.querySelector(`[data-element-id="${m}"]`);if(y){if(!pc.has(y)){Te(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}As=new WeakSet,za=function(){this.container.setAttribute("data-internal-link","")},kD=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},x(this,As,za).call(this)},RD=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),x(this,As,za).call(this)};class F$ extends kt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Tc extends kt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Wn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(s,o=>{var a;if(s==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o)}}))})}_setEventListeners(e,t,s,i){var r,o,a;for(const[l,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,u,i),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":le.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||M$,r=e.style;let o;const a=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(u/(Kw*i))||1,f=u/d;o=Math.min(i,l(f/Kw))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(i,l(u/Kw))}r.fontSize=`calc(${o}px * var(--scale-factor))`,r.color=le.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class V$ extends Tc{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=s),r.setValue(o.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let u=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",u??a),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),pc.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=Og,this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",p=>{e.setValue(t,{value:p.target.value}),this.setPropertyOnSiblings(s,"value",p.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue??"";s.value=d.userValue=m,d.formattedValue=null});let f=p=>{const{formattedValue:m}=d;m!=null&&(p.target.value=m),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",m=>{var E;if(d.focused)return;const{target:y}=m;d.userValue&&(y.value=d.userValue),d.lastCommittedValue=y.value,d.commitKey=1,(E=this.data.actions)!=null&&E.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);const y={value(E){d.userValue=E.detail.value??"",e.setValue(t,{value:d.userValue.toString()}),E.target.value=d.userValue},formattedValue(E){const{formattedValue:k}=E.detail;d.formattedValue=k,k!=null&&E.target!==document.activeElement&&(E.target.value=k),e.setValue(t,{formattedValue:k})},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{var C;const{charLimit:k}=E.detail,{target:v}=E;if(k===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",k);let A=d.userValue;!A||A.length<=k||(A=A.slice(0,k),v.value=d.userValue=A,e.setValue(t,{value:A}),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(y,m)}),s.addEventListener("keydown",m=>{var k;d.commitKey=1;let y=-1;if(m.key==="Escape"?y=0:m.key==="Enter"&&!this.data.multiLine?y=2:m.key==="Tab"&&(d.commitKey=3),y===-1)return;const{value:E}=m.target;d.lastCommittedValue!==E&&(d.lastCommittedValue=E,d.userValue=E,(k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:y,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});const p=f;f=null,s.addEventListener("blur",m=>{var E,k;if(!d.focused||!m.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(d.focused=!1);const{value:y}=m.target;d.userValue=y,d.lastCommittedValue!==y&&((k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:d.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}})),p(m)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",m=>{var F;d.lastCommittedValue=null;const{data:y,target:E}=m,{value:k,selectionStart:v,selectionEnd:A}=E;let C=v,N=A;switch(m.inputType){case"deleteWordBackward":{const V=k.substring(0,v).match(/\w*[^\w]*$/);V&&(C-=V[0].length);break}case"deleteWordForward":{const V=k.substring(v).match(/^[^\w]*\w*/);V&&(N+=V[0].length);break}case"deleteContentBackward":v===A&&(C-=1);break;case"deleteContentForward":v===A&&(N+=1);break}m.preventDefault(),(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:k,change:y||"",willCommit:!1,selStart:C,selEnd:N}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(f&&s.addEventListener("blur",f),this.data.comb){const m=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${m}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class j$ extends Tc{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class U$ extends Tc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return pc.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=Og,r.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const u of this._getElementsByName(a,s)){const d=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}e.setValue(s,{value:l})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class PD extends Tc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const o of this._getElementsByName(t.fieldName,s))e.setValue(o.id,{value:!1});const r=document.createElement("input");if(pc.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=Og,r.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const u of this._getElementsByName(a,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:l})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;r.addEventListener("updatefromsandbox",a=>{const l={value:u=>{const d=o===u.detail.value;for(const f of this._getElementsByName(u.target.name)){const p=d&&f.id===s;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class B$ extends CD{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class z$ extends Tc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");pc.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=Og;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const f=this.data.defaultFieldValue;for(const p of i.options)p.selected=p.value===f});for(const d of this.data.options){const f=document.createElement("option");f.textContent=d.displayValue,f.value=d.exportValue,s.value.includes(d.exportValue)&&(f.setAttribute("selected",!0),r=!1),i.append(f)}let o=null;if(r){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),o=()=>{d.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const a=d=>{const f=d?"value":"textContent",{options:p,multiple:m}=i;return m?Array.prototype.filter.call(p,y=>y.selected).map(y=>y[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let l=a(!1);const u=d=>{const f=d.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const f={value(p){o==null||o();const m=p.detail.value,y=new Set(Array.isArray(m)?m:[m]);for(const E of i.options)E.selected=y.has(E.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(p){i.multiple=!0},remove(p){const m=i.options,y=p.detail.remove;m[y].selected=!1,i.remove(y),m.length>0&&Array.prototype.findIndex.call(m,k=>k.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:a(!0),items:u(p)}),l=a(!1)},clear(p){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(p){const{index:m,displayValue:y,exportValue:E}=p.detail.insert,k=i.children[m],v=document.createElement("option");v.textContent=y,v.value=E,k?k.before(v):i.append(v),e.setValue(t,{value:a(!0),items:u(p)}),l=a(!1)},items(p){const{items:m}=p.detail;for(;i.length!==0;)i.remove(0);for(const y of m){const{displayValue:E,exportValue:k}=y,v=document.createElement("option");v.textContent=E,v.value=k,i.append(v)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:u(p)}),l=a(!1)},indices(p){const m=new Set(p.detail.indices);for(const y of p.target.options)y.selected=m.has(y.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,d)}),i.addEventListener("input",d=>{var m;const f=a(!0),p=a(!1);e.setValue(t,{value:f}),d.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class aA extends kt{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:kt._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new $$({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${OT}${s}`).join(",")),this.container}}var Xu,D_,L_,Yu,Rl,Et,Pr,Qu,Mp,Op,Ju,Nr,li,Dr,Fp,Lr,Vp,Pl,Nl,Ye,dy,lA,ND,DD,LD,MD,fy,py,cA;class $${constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:o,richText:a,parent:l,rect:u,parentRect:d,open:f}){I(this,Ye);I(this,Xu,x(this,Ye,LD).bind(this));I(this,D_,x(this,Ye,cA).bind(this));I(this,L_,x(this,Ye,py).bind(this));I(this,Yu,x(this,Ye,fy).bind(this));I(this,Rl,null);I(this,Et,null);I(this,Pr,null);I(this,Qu,null);I(this,Mp,null);I(this,Op,null);I(this,Ju,null);I(this,Nr,!1);I(this,li,null);I(this,Dr,null);I(this,Fp,null);I(this,Lr,null);I(this,Vp,null);I(this,Pl,null);I(this,Nl,!1);var p;w(this,Et,e),w(this,Vp,i),w(this,Pr,o),w(this,Lr,a),w(this,Op,l),w(this,Rl,t),w(this,Fp,u),w(this,Ju,d),w(this,Mp,s),w(this,Qu,jT.toDateObject(r)),this.trigger=s.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",c(this,Yu)),m.addEventListener("mouseenter",c(this,L_)),m.addEventListener("mouseleave",c(this,D_)),m.classList.add("popupTriggerArea");for(const m of s)(p=m.container)==null||p.addEventListener("keydown",c(this,Xu));c(this,Et).hidden=!0,f&&x(this,Ye,fy).call(this)}render(){if(c(this,li))return;const e=w(this,li,document.createElement("div"));if(e.className="popup",c(this,Rl)){const r=e.style.outlineColor=le.makeHexColor(...c(this,Rl));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=le.makeHexColor(...c(this,Rl).map(a=>Math.floor(.7*(255-a)+a)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=c(this,Vp),e.append(t),c(this,Qu)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:c(this,Qu).valueOf()})),t.append(r)}const i=c(this,Ye,dy);if(i)ID.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(c(this,Pr));e.append(r)}c(this,Et).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,o=i.length;r<o;++r){const a=i[r];s.append(document.createTextNode(a)),r<o-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;c(this,Pl)||w(this,Pl,{contentsObj:c(this,Pr),richText:c(this,Lr)}),e&&w(this,Dr,null),t&&(w(this,Lr,x(this,Ye,DD).call(this,t)),w(this,Pr,null)),(s=c(this,li))==null||s.remove(),w(this,li,null)}resetEdited(){var e;c(this,Pl)&&({contentsObj:Ln(this,Pr)._,richText:Ln(this,Lr)._}=c(this,Pl),w(this,Pl,null),(e=c(this,li))==null||e.remove(),w(this,li,null),w(this,Dr,null))}forceHide(){w(this,Nl,this.isVisible),c(this,Nl)&&(c(this,Et).hidden=!0)}maybeShow(){c(this,Nl)&&(c(this,li)||x(this,Ye,py).call(this),w(this,Nl,!1),c(this,Et).hidden=!1)}get isVisible(){return c(this,Et).hidden===!1}}Xu=new WeakMap,D_=new WeakMap,L_=new WeakMap,Yu=new WeakMap,Rl=new WeakMap,Et=new WeakMap,Pr=new WeakMap,Qu=new WeakMap,Mp=new WeakMap,Op=new WeakMap,Ju=new WeakMap,Nr=new WeakMap,li=new WeakMap,Dr=new WeakMap,Fp=new WeakMap,Lr=new WeakMap,Vp=new WeakMap,Pl=new WeakMap,Nl=new WeakMap,Ye=new WeakSet,dy=function(){const e=c(this,Lr),t=c(this,Pr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&c(this,Lr).html||null},lA=function(){var e,t,s;return((s=(t=(e=c(this,Ye,dy))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},ND=function(){var e,t,s;return((s=(t=(e=c(this,Ye,dy))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},DD=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:c(this,Ye,ND),fontSize:c(this,Ye,lA)?`calc(${c(this,Ye,lA)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},LD=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&c(this,Nr))&&x(this,Ye,fy).call(this)},MD=function(){if(c(this,Dr)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=c(this,Op);let o=!!c(this,Ju),a=o?c(this,Ju):c(this,Fp);for(const y of c(this,Mp))if(!a||le.intersect(y.data.rect,a)!==null){a=y.data.rect,o=!0;break}const l=le.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),d=o?a[2]-a[0]+5:0,f=l[0]+d,p=l[1];w(this,Dr,[100*(f-i)/t,100*(p-r)/s]);const{style:m}=c(this,Et);m.left=`${c(this,Dr)[0]}%`,m.top=`${c(this,Dr)[1]}%`},fy=function(){w(this,Nr,!c(this,Nr)),c(this,Nr)?(x(this,Ye,py).call(this),c(this,Et).addEventListener("click",c(this,Yu)),c(this,Et).addEventListener("keydown",c(this,Xu))):(x(this,Ye,cA).call(this),c(this,Et).removeEventListener("click",c(this,Yu)),c(this,Et).removeEventListener("keydown",c(this,Xu)))},py=function(){c(this,li)||this.render(),this.isVisible?c(this,Nr)&&c(this,Et).classList.add("focused"):(x(this,Ye,MD).call(this),c(this,Et).hidden=!1,c(this,Et).style.zIndex=parseInt(c(this,Et).style.zIndex)+1e3)},cA=function(){c(this,Et).classList.remove("focused"),!(c(this,Nr)||!this.isVisible)&&(c(this,Et).hidden=!0,c(this,Et).style.zIndex=parseInt(c(this,Et).style.zIndex)-1e3)};class OD extends kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ae.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var jp;class H$ extends kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});I(this,jp,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:i}=ma(t.rect),r=this.svgFactory.create(s,i,!0),o=w(this,jp,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,jp)}addHighlightArea(){this.container.classList.add("highlightArea")}}jp=new WeakMap;var Up;class W$ extends kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});I(this,Up,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:i}=ma(t.rect),r=this.svgFactory.create(s,i,!0),o=t.borderStyle.width,a=w(this,Up,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",s-o),a.setAttribute("height",i-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Up)}addHighlightArea(){this.container.classList.add("highlightArea")}}Up=new WeakMap;var Bp;class G$ extends kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});I(this,Bp,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:i}=ma(t.rect),r=this.svgFactory.create(s,i,!0),o=t.borderStyle.width,a=w(this,Bp,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",s/2),a.setAttribute("cy",i/2),a.setAttribute("rx",s/2-o/2),a.setAttribute("ry",i/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Bp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bp=new WeakMap;var zp;class FD extends kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});I(this,zp,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r}}=this;if(!s)return this.container;const{width:o,height:a}=ma(t),l=this.svgFactory.create(o,a,!0);let u=[];for(let f=0,p=s.length;f<p;f+=2){const m=s[f]-t[0],y=t[3]-s[f+1];u.push(`${m},${y}`)}u=u.join(" ");const d=w(this,zp,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",u),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,zp)}addHighlightArea(){this.container.classList.add("highlightArea")}}zp=new WeakMap;class q$ extends FD{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class K$ extends kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var $p,Dl,Hp,uA;class HT extends kt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});I(this,Hp);I(this,$p,null);I(this,Dl,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ae.HIGHLIGHT:Ae.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:o}}=this,{transform:a,width:l,height:u}=x(this,Hp,uA).call(this,s,t),d=this.svgFactory.create(l,u,!0),f=w(this,$p,this.svgFactory.createElement("svg:g"));d.append(f),f.setAttribute("stroke-width",r.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",a);for(let p=0,m=i.length;p<m;p++){const y=this.svgFactory.createElement(this.svgElementName);c(this,Dl).push(y),y.setAttribute("points",i[p].join(",")),f.append(y)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,o=c(this,$p);if(s>=0&&o.setAttribute("stroke-width",s||1),i)for(let a=0,l=c(this,Dl).length;a<l;a++)c(this,Dl)[a].setAttribute("points",i[a].join(","));if(r){const{transform:a,width:l,height:u}=x(this,Hp,uA).call(this,this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return c(this,Dl)}addHighlightArea(){this.container.classList.add("highlightArea")}}$p=new WeakMap,Dl=new WeakMap,Hp=new WeakSet,uA=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class VD extends kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ae.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class X$ extends kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Y$ extends kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Q$ extends kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class jD extends kt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ae.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Wp,Gp,hA;class J$ extends kt{constructor(t){var i;super(t,{isRenderable:!0});I(this,Gp);I(this,Wp,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",x(this,Gp,hA).bind(this)),w(this,Wp,i);const{isMac:r}=Wn.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&x(this,Gp,hA).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return c(this,Wp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Wp=new WeakMap,Gp=new WeakSet,hA=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var qp,Ll,Ml,Kp,gc,UD,dA;class Z${constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:o,structTreeLayer:a}){I(this,gc);I(this,qp,null);I(this,Ll,null);I(this,Ml,new Map);I(this,Kp,null);this.div=e,w(this,qp,t),w(this,Ll,s),w(this,Kp,a||null),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return c(this,Ml).size>0}async render(e){var o;const{annotations:t}=e,s=this.div;dc(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new $T,annotationStorage:e.annotationStorage||new BT,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const l=a.annotationType===Mt.POPUP;if(l){const f=i.get(a.id);if(!f)continue;r.elements=f}else{const{width:f,height:p}=ma(a.rect);if(f<=0||p<=0)continue}r.data=a;const u=O$.create(r);if(!u.isRenderable)continue;if(!l&&a.popupRef){const f=i.get(a.popupRef);f?f.push(u):i.set(a.popupRef,[u])}const d=u.render();a.hidden&&(d.style.visibility="hidden"),await x(this,gc,UD).call(this,d,a.id),u._isEditable&&(c(this,Ml).set(u.data.id,u),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(u))}x(this,gc,dA).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,dc(t,{rotation:e.rotation}),x(this,gc,dA).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(c(this,Ml).values())}getEditableAnnotation(e){return c(this,Ml).get(e)}}qp=new WeakMap,Ll=new WeakMap,Ml=new WeakMap,Kp=new WeakMap,gc=new WeakSet,UD=async function(e,t){var o,a;const s=e.firstChild||e,i=s.id=`${OT}${t}`,r=await((o=c(this,Kp))==null?void 0:o.getAriaAttributes(i));if(r)for(const[l,u]of r)s.setAttribute(l,u);this.div.append(e),(a=c(this,qp))==null||a.moveElementInDOM(this.div,e,s,!1)},dA=function(){if(!c(this,Ll))return;const e=this.div;for(const[t,s]of c(this,Ll)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:r}=i;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):i.append(s)}c(this,Ll).clear()};const Pm=/\r\n?|\n/g;var ci,ds,Xp,Ol,fs,Lt,BD,zD,$D,gy,eo,my,yy,HD,pA,WD;const et=class et extends mt{constructor(t){super({...t,name:"freeTextEditor"});I(this,Lt);I(this,ci);I(this,ds,"");I(this,Xp,`${this.id}-editor`);I(this,Ol,null);I(this,fs);w(this,ci,t.color||et._defaultColor||mt._defaultLineColor),w(this,fs,t.fontSize||et._defaultFontSize)}static get _keyboardManager(){const t=et.prototype,s=o=>o.isEmpty(),i=fc.TRANSLATE_SMALL,r=fc.TRANSLATE_BIG;return xe(this,"_keyboardManager",new Mg([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){mt.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case Pe.FREETEXT_SIZE:et._defaultFontSize=s;break;case Pe.FREETEXT_COLOR:et._defaultColor=s;break}}updateParams(t,s){switch(t){case Pe.FREETEXT_SIZE:x(this,Lt,BD).call(this,s);break;case Pe.FREETEXT_COLOR:x(this,Lt,zD).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Pe.FREETEXT_SIZE,et._defaultFontSize],[Pe.FREETEXT_COLOR,et._defaultColor||mt._defaultLineColor]]}get propertiesToUpdate(){return[[Pe.FREETEXT_SIZE,c(this,fs)],[Pe.FREETEXT_COLOR,c(this,ci)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-et._internalPadding*t,-(et._internalPadding+c(this,fs))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Ae.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),w(this,Ol,new AbortController);const t=this._uiManager.combinedSignal(c(this,Ol));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",c(this,Xp)),this._isDraggable=!0,(t=c(this,Ol))==null||t.abort(),w(this,Ol,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var t;this.width||(this.enableEditMode(),this.editorDiv.focus(),(t=this._initialOptions)!=null&&t.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=c(this,ds),s=w(this,ds,x(this,Lt,$D).call(this).trimEnd());if(t===s)return;const i=r=>{if(w(this,ds,r),!r){this.remove();return}x(this,Lt,yy).call(this),this._uiManager.rebuild(this),x(this,Lt,gy).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),x(this,Lt,gy).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){et._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",c(this,Xp)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${c(this,fs)}px * var(--scale-factor))`,i.color=c(this,ci),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),g_(this,this.div,["dblclick","keydown"]),this.width){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[d,f]=this.pageDimensions,[p,m]=this.pageTranslation;let y,E;switch(this.rotation){case 0:y=t+(a[0]-p)/d,E=s+this.height-(a[1]-m)/f;break;case 90:y=t+(a[0]-p)/d,E=s-(a[1]-m)/f,[l,u]=[u,-l];break;case 180:y=t-this.width+(a[0]-p)/d,E=s-(a[1]-m)/f,[l,u]=[-l,-u];break;case 270:y=t+(a[0]-p-this.height*f)/d,E=s+(a[1]-m-this.width*d)/f,[l,u]=[-u,l];break}this.setAt(y*r,E*o,l,u)}else this.setAt(t*r,s*o,this.width*r,this.height*o);x(this,Lt,yy).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,E,k;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=x(y=et,eo,pA).call(y,s.getData("text")||"").replaceAll(Pm,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:l,startOffset:u}=a,d=[],f=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(f.push(l.nodeValue.slice(u).replaceAll(Pm,"")),v!==this.editorDiv){let A=d;for(const C of this.editorDiv.childNodes){if(C===v){A=f;continue}A.push(x(E=et,eo,my).call(E,C))}}d.push(l.nodeValue.slice(0,u).replaceAll(Pm,""))}else if(l===this.editorDiv){let v=d,A=0;for(const C of this.editorDiv.childNodes)A++===u&&(v=f),v.push(x(k=et,eo,my).call(k,C))}w(this,ds,`${d.join(`
`)}${r}${f.join(`
`)}`),x(this,Lt,yy).call(this);const p=new Range;let m=d.reduce((v,A)=>v+A.length,0);for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const A=v.nodeValue.length;if(m<=A){p.setStart(v,m),p.setEnd(v,m);break}m-=A}o.removeAllRanges(),o.addRange(p)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var a;let r=null;if(t instanceof OD){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:d,rotation:f,id:p,popupRef:m},textContent:y,textPosition:E,parent:{page:{pageNumber:k}}}=t;if(!y||y.length===0)return null;r=t={annotationType:Ae.FREETEXT,color:Array.from(u),fontSize:l,value:y.join(`
`),position:E,pageIndex:k-1,rect:d.slice(0),rotation:f,id:p,deleted:!1,popupRef:m}}const o=await super.deserialize(t,s,i);return w(o,fs,t.fontSize),w(o,ci,le.makeHexColor(...t.color)),w(o,ds,x(a=et,eo,pA).call(a,t.value)),o.annotationElementId=t.id||null,o._initialData=r,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=et._internalPadding*this.parentScale,i=this.getRect(s,s),r=mt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:c(this,ci)),o={annotationType:Ae.FREETEXT,color:r,fontSize:c(this,fs),value:x(this,Lt,HD).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?o:this.annotationElementId&&!x(this,Lt,WD).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${c(this,fs)}px * var(--scale-factor))`,i.color=c(this,ci),s.replaceChildren();for(const o of c(this,ds).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),s.append(a)}const r=et._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:c(this,ds)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};ci=new WeakMap,ds=new WeakMap,Xp=new WeakMap,Ol=new WeakMap,fs=new WeakMap,Lt=new WeakSet,BD=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-c(this,fs))*this.parentScale),w(this,fs,r),x(this,Lt,gy).call(this)},i=c(this,fs);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},zD=function(t){const s=r=>{w(this,ci,this.editorDiv.style.color=r)},i=c(this,ci);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},$D=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(x(i=et,eo,my).call(i,r)),s=r);return t.join(`
`)},gy=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,a=o.style.display,l=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},eo=new WeakSet,my=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Pm,"")},yy=function(){if(this.editorDiv.replaceChildren(),!!c(this,ds))for(const t of c(this,ds).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},HD=function(){return c(this,ds).replaceAll(""," ")},pA=function(t){return t.replaceAll(" ","")},WD=function(t){const{value:s,fontSize:i,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((a,l)=>a!==r[l])||t.pageIndex!==o},I(et,eo),ue(et,"_freeTextDefaultContent",""),ue(et,"_internalPadding",0),ue(et,"_defaultColor",null),ue(et,"_defaultFontSize",10),ue(et,"_type","freetext"),ue(et,"_editorType",Ae.FREETEXT);let fA=et;class ee{toSVGPath(){Xe("Abstract method `toSVGPath` must be implemented.")}get box(){Xe("Abstract getter `box` must be implemented.")}serialize(e,t){Xe("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*i,o[a+1]=s+e[a+1]*r;return o}static _rescaleAndSwap(e,t,s,i,r,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*i,o[a+1]=s+e[a]*r;return o}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,o=e.length;r<o;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,o){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+o)/6,(s+r)/2,(i+o)/2]}}ue(ee,"PRECISION",1e-4);var ps,ui,Zu,eh,zi,Se,Fl,Vl,Yp,Qp,th,nh,qo,Jp,M_,O_,zt,Kd,GD,qD,KD,XD,YD,QD;const _r=class _r{constructor({x:e,y:t},s,i,r,o,a=0){I(this,zt);I(this,ps);I(this,ui,[]);I(this,Zu);I(this,eh);I(this,zi,[]);I(this,Se,new Float32Array(18));I(this,Fl);I(this,Vl);I(this,Yp);I(this,Qp);I(this,th);I(this,nh);I(this,qo,[]);w(this,ps,s),w(this,nh,r*i),w(this,eh,o),c(this,Se).set([NaN,NaN,NaN,NaN,e,t],6),w(this,Zu,a),w(this,Qp,c(_r,Jp)*i),w(this,Yp,c(_r,O_)*i),w(this,th,i),c(this,qo).push(e,t)}isEmpty(){return isNaN(c(this,Se)[8])}add({x:e,y:t}){var P;w(this,Fl,e),w(this,Vl,t);const[s,i,r,o]=c(this,ps);let[a,l,u,d]=c(this,Se).subarray(8,12);const f=e-u,p=t-d,m=Math.hypot(f,p);if(m<c(this,Yp))return!1;const y=m-c(this,Qp),E=y/m,k=E*f,v=E*p;let A=a,C=l;a=u,l=d,u+=k,d+=v,(P=c(this,qo))==null||P.push(e,t);const N=-v/y,F=k/y,V=N*c(this,nh),S=F*c(this,nh);return c(this,Se).set(c(this,Se).subarray(2,8),0),c(this,Se).set([u+V,d+S],4),c(this,Se).set(c(this,Se).subarray(14,18),12),c(this,Se).set([u-V,d-S],16),isNaN(c(this,Se)[6])?(c(this,zi).length===0&&(c(this,Se).set([a+V,l+S],2),c(this,zi).push(NaN,NaN,NaN,NaN,(a+V-s)/r,(l+S-i)/o),c(this,Se).set([a-V,l-S],14),c(this,ui).push(NaN,NaN,NaN,NaN,(a-V-s)/r,(l-S-i)/o)),c(this,Se).set([A,C,a,l,u,d],6),!this.isEmpty()):(c(this,Se).set([A,C,a,l,u,d],6),Math.abs(Math.atan2(C-l,A-a)-Math.atan2(v,k))<Math.PI/2?([a,l,u,d]=c(this,Se).subarray(2,6),c(this,zi).push(NaN,NaN,NaN,NaN,((a+u)/2-s)/r,((l+d)/2-i)/o),[a,l,A,C]=c(this,Se).subarray(14,18),c(this,ui).push(NaN,NaN,NaN,NaN,((A+a)/2-s)/r,((C+l)/2-i)/o),!0):([A,C,a,l,u,d]=c(this,Se).subarray(0,6),c(this,zi).push(((A+5*a)/6-s)/r,((C+5*l)/6-i)/o,((5*a+u)/6-s)/r,((5*l+d)/6-i)/o,((a+u)/2-s)/r,((l+d)/2-i)/o),[u,d,a,l,A,C]=c(this,Se).subarray(12,18),c(this,ui).push(((A+5*a)/6-s)/r,((C+5*l)/6-i)/o,((5*a+u)/6-s)/r,((5*l+d)/6-i)/o,((a+u)/2-s)/r,((l+d)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=c(this,zi),t=c(this,ui);if(isNaN(c(this,Se)[6])&&!this.isEmpty())return x(this,zt,GD).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);x(this,zt,KD).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return x(this,zt,qD).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,o){return new JD(e,t,s,i,r,o)}getOutlines(){var f;const e=c(this,zi),t=c(this,ui),s=c(this,Se),[i,r,o,a]=c(this,ps),l=new Float32Array((((f=c(this,qo))==null?void 0:f.length)??0)+2);for(let p=0,m=l.length-2;p<m;p+=2)l[p]=(c(this,qo)[p]-i)/o,l[p+1]=(c(this,qo)[p+1]-r)/a;if(l[l.length-2]=(c(this,Fl)-i)/o,l[l.length-1]=(c(this,Vl)-r)/a,isNaN(s[6])&&!this.isEmpty())return x(this,zt,XD).call(this,l);const u=new Float32Array(c(this,zi).length+24+c(this,ui).length);let d=e.length;for(let p=0;p<d;p+=2){if(isNaN(e[p])){u[p]=u[p+1]=NaN;continue}u[p]=e[p],u[p+1]=e[p+1]}d=x(this,zt,QD).call(this,u,d);for(let p=t.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(t[p+m])){u[d]=u[d+1]=NaN,d+=2;continue}u[d]=t[p+m],u[d+1]=t[p+m+1],d+=2}return x(this,zt,YD).call(this,u,d),this.newFreeDrawOutline(u,l,c(this,ps),c(this,th),c(this,Zu),c(this,eh))}};ps=new WeakMap,ui=new WeakMap,Zu=new WeakMap,eh=new WeakMap,zi=new WeakMap,Se=new WeakMap,Fl=new WeakMap,Vl=new WeakMap,Yp=new WeakMap,Qp=new WeakMap,th=new WeakMap,nh=new WeakMap,qo=new WeakMap,Jp=new WeakMap,M_=new WeakMap,O_=new WeakMap,zt=new WeakSet,Kd=function(){const e=c(this,Se).subarray(4,6),t=c(this,Se).subarray(16,18),[s,i,r,o]=c(this,ps);return[(c(this,Fl)+(e[0]-t[0])/2-s)/r,(c(this,Vl)+(e[1]-t[1])/2-i)/o,(c(this,Fl)+(t[0]-e[0])/2-s)/r,(c(this,Vl)+(t[1]-e[1])/2-i)/o]},GD=function(){const[e,t,s,i]=c(this,ps),[r,o,a,l]=x(this,zt,Kd).call(this);return`M${(c(this,Se)[2]-e)/s} ${(c(this,Se)[3]-t)/i} L${(c(this,Se)[4]-e)/s} ${(c(this,Se)[5]-t)/i} L${r} ${o} L${a} ${l} L${(c(this,Se)[16]-e)/s} ${(c(this,Se)[17]-t)/i} L${(c(this,Se)[14]-e)/s} ${(c(this,Se)[15]-t)/i} Z`},qD=function(e){const t=c(this,ui);e.push(`L${t[4]} ${t[5]} Z`)},KD=function(e){const[t,s,i,r]=c(this,ps),o=c(this,Se).subarray(4,6),a=c(this,Se).subarray(16,18),[l,u,d,f]=x(this,zt,Kd).call(this);e.push(`L${(o[0]-t)/i} ${(o[1]-s)/r} L${l} ${u} L${d} ${f} L${(a[0]-t)/i} ${(a[1]-s)/r}`)},XD=function(e){const t=c(this,Se),[s,i,r,o]=c(this,ps),[a,l,u,d]=x(this,zt,Kd).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/o],0),this.newFreeDrawOutline(f,e,c(this,ps),c(this,th),c(this,Zu),c(this,eh))},YD=function(e,t){const s=c(this,ui);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},QD=function(e,t){const s=c(this,Se).subarray(4,6),i=c(this,Se).subarray(16,18),[r,o,a,l]=c(this,ps),[u,d,f,p]=x(this,zt,Kd).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-o)/l],t),t+=24},I(_r,Jp,8),I(_r,M_,2),I(_r,O_,c(_r,Jp)+c(_r,M_));let y_=_r;var sh,jl,Mr,Zp,gs,eg,xt,F_,ZD;class JD extends ee{constructor(t,s,i,r,o,a){super();I(this,F_);I(this,sh);I(this,jl,new Float32Array(4));I(this,Mr);I(this,Zp);I(this,gs);I(this,eg);I(this,xt);w(this,xt,t),w(this,gs,s),w(this,sh,i),w(this,eg,r),w(this,Mr,o),w(this,Zp,a),this.lastPoint=[NaN,NaN],x(this,F_,ZD).call(this,a);const[l,u,d,f]=c(this,jl);for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-l)/d,t[p+1]=(t[p+1]-u)/f;for(let p=0,m=s.length;p<m;p+=2)s[p]=(s[p]-l)/d,s[p+1]=(s[p+1]-u)/f}toSVGPath(){const t=[`M${c(this,xt)[4]} ${c(this,xt)[5]}`];for(let s=6,i=c(this,xt).length;s<i;s+=6){if(isNaN(c(this,xt)[s])){t.push(`L${c(this,xt)[s+4]} ${c(this,xt)[s+5]}`);continue}t.push(`C${c(this,xt)[s]} ${c(this,xt)[s+1]} ${c(this,xt)[s+2]} ${c(this,xt)[s+3]} ${c(this,xt)[s+4]} ${c(this,xt)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],o){const a=i-t,l=r-s;let u,d;switch(o){case 0:u=ee._rescale(c(this,xt),t,r,a,-l),d=ee._rescale(c(this,gs),t,r,a,-l);break;case 90:u=ee._rescaleAndSwap(c(this,xt),t,s,a,l),d=ee._rescaleAndSwap(c(this,gs),t,s,a,l);break;case 180:u=ee._rescale(c(this,xt),i,s,-a,l),d=ee._rescale(c(this,gs),i,s,-a,l);break;case 270:u=ee._rescaleAndSwap(c(this,xt),i,r,-a,-l),d=ee._rescaleAndSwap(c(this,gs),i,r,-a,-l);break}return{outline:Array.from(u),points:[Array.from(d)]}}get box(){return c(this,jl)}newOutliner(t,s,i,r,o,a=0){return new y_(t,s,i,r,o,a)}getNewOutline(t,s){const[i,r,o,a]=c(this,jl),[l,u,d,f]=c(this,sh),p=o*d,m=a*f,y=i*d+l,E=r*f+u,k=this.newOutliner({x:c(this,gs)[0]*p+y,y:c(this,gs)[1]*m+E},c(this,sh),c(this,eg),t,c(this,Zp),s??c(this,Mr));for(let v=2;v<c(this,gs).length;v+=2)k.add({x:c(this,gs)[v]*p+y,y:c(this,gs)[v+1]*m+E});return k.getOutlines()}}sh=new WeakMap,jl=new WeakMap,Mr=new WeakMap,Zp=new WeakMap,gs=new WeakMap,eg=new WeakMap,xt=new WeakMap,F_=new WeakSet,ZD=function(t){const s=c(this,xt);let i=s[4],r=s[5],o=i,a=r,l=i,u=r,d=i,f=r;const p=t?Math.max:Math.min;for(let y=6,E=s.length;y<E;y+=6){if(isNaN(s[y]))o=Math.min(o,s[y+4]),a=Math.min(a,s[y+5]),l=Math.max(l,s[y+4]),u=Math.max(u,s[y+5]),f<s[y+5]?(d=s[y+4],f=s[y+5]):f===s[y+5]&&(d=p(d,s[y+4]));else{const k=le.bezierBoundingBox(i,r,...s.slice(y,y+6));o=Math.min(o,k[0]),a=Math.min(a,k[1]),l=Math.max(l,k[2]),u=Math.max(u,k[3]),f<k[3]?(d=k[2],f=k[3]):f===k[3]&&(d=p(d,k[2]))}i=s[y+4],r=s[y+5]}const m=c(this,jl);m[0]=o-c(this,Mr),m[1]=a-c(this,Mr),m[2]=l-o+2*c(this,Mr),m[3]=u-a+2*c(this,Mr),this.lastPoint=[d,f]};var tg,ng,Ko,hi,qn,e2,_y,t2,n2,mA;class gA{constructor(e,t=0,s=0,i=!0){I(this,qn);I(this,tg);I(this,ng);I(this,Ko,[]);I(this,hi,[]);let r=1/0,o=-1/0,a=1/0,l=-1/0;const u=10**-4;for(const{x:k,y:v,width:A,height:C}of e){const N=Math.floor((k-t)/u)*u,F=Math.ceil((k+A+t)/u)*u,V=Math.floor((v-t)/u)*u,S=Math.ceil((v+C+t)/u)*u,T=[N,V,S,!0],P=[F,V,S,!1];c(this,Ko).push(T,P),r=Math.min(r,N),o=Math.max(o,F),a=Math.min(a,V),l=Math.max(l,S)}const d=o-r+2*s,f=l-a+2*s,p=r-s,m=a-s,y=c(this,Ko).at(i?-1:-2),E=[y[0],y[2]];for(const k of c(this,Ko)){const[v,A,C]=k;k[0]=(v-p)/d,k[1]=(A-m)/f,k[2]=(C-m)/f}w(this,tg,new Float32Array([p,m,d,f])),w(this,ng,E)}getOutlines(){c(this,Ko).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of c(this,Ko))t[3]?(e.push(...x(this,qn,mA).call(this,t)),x(this,qn,t2).call(this,t)):(x(this,qn,n2).call(this,t),e.push(...x(this,qn,mA).call(this,t)));return x(this,qn,e2).call(this,e)}}tg=new WeakMap,ng=new WeakMap,Ko=new WeakMap,hi=new WeakMap,qn=new WeakSet,e2=function(e){const t=[],s=new Set;for(const o of e){const[a,l,u]=o;t.push([a,l,o],[a,u,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const l=t[o][2],u=t[o+1][2];l.push(u),u.push(l),s.add(l),s.add(u)}const i=[];let r;for(;s.size>0;){const o=s.values().next().value;let[a,l,u,d,f]=o;s.delete(o);let p=a,m=l;for(r=[a,u],i.push(r);;){let y;if(s.has(d))y=d;else if(s.has(f))y=f;else break;s.delete(y),[a,l,u,d,f]=y,p!==a&&(r.push(p,m,a,m===l?l:u),p=a),m=m===l?u:l}r.push(p,m)}return new e5(i,c(this,tg),c(this,ng))},_y=function(e){const t=c(this,hi);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,o=t[r][0];if(o===e)return r;o<e?s=r+1:i=r-1}return i+1},t2=function([,e,t]){const s=x(this,qn,_y).call(this,e);c(this,hi).splice(s,0,[e,t])},n2=function([,e,t]){const s=x(this,qn,_y).call(this,e);for(let i=s;i<c(this,hi).length;i++){const[r,o]=c(this,hi)[i];if(r!==e)break;if(r===e&&o===t){c(this,hi).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,o]=c(this,hi)[i];if(r!==e)break;if(r===e&&o===t){c(this,hi).splice(i,1);return}}},mA=function(e){const[t,s,i]=e,r=[[t,s,i]],o=x(this,qn,_y).call(this,i);for(let a=0;a<o;a++){const[l,u]=c(this,hi)[a];for(let d=0,f=r.length;d<f;d++){const[,p,m]=r[d];if(!(u<=p||m<=l)){if(p>=l){if(m>u)r[d][1]=u;else{if(f===1)return[];r.splice(d,1),d--,f--}continue}r[d][2]=l,m>u&&r.push([t,u,m])}}}return r};var sg,ih;class e5 extends ee{constructor(t,s,i){super();I(this,sg);I(this,ih);w(this,ih,t),w(this,sg,s),this.lastPoint=i}toSVGPath(){const t=[];for(const s of c(this,ih)){let[i,r]=s;t.push(`M${i} ${r}`);for(let o=2;o<s.length;o+=2){const a=s[o],l=s[o+1];a===i?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],o){const a=[],l=i-t,u=r-s;for(const d of c(this,ih)){const f=new Array(d.length);for(let p=0;p<d.length;p+=2)f[p]=t+d[p]*l,f[p+1]=r-d[p+1]*u;a.push(f)}return a}get box(){return c(this,sg)}get classNamesForOutlining(){return["highlightOutline"]}}sg=new WeakMap,ih=new WeakMap;class yA extends y_{newFreeDrawOutline(e,t,s,i,r,o){return new t5(e,t,s,i,r,o)}}class t5 extends JD{newOutliner(e,t,s,i,r,o=0){return new yA(e,t,s,i,r,o)}}var di,Ul,rh,Vt,ig,oh,rg,og,Xo,fi,ah,ag,Ke,_A,vA,wA,$a,s2,yo;const Qn=class Qn{constructor({editor:e=null,uiManager:t=null}){I(this,Ke);I(this,di,null);I(this,Ul,null);I(this,rh);I(this,Vt,null);I(this,ig,!1);I(this,oh,!1);I(this,rg,null);I(this,og);I(this,Xo,null);I(this,fi,null);I(this,ah);var s;e?(w(this,oh,!1),w(this,ah,Pe.HIGHLIGHT_COLOR),w(this,rg,e)):(w(this,oh,!0),w(this,ah,Pe.HIGHLIGHT_DEFAULT_COLOR)),w(this,fi,(e==null?void 0:e._uiManager)||t),w(this,og,c(this,fi)._eventBus),w(this,rh,(e==null?void 0:e.color)||((s=c(this,fi))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),c(Qn,ag)||w(Qn,ag,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return xe(this,"_keyboardManager",new Mg([[["Escape","mac+Escape"],Qn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Qn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Qn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Qn.prototype._moveToPrevious],[["Home","mac+Home"],Qn.prototype._moveToBeginning],[["End","mac+End"],Qn.prototype._moveToEnd]]))}renderButton(){const e=w(this,di,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=c(this,fi)._signal;e.addEventListener("click",x(this,Ke,$a).bind(this),{signal:t}),e.addEventListener("keydown",x(this,Ke,wA).bind(this),{signal:t});const s=w(this,Ul,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=c(this,rh),e.append(s),e}renderMainDropdown(){const e=w(this,Vt,x(this,Ke,_A).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===c(this,di)){x(this,Ke,$a).call(this,e);return}const t=e.target.getAttribute("data-color");t&&x(this,Ke,vA).call(this,t,e)}_moveToNext(e){var t,s;if(!c(this,Ke,yo)){x(this,Ke,$a).call(this,e);return}if(e.target===c(this,di)){(t=c(this,Vt).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=c(this,Vt))==null?void 0:t.firstChild)||e.target===c(this,di)){c(this,Ke,yo)&&this._hideDropdownFromKeyboard();return}c(this,Ke,yo)||x(this,Ke,$a).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!c(this,Ke,yo)){x(this,Ke,$a).call(this,e);return}(t=c(this,Vt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!c(this,Ke,yo)){x(this,Ke,$a).call(this,e);return}(t=c(this,Vt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=c(this,Vt))==null||e.classList.add("hidden"),(t=c(this,Xo))==null||t.abort(),w(this,Xo,null)}_hideDropdownFromKeyboard(){var e;if(!c(this,oh)){if(!c(this,Ke,yo)){(e=c(this,rg))==null||e.unselect();return}this.hideDropdown(),c(this,di).focus({preventScroll:!0,focusVisible:c(this,ig)})}}updateColor(e){if(c(this,Ul)&&(c(this,Ul).style.backgroundColor=e),!c(this,Vt))return;const t=c(this,fi).highlightColors.values();for(const s of c(this,Vt).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=c(this,di))==null||e.remove(),w(this,di,null),w(this,Ul,null),(t=c(this,Vt))==null||t.remove(),w(this,Vt,null)}};di=new WeakMap,Ul=new WeakMap,rh=new WeakMap,Vt=new WeakMap,ig=new WeakMap,oh=new WeakMap,rg=new WeakMap,og=new WeakMap,Xo=new WeakMap,fi=new WeakMap,ah=new WeakMap,ag=new WeakMap,Ke=new WeakSet,_A=function(){const e=document.createElement("div"),t=c(this,fi)._signal;e.addEventListener("contextmenu",Si,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of c(this,fi).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",c(Qn,ag)[s]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=i,r.setAttribute("aria-selected",i===c(this,rh)),r.addEventListener("click",x(this,Ke,vA).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",x(this,Ke,wA).bind(this),{signal:t}),e},vA=function(e,t){t.stopPropagation(),c(this,og).dispatch("switchannotationeditorparams",{source:this,type:c(this,ah),value:e})},wA=function(e){Qn._keyboardManager.exec(this,e)},$a=function(e){if(c(this,Ke,yo)){this.hideDropdown();return}if(w(this,ig,e.detail===0),c(this,Xo)||(w(this,Xo,new AbortController),window.addEventListener("pointerdown",x(this,Ke,s2).bind(this),{signal:c(this,fi).combinedSignal(c(this,Xo))})),c(this,Vt)){c(this,Vt).classList.remove("hidden");return}const t=w(this,Vt,x(this,Ke,_A).call(this));c(this,di).append(t)},s2=function(e){var t;(t=c(this,Vt))!=null&&t.contains(e.target)||this.hideDropdown()},yo=function(){return c(this,Vt)&&!c(this,Vt).classList.contains("hidden")},I(Qn,ag,null);let __=Qn;var lh,lg,Or,Bl,ch,es,cg,ug,zl,Vs,ms,sn,uh,Fr,Sn,hh,js,hg,we,EA,vy,i2,r2,o2,AA,Ha,Ws,zc,a2,wy,Xd,l2,c2,u2,h2,d2;const je=class je extends mt{constructor(t){super({...t,name:"highlightEditor"});I(this,we);I(this,lh,null);I(this,lg,0);I(this,Or);I(this,Bl,null);I(this,ch,null);I(this,es,null);I(this,cg,null);I(this,ug,0);I(this,zl,null);I(this,Vs,null);I(this,ms,null);I(this,sn,!1);I(this,uh,null);I(this,Fr);I(this,Sn,null);I(this,hh,"");I(this,js);I(this,hg,"");this.color=t.color||je._defaultColor,w(this,js,t.thickness||je._defaultThickness),w(this,Fr,t.opacity||je._defaultOpacity),w(this,Or,t.boxes||null),w(this,hg,t.methodOfCreation||""),w(this,hh,t.text||""),this._isDraggable=!1,t.highlightId>-1?(w(this,sn,!0),x(this,we,vy).call(this,t),x(this,we,Ha).call(this)):c(this,Or)&&(w(this,lh,t.anchorNode),w(this,lg,t.anchorOffset),w(this,cg,t.focusNode),w(this,ug,t.focusOffset),x(this,we,EA).call(this),x(this,we,Ha).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=je.prototype;return xe(this,"_keyboardManager",new Mg([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:c(this,sn)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:c(this,js),methodOfCreation:c(this,hg)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;mt.initialize(t,s),je._defaultColor||(je._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case Pe.HIGHLIGHT_DEFAULT_COLOR:je._defaultColor=s;break;case Pe.HIGHLIGHT_THICKNESS:je._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return c(this,uh)}updateParams(t,s){switch(t){case Pe.HIGHLIGHT_COLOR:x(this,we,i2).call(this,s);break;case Pe.HIGHLIGHT_THICKNESS:x(this,we,r2).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Pe.HIGHLIGHT_DEFAULT_COLOR,je._defaultColor],[Pe.HIGHLIGHT_THICKNESS,je._defaultThickness]]}get propertiesToUpdate(){return[[Pe.HIGHLIGHT_COLOR,this.color||je._defaultColor],[Pe.HIGHLIGHT_THICKNESS,c(this,js)||je._defaultThickness],[Pe.HIGHLIGHT_FREE,c(this,sn)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(w(this,ch,new __({editor:this})),t.addColorPicker(c(this,ch))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(x(this,we,Xd).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,x(this,we,Xd).call(this))}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this.div.focus()}remove(){x(this,we,AA).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,we,Ha).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?x(this,we,AA).call(this):t&&(x(this,we,Ha).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,o,a;const{drawLayer:s}=this.parent;let i;c(this,sn)?(t=(t-this.rotation+360)%360,i=x(r=je,Ws,zc).call(r,c(this,Vs).box,t)):i=x(o=je,Ws,zc).call(o,[this.x,this.y,this.width,this.height],t),s.updateProperties(c(this,ms),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(c(this,Sn),{bbox:x(a=je,Ws,zc).call(a,c(this,es).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();c(this,hh)&&(t.setAttribute("aria-label",c(this,hh)),t.setAttribute("role","mark")),c(this,sn)?t.classList.add("free"):this.div.addEventListener("keydown",x(this,we,a2).bind(this),{signal:this._uiManager._signal});const s=w(this,zl,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=c(this,Bl);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),g_(this,c(this,zl),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Sn),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Sn),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:x(this,we,wy).call(this,!0);break;case 1:case 3:x(this,we,wy).call(this,!1);break}}select(){var t;super.select(),c(this,Sn)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Sn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),c(this,Sn)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Sn),{rootClass:{selected:!1}}),c(this,sn)||x(this,we,wy).call(this,!1))}get _mustFixPosition(){return!c(this,sn)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(c(this,ms),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(c(this,Sn),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:o}){const{x:a,y:l,width:u,height:d}=i.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),m=y=>{f.abort(),x(this,Ws,h2).call(this,t,y)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",_i,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Si,{signal:p}),i.addEventListener("pointermove",x(this,Ws,u2).bind(this,t),{signal:p}),this._freeHighlight=new yA({x:r,y:o},[a,l,u,d],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var E,k,v,A;let r=null;if(t instanceof VD){const{data:{quadPoints:C,rect:N,rotation:F,id:V,color:S,opacity:T,popupRef:P},parent:{page:{pageNumber:D}}}=t;r=t={annotationType:Ae.HIGHLIGHT,color:Array.from(S),opacity:T,quadPoints:C,boxes:null,pageIndex:D-1,rect:N.slice(0),rotation:F,id:V,deleted:!1,popupRef:P}}else if(t instanceof HT){const{data:{inkLists:C,rect:N,rotation:F,id:V,color:S,borderStyle:{rawWidth:T},popupRef:P},parent:{page:{pageNumber:D}}}=t;r=t={annotationType:Ae.HIGHLIGHT,color:Array.from(S),thickness:T,inkLists:C,boxes:null,pageIndex:D-1,rect:N.slice(0),rotation:F,id:V,deleted:!1,popupRef:P}}const{color:o,quadPoints:a,inkLists:l,opacity:u}=t,d=await super.deserialize(t,s,i);d.color=le.makeHexColor(...o),w(d,Fr,u||1),l&&w(d,js,t.thickness),d.annotationElementId=t.id||null,d._initialData=r;const[f,p]=d.pageDimensions,[m,y]=d.pageTranslation;if(a){const C=w(d,Or,[]);for(let N=0;N<a.length;N+=8)C.push({x:(a[N]-m)/f,y:1-(a[N+1]-y)/p,width:(a[N+2]-a[N])/f,height:(a[N+1]-a[N+5])/p});x(E=d,we,EA).call(E),x(k=d,we,Ha).call(k),d.rotate(d.rotation)}else if(l){w(d,sn,!0);const C=l[0],N={x:C[0]-m,y:p-(C[1]-y)},F=new yA(N,[0,0,f,p],1,c(d,js)/2,!0,.001);for(let T=0,P=C.length;T<P;T+=2)N.x=C[T]-m,N.y=p-(C[T+1]-y),F.add(N);const{id:V,clipPathId:S}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:F.toSVGPath()}},!0,!0);x(v=d,we,vy).call(v,{highlightOutlines:F.getOutlines(),highlightId:V,clipPathId:S}),x(A=d,we,Ha).call(A)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=mt._colorManager.convert(this.color),r={annotationType:Ae.HIGHLIGHT,color:i,opacity:c(this,Fr),thickness:c(this,js),quadPoints:x(this,we,l2).call(this),outlines:x(this,we,c2).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:x(this,we,Xd).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!x(this,we,d2).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};lh=new WeakMap,lg=new WeakMap,Or=new WeakMap,Bl=new WeakMap,ch=new WeakMap,es=new WeakMap,cg=new WeakMap,ug=new WeakMap,zl=new WeakMap,Vs=new WeakMap,ms=new WeakMap,sn=new WeakMap,uh=new WeakMap,Fr=new WeakMap,Sn=new WeakMap,hh=new WeakMap,js=new WeakMap,hg=new WeakMap,we=new WeakSet,EA=function(){const t=new gA(c(this,Or),.001);w(this,Vs,t.getOutlines()),[this.x,this.y,this.width,this.height]=c(this,Vs).box;const s=new gA(c(this,Or),.0025,.001,this._uiManager.direction==="ltr");w(this,es,s.getOutlines());const{lastPoint:i}=c(this,es);w(this,uh,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},vy=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var f,p;if(w(this,Vs,t),w(this,es,t.getNewOutline(c(this,js)/2+1.5,.0025)),s>=0)w(this,ms,s),w(this,Bl,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),w(this,Sn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:c(this,es).box,path:{d:c(this,es).toSVGPath()}},!0));else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(c(this,ms),{bbox:x(f=je,Ws,zc).call(f,c(this,Vs).box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(c(this,Sn),{bbox:x(p=je,Ws,zc).call(p,c(this,es).box,m),path:{d:c(this,es).toSVGPath()}})}const[o,a,l,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=l,this.height=u;break;case 90:{const[m,y]=this.parentDimensions;this.x=a,this.y=1-o,this.width=l*y/m,this.height=u*m/y;break}case 180:this.x=1-o,this.y=1-a,this.width=l,this.height=u;break;case 270:{const[m,y]=this.parentDimensions;this.x=1-a,this.y=o,this.width=l*y/m,this.height=u*m/y;break}}const{lastPoint:d}=c(this,es);w(this,uh,[(d[0]-o)/l,(d[1]-a)/u])},i2=function(t){const s=(o,a)=>{var l,u;this.color=o,w(this,Fr,a),(l=this.parent)==null||l.drawLayer.updateProperties(c(this,ms),{root:{fill:o,"fill-opacity":a}}),(u=c(this,ch))==null||u.updateColor(o)},i=this.color,r=c(this,Fr);this.addCommands({cmd:s.bind(this,t,je._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},r2=function(t){const s=c(this,js),i=r=>{w(this,js,r),x(this,we,o2).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Pe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},o2=function(t){if(!c(this,sn))return;x(this,we,vy).call(this,{highlightOutlines:c(this,Vs).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},AA=function(){c(this,ms)===null||!this.parent||(this.parent.drawLayer.remove(c(this,ms)),w(this,ms,null),this.parent.drawLayer.remove(c(this,Sn)),w(this,Sn,null))},Ha=function(t=this.parent){c(this,ms)===null&&({id:Ln(this,ms)._,clipPathId:Ln(this,Bl)._}=t.drawLayer.draw({bbox:c(this,Vs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":c(this,Fr)},rootClass:{highlight:!0,free:c(this,sn)},path:{d:c(this,Vs).toSVGPath()}},!1,!0),w(this,Sn,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:c(this,sn)},bbox:c(this,es).box,path:{d:c(this,es).toSVGPath()}},c(this,sn))),c(this,zl)&&(c(this,zl).style.clipPath=c(this,Bl)))},Ws=new WeakSet,zc=function([t,s,i,r],o){switch(o){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},a2=function(t){je._keyboardManager.exec(this,t)},wy=function(t){if(!c(this,lh))return;const s=window.getSelection();t?s.setPosition(c(this,lh),c(this,lg)):s.setPosition(c(this,cg),c(this,ug))},Xd=function(){return c(this,sn)?this.rotation:0},l2=function(){if(c(this,sn))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,o=c(this,Or),a=new Float32Array(o.length*8);let l=0;for(const{x:u,y:d,width:f,height:p}of o){const m=u*t+i,y=(1-d)*s+r;a[l]=a[l+4]=m,a[l+1]=a[l+3]=y,a[l+2]=a[l+6]=m+f*t,a[l+5]=a[l+7]=y-p*s,l+=8}return a},c2=function(t){return c(this,Vs).serialize(t,x(this,we,Xd).call(this))},u2=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},h2=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},d2=function(t){const{color:s}=this._initialData;return t.color.some((i,r)=>i!==s[r])},I(je,Ws),ue(je,"_defaultColor",null),ue(je,"_defaultOpacity",1),ue(je,"_defaultThickness",12),ue(je,"_type","highlight"),ue(je,"_editorType",Ae.HIGHLIGHT),ue(je,"_freeHighlightId",-1),ue(je,"_freeHighlight",null),ue(je,"_freeHighlightClipId","");let v_=je;var $l;class n5{constructor(){I(this,$l,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){c(this,$l)[e]=t}toSVGProperties(){const e=c(this,$l);return w(this,$l,Object.create(null)),{root:e}}reset(){w(this,$l,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Xe("Not implemented")}}$l=new WeakMap;var ys,dh,Me,TA,SA,xA,Yd,f2,Ey,Qd,$c;const Ds=class Ds extends mt{constructor(t){super(t);I(this,Me);I(this,ys,null);I(this,dh);ue(this,"_drawId",null);w(this,dh,t.mustBeCommitted||!1),t.drawOutlines&&(x(this,Me,TA).call(this,t),x(this,Me,Yd).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,o]of Object.entries(s))i.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){Xe("Not implemented")}static get typesMap(){Xe("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(this._currentDraw.updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,o=r[s],a=l=>{var d;r.updateProperty(s,l);const u=c(this,ys).updateProperty(s,l);u&&x(this,Me,Qd).call(this,u),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ds._mergeSVGProperties(c(this,ys).getPathResizingSVGProperties(x(this,Me,Ey).call(this)),{bbox:x(this,Me,$c).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ds._mergeSVGProperties(c(this,ys).getPathResizedSVGProperties(x(this,Me,Ey).call(this)),{bbox:x(this,Me,$c).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:x(this,Me,$c).call(this,t,s)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Ds._mergeSVGProperties(c(this,ys).getPathTranslatedSVGProperties(x(this,Me,Ey).call(this),this.parentDimensions),{bbox:x(this,Me,$c).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,c(this,dh)&&(w(this,dh,!1),this.commit(),this.parent.setSelected(this),this.isOnScreen&&this.div.focus())}remove(){x(this,Me,xA).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,Me,Yd).call(this),x(this,Me,Qd).call(this,c(this,ys).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),x(this,Me,xA).call(this)):t&&(this._uiManager.addShouldRescale(this),x(this,Me,Yd).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Ds._mergeSVGProperties({bbox:x(this,Me,$c).call(this)},c(this,ys).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&x(this,Me,Qd).call(this,c(this,ys).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const s=document.createElement("div");t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,s,i,r,o){Xe("Not implemented")}static startDrawing(t,s,i,{target:r,offsetX:o,offsetY:a}){var m;const{viewport:{rotation:l}}=t,{width:u,height:d}=r.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f);if(window.addEventListener("pointerup",y=>{f.abort(),t.toggleDrawing(!0),this._endDraw(y)},{signal:p}),window.addEventListener("pointerdown",_i,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Si,{signal:p}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:p}),t.toggleDrawing(),(m=s._editorUndoBar)==null||m.hide(),this._currentDraw){t.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.startNew(o,a,u,d,l));return}s.updateUIForDefaultProperties(this),this._currentDraw=this.createDrawerInstance(o,a,u,d,l),this._currentDrawingOptions=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(this._currentDrawingOptions.toSVGProperties(),this._currentDraw.defaultSVGProperties),!0,!1)}static _drawMove({offsetX:t,offsetY:s}){this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.add(t,s))}static _endDraw({offsetX:t,offsetY:s}){const i=this._currentParent;if(i.drawLayer.updateProperties(this._currentDrawId,this._currentDraw.end(t,s)),this.supportMultipleDrawings){const r=this._currentDraw,o=this._currentDrawId,a=r.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(o,r.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(o,r.removeLastElement())},mustExec:!1,type:Pe.DRAW_STEP});return}this.endDrawing(!1)}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(Pe.DRAW_STEP),!this._currentDraw.isEmpty()){const{pageDimensions:[i,r],scale:o}=s,a=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:this._currentDraw.getOutlines(i*o,r*o,o,this._INNER_MARGIN),drawingOptions:this._currentDrawingOptions,mustBeCommitted:!t});return this._cleanup(),a}return s.drawLayer.remove(this._currentDrawId),this._cleanup(),null}static _cleanup(){this._currentDrawId=-1,this._currentDraw=null,this._currentDrawingOptions=null,this._currentParent=null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,o,a){Xe("Not implemented")}static async deserialize(t,s,i){var f,p;const{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:l}}=s.viewport,u=this.deserializeDraw(a,l,r,o,this._INNER_MARGIN,t),d=await super.deserialize(t,s,i);return d.createDrawingOptions(t),x(f=d,Me,TA).call(f,{drawOutlines:u}),x(p=d,Me,Yd).call(p),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[s,i]=this.pageTranslation,[r,o]=this.pageDimensions;return c(this,ys).serialize([s,i,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ys=new WeakMap,dh=new WeakMap,Me=new WeakSet,TA=function({drawOutlines:t,drawId:s,drawingOptions:i}){w(this,ys,t),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=x(this,Me,SA).call(this,t,this.parent),x(this,Me,Qd).call(this,t.box)},SA=function(t,s){const{id:i}=s.drawLayer.draw(Ds._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},xA=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Yd=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=x(this,Me,SA).call(this,c(this,ys),t)}},f2=function([t,s,i,r]){const{parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[s,1-t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},Ey=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[1-s,t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},Qd=function(t){if([this.x,this.y,this.width,this.height]=x(this,Me,f2).call(this,t),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},$c=function(){const{x:t,y:s,width:i,height:r,rotation:o,parentRotation:a,parentDimensions:[l,u]}=this;switch((o*4+a)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(l/u),r*(u/l),i*(l/u)];case 5:return[1-s,t,i*(l/u),r*(u/l)];case 6:return[1-t-r*(u/l),1-s,r*(u/l),i*(l/u)];case 7:return[s-i*(l/u),1-t-r*(u/l),i*(l/u),r*(u/l)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/l),s,r*(u/l),i*(l/u)];case 13:return[1-s-i*(l/u),t-r*(u/l),i*(l/u),r*(u/l)];case 14:return[1-t,1-s-i*(l/u),r*(u/l),i*(l/u)];case 15:return[s,1-t,i*(l/u),r*(u/l)];default:return[t,s,i,r]}},ue(Ds,"_currentDrawId",-1),ue(Ds,"_currentDraw",null),ue(Ds,"_currentDrawingOptions",null),ue(Ds,"_currentParent",null),ue(Ds,"_INNER_MARGIN",3);let bA=Ds;var $i,Xt,Yt,Hl,fh,ts,rn,Us,Wl,Gl,ql,ph,Ay;class s5{constructor(e,t,s,i,r,o){I(this,ph);I(this,$i,new Float64Array(6));I(this,Xt);I(this,Yt);I(this,Hl);I(this,fh);I(this,ts);I(this,rn,"");I(this,Us,0);I(this,Wl,new w_);I(this,Gl);I(this,ql);w(this,Gl,s),w(this,ql,i),w(this,Hl,r),w(this,fh,o),[e,t]=x(this,ph,Ay).call(this,e,t);const a=w(this,Xt,[NaN,NaN,NaN,NaN,e,t]);w(this,ts,[e,t]),w(this,Yt,[{line:a,points:c(this,ts)}]),c(this,$i).set(a,0)}updateProperty(e,t){e==="stroke-width"&&w(this,fh,t)}isEmpty(){return!c(this,Yt)||c(this,Yt).length===0}add(e,t){[e,t]=x(this,ph,Ay).call(this,e,t);const[s,i,r,o]=c(this,$i).subarray(2,6),a=e-r,l=t-o;return Math.hypot(c(this,Gl)*a,c(this,ql)*l)<=2?null:(c(this,ts).push(e,t),isNaN(s)?(c(this,$i).set([r,o,e,t],2),c(this,Xt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(c(this,$i)[0])&&c(this,Xt).splice(6,6),c(this,$i).set([s,i,r,o,e,t],0),c(this,Xt).push(...ee.createBezierPoints(s,i,r,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(c(this,ts).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){w(this,Gl,s),w(this,ql,i),w(this,Hl,r),[e,t]=x(this,ph,Ay).call(this,e,t);const o=w(this,Xt,[NaN,NaN,NaN,NaN,e,t]);w(this,ts,[e,t]);const a=c(this,Yt).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),c(this,Yt).push({line:o,points:c(this,ts)}),c(this,$i).set(o,0),w(this,Us,0),this.toSVGPath(),null}getLastElement(){return c(this,Yt).at(-1)}setLastElement(e){return c(this,Yt)?(c(this,Yt).push(e),w(this,Xt,e.line),w(this,ts,e.points),w(this,Us,0),{path:{d:this.toSVGPath()}}):c(this,Wl).setLastElement(e)}removeLastElement(){if(!c(this,Yt))return c(this,Wl).removeLastElement();c(this,Yt).pop(),w(this,rn,"");for(let e=0,t=c(this,Yt).length;e<t;e++){const{line:s,points:i}=c(this,Yt)[e];w(this,Xt,s),w(this,ts,i),w(this,Us,0),this.toSVGPath()}return{path:{d:c(this,rn)}}}toSVGPath(){const e=ee.svgRound(c(this,Xt)[4]),t=ee.svgRound(c(this,Xt)[5]);if(c(this,ts).length===2)return w(this,rn,`${c(this,rn)} M ${e} ${t} Z`),c(this,rn);if(c(this,ts).length<=6){const i=c(this,rn).lastIndexOf("M");w(this,rn,`${c(this,rn).slice(0,i)} M ${e} ${t}`),w(this,Us,6)}if(c(this,ts).length===4){const i=ee.svgRound(c(this,Xt)[10]),r=ee.svgRound(c(this,Xt)[11]);return w(this,rn,`${c(this,rn)} L ${i} ${r}`),w(this,Us,12),c(this,rn)}const s=[];c(this,Us)===0&&(s.push(`M ${e} ${t}`),w(this,Us,6));for(let i=c(this,Us),r=c(this,Xt).length;i<r;i+=6){const[o,a,l,u,d,f]=c(this,Xt).slice(i,i+6).map(ee.svgRound);s.push(`C${o} ${a} ${l} ${u} ${d} ${f}`)}return w(this,rn,c(this,rn)+s.join(" ")),w(this,Us,c(this,Xt).length),c(this,rn)}getOutlines(e,t,s,i){const r=c(this,Yt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),c(this,Wl).build(c(this,Yt),e,t,s,c(this,Hl),c(this,fh),i),w(this,$i,null),w(this,Xt,null),w(this,Yt,null),w(this,rn,null),c(this,Wl)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}$i=new WeakMap,Xt=new WeakMap,Yt=new WeakMap,Hl=new WeakMap,fh=new WeakMap,ts=new WeakMap,rn=new WeakMap,Us=new WeakMap,Wl=new WeakMap,Gl=new WeakMap,ql=new WeakMap,ph=new WeakSet,Ay=function(e,t){return ee._normalizePoint(e,t,c(this,Gl),c(this,ql),c(this,Hl))};var Vn,dg,fg,_s,Hi,Wi,gh,mh,yh,cn,gr,p2,g2,m2;const KT=class KT extends ee{constructor(){super(...arguments);I(this,cn);I(this,Vn);I(this,dg,0);I(this,fg);I(this,_s);I(this,Hi);I(this,Wi);I(this,gh);I(this,mh);I(this,yh)}build(t,s,i,r,o,a,l){w(this,Hi,s),w(this,Wi,i),w(this,gh,r),w(this,mh,o),w(this,yh,a),w(this,fg,l??0),w(this,_s,t),x(this,cn,g2).call(this)}setLastElement(t){return c(this,_s).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return c(this,_s).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of c(this,_s)){if(t.push(`M${ee.svgRound(s[4])} ${ee.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12){t.push(`L${ee.svgRound(s[10])} ${ee.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[o,a,l,u,d,f]=s.subarray(i,i+6).map(ee.svgRound);t.push(`C${o} ${a} ${l} ${u} ${d} ${f}`)}}return t.join("")}serialize([t,s,i,r],o){const a=[],l=[],[u,d,f,p]=x(this,cn,p2).call(this);let m,y,E,k,v,A,C,N,F;switch(c(this,mh)){case 0:F=ee._rescale,m=t,y=s+r,E=i,k=-r,v=t+u*i,A=s+(1-d-p)*r,C=t+(u+f)*i,N=s+(1-d)*r;break;case 90:F=ee._rescaleAndSwap,m=t,y=s,E=i,k=r,v=t+d*i,A=s+u*r,C=t+(d+p)*i,N=s+(u+f)*r;break;case 180:F=ee._rescale,m=t+i,y=s,E=-i,k=r,v=t+(1-u-f)*i,A=s+d*r,C=t+(1-u)*i,N=s+(d+p)*r;break;case 270:F=ee._rescaleAndSwap,m=t+i,y=s+r,E=-i,k=-r,v=t+(1-d-p)*i,A=s+(1-u-f)*r,C=t+(1-d)*i,N=s+(1-u)*r;break}for(const{line:V,points:S}of c(this,_s))a.push(F(V,m,y,E,k,o?new Array(V.length):null)),l.push(F(S,m,y,E,k,o?new Array(S.length):null));return{lines:a,points:l,rect:[v,A,C,N]}}static deserialize(t,s,i,r,o,{paths:{lines:a,points:l},rotation:u,thickness:d}){const f=[];let p,m,y,E,k;switch(u){case 0:k=ee._rescale,p=-t/i,m=s/r+1,y=1/i,E=-1/r;break;case 90:k=ee._rescaleAndSwap,p=-s/r,m=-t/i,y=1/r,E=1/i;break;case 180:k=ee._rescale,p=t/i+1,m=-s/r,y=-1/i,E=1/r;break;case 270:k=ee._rescaleAndSwap,p=s/r+1,m=t/i+1,y=-1/r,E=-1/i;break}if(!a){a=[];for(const A of l){const C=A.length;if(C===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1]]));continue}if(C===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1],NaN,NaN,NaN,NaN,A[2],A[3]]));continue}const N=new Float32Array(3*(C-2));a.push(N);let[F,V,S,T]=A.subarray(0,4);N.set([NaN,NaN,NaN,NaN,F,V],0);for(let P=4;P<C;P+=2){const D=A[P],M=A[P+1];N.set(ee.createBezierPoints(F,V,S,T,D,M),(P-2)*3),[F,V,S,T]=[S,T,D,M]}}}for(let A=0,C=a.length;A<C;A++)f.push({line:k(a[A].map(N=>N??NaN),p,m,y,E),points:k(l[A].map(N=>N??NaN),p,m,y,E)});const v=new KT;return v.build(f,i,r,1,u,d,o),v}get box(){return c(this,Vn)}updateProperty(t,s){return t==="stroke-width"?x(this,cn,m2).call(this,s):null}updateParentDimensions([t,s],i){const[r,o]=x(this,cn,gr).call(this);w(this,Hi,t),w(this,Wi,s),w(this,gh,i);const[a,l]=x(this,cn,gr).call(this),u=a-r,d=l-o,f=c(this,Vn);return f[0]-=u,f[1]-=d,f[2]+=2*u,f[3]+=2*d,f}updateRotation(t){return w(this,dg,t),{path:{transform:this.rotationTransform}}}get viewBox(){return c(this,Vn).map(ee.svgRound).join(" ")}get defaultProperties(){const[t,s]=c(this,Vn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ee.svgRound(t)} ${ee.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=c(this,Vn);let i=0,r=0,o=0,a=0,l=0,u=0;switch(c(this,dg)){case 90:r=s/t,o=-t/s,l=t;break;case 180:i=-1,a=-1,l=t,u=s;break;case 270:r=-s/t,o=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${o} ${a} ${ee.svgRound(l)} ${ee.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[o,a]=x(this,cn,gr).call(this),[l,u,d,f]=c(this,Vn);if(Math.abs(d-o)<=ee.PRECISION||Math.abs(f-a)<=ee.PRECISION){const k=t+i/2-(l+d/2),v=s+r/2-(u+f/2);return{path:{"transform-origin":`${ee.svgRound(t)} ${ee.svgRound(s)}`,transform:`${this.rotationTransform} translate(${k} ${v})`}}}const p=(i-2*o)/(d-2*o),m=(r-2*a)/(f-2*a),y=d/i,E=f/r;return{path:{"transform-origin":`${ee.svgRound(l)} ${ee.svgRound(u)}`,transform:`${this.rotationTransform} scale(${y} ${E}) translate(${ee.svgRound(o)} ${ee.svgRound(a)}) scale(${p} ${m}) translate(${ee.svgRound(-o)} ${ee.svgRound(-a)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[o,a]=x(this,cn,gr).call(this),l=c(this,Vn),[u,d,f,p]=l;if(l[0]=t,l[1]=s,l[2]=i,l[3]=r,Math.abs(f-o)<=ee.PRECISION||Math.abs(p-a)<=ee.PRECISION){const v=t+i/2-(u+f/2),A=s+r/2-(d+p/2);for(const{line:C,points:N}of c(this,_s))ee._translate(C,v,A,C),ee._translate(N,v,A,N);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ee.svgRound(t)} ${ee.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*o)/(f-2*o),y=(r-2*a)/(p-2*a),E=-m*(u+o)+t+o,k=-y*(d+a)+s+a;if(m!==1||y!==1||E!==0||k!==0)for(const{line:v,points:A}of c(this,_s))ee._rescale(v,E,k,m,y,v),ee._rescale(A,E,k,m,y,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ee.svgRound(t)} ${ee.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,o]=i,a=c(this,Vn),l=t-a[0],u=s-a[1];if(c(this,Hi)===r&&c(this,Wi)===o)for(const{line:d,points:f}of c(this,_s))ee._translate(d,l,u,d),ee._translate(f,l,u,f);else{const d=c(this,Hi)/r,f=c(this,Wi)/o;w(this,Hi,r),w(this,Wi,o);for(const{line:p,points:m}of c(this,_s))ee._rescale(p,l,u,d,f,p),ee._rescale(m,l,u,d,f,m);a[2]*=d,a[3]*=f}return a[0]=t,a[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ee.svgRound(t)} ${ee.svgRound(s)}`}}}get defaultSVGProperties(){const t=c(this,Vn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ee.svgRound(t[0])} ${ee.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Vn=new WeakMap,dg=new WeakMap,fg=new WeakMap,_s=new WeakMap,Hi=new WeakMap,Wi=new WeakMap,gh=new WeakMap,mh=new WeakMap,yh=new WeakMap,cn=new WeakSet,gr=function(t=c(this,yh)){const s=c(this,fg)+t/2*c(this,gh);return c(this,mh)%180===0?[s/c(this,Hi),s/c(this,Wi)]:[s/c(this,Wi),s/c(this,Hi)]},p2=function(){const[t,s,i,r]=c(this,Vn),[o,a]=x(this,cn,gr).call(this,0);return[t+o,s+a,i-2*o,r-2*a]},g2=function(){const t=w(this,Vn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of c(this,_s)){if(r.length<=12){for(let l=4,u=r.length;l<u;l+=6){const[d,f]=r.subarray(l,l+2);t[0]=Math.min(t[0],d),t[1]=Math.min(t[1],f),t[2]=Math.max(t[2],d),t[3]=Math.max(t[3],f)}continue}let o=r[4],a=r[5];for(let l=6,u=r.length;l<u;l+=6){const[d,f,p,m,y,E]=r.subarray(l,l+6);le.bezierBoundingBox(o,a,d,f,p,m,y,E,t),o=y,a=E}}const[s,i]=x(this,cn,gr).call(this);t[0]=Math.min(1,Math.max(0,t[0]-s)),t[1]=Math.min(1,Math.max(0,t[1]-i)),t[2]=Math.min(1,Math.max(0,t[2]+s)),t[3]=Math.min(1,Math.max(0,t[3]+i)),t[2]-=t[0],t[3]-=t[1]},m2=function(t){const[s,i]=x(this,cn,gr).call(this);w(this,yh,t);const[r,o]=x(this,cn,gr).call(this),[a,l]=[r-s,o-i],u=c(this,Vn);return u[0]-=a,u[1]-=l,u[2]+=2*a,u[3]+=2*l,u};let w_=KT;var _h;const XT=class XT extends n5{constructor(t){super();I(this,_h);w(this,_h,t),super.updateProperties({fill:"none",stroke:mt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,s){t==="stroke-width"&&(s??(s=this["stroke-width"]),s*=c(this,_h).realScale),super.updateSVGProperty(t,s)}clone(){const t=new XT(c(this,_h));return t.updateAll(this),t}};_h=new WeakMap;let IA=XT;var V_,y2;const ru=class ru extends bA{constructor(t){super({...t,name:"inkEditor"});I(this,V_);this._willKeepAspectRatio=!0}static initialize(t,s){mt.initialize(t,s),this._defaultDrawingOptions=new IA(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return xe(this,"typesMap",new Map([[Pe.INK_THICKNESS,"stroke-width"],[Pe.INK_COLOR,"stroke"],[Pe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,o){return new s5(t,s,i,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,o,a){return w_.deserialize(t,s,i,r,o,a)}static async deserialize(t,s,i){let r=null;if(t instanceof HT){const{data:{inkLists:a,rect:l,rotation:u,id:d,color:f,opacity:p,borderStyle:{rawWidth:m},popupRef:y},parent:{page:{pageNumber:E}}}=t;r=t={annotationType:Ae.INK,color:Array.from(f),thickness:m,opacity:p,paths:{points:a},boxes:null,pageIndex:E-1,rect:l.slice(0),rotation:u,id:d,deleted:!1,popupRef:y}}const o=await super.deserialize(t,s,i);return o.annotationElementId=t.id||null,o._initialData=r,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=ru.getDefaultDrawingOptions({stroke:le.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":a,"stroke-width":l}}=this,u={annotationType:Ae.INK,color:mt._colorManager.convert(o),opacity:a,thickness:l,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?u:this.annotationElementId&&!x(this,V_,y2).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};V_=new WeakSet,y2=function(t){const{color:s,thickness:i,opacity:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==s[l])||t.thickness!==i||t.opacity!==r||t.pageIndex!==o},ue(ru,"_type","ink"),ue(ru,"_editorType",Ae.INK),ue(ru,"_defaultDrawingOptions",null);let CA=ru;var pt,on,Yo,Vr,Qo,vh,Gi,jr,qi,vs,wh,ke,Jd,Zd,by,RA,_2,Ty,PA,Sy,v2,w2;const vf=class vf extends mt{constructor(t){super({...t,name:"stampEditor"});I(this,ke);I(this,pt,null);I(this,on,null);I(this,Yo,null);I(this,Vr,null);I(this,Qo,null);I(this,vh,"");I(this,Gi,null);I(this,jr,null);I(this,qi,null);I(this,vs,!1);I(this,wh,!1);w(this,Vr,t.bitmapUrl),w(this,Qo,t.bitmapFile)}static initialize(t,s){mt.initialize(t,s)}static get supportedTypes(){return xe(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return xe(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(Ae.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:r,width:o,height:a,channels:r.length/(o*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t,s;c(this,on)&&(w(this,pt,null),this._uiManager.imageManager.deleteId(c(this,on)),(t=c(this,Gi))==null||t.remove(),w(this,Gi,null),(s=c(this,jr))==null||s.disconnect(),w(this,jr,null),c(this,qi)&&(clearTimeout(c(this,qi)),w(this,qi,null))),super.remove()}rebuild(){if(!this.parent){c(this,on)&&x(this,ke,by).call(this);return}super.rebuild(),this.div!==null&&(c(this,on)&&c(this,Gi)===null&&x(this,ke,by).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(c(this,Yo)||c(this,pt)||c(this,Vr)||c(this,Qo)||c(this,on))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),c(this,pt)?x(this,ke,RA).call(this):x(this,ke,by).call(this),this.width&&!this.annotationElementId){const[i,r]=this.parentDimensions;this.setAt(t*i,s*r,this.width*i,this.height*r)}return this.div}copyCanvas(t,s,i=!1){var m;t||(t=224);const{width:r,height:o}=c(this,pt),a=new IE;let l=c(this,pt),u=r,d=o,f=null;if(s){if(r>s||o>s){const T=Math.min(s/r,s/o);u=Math.floor(r*T),d=Math.floor(o*T)}f=document.createElement("canvas");const y=f.width=Math.ceil(u*a.sx),E=f.height=Math.ceil(d*a.sy);c(this,vs)||(l=x(this,ke,Ty).call(this,y,E));const k=f.getContext("2d");k.filter=this._uiManager.hcmFilter;let v="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":(m=window.matchMedia)!=null&&m.call(window,"(prefers-color-scheme: dark)").matches&&(v="#8f8f9d",A="#42414d");const C=15,N=C*a.sx,F=C*a.sy,V=new OffscreenCanvas(N*2,F*2),S=V.getContext("2d");S.fillStyle=v,S.fillRect(0,0,N*2,F*2),S.fillStyle=A,S.fillRect(0,0,N,F),S.fillRect(N,F,N,F),k.fillStyle=k.createPattern(V,"repeat"),k.fillRect(0,0,y,E),k.drawImage(l,0,0,l.width,l.height,0,0,y,E)}let p=null;if(i){let y,E;if(a.symmetric&&l.width<t&&l.height<t)y=l.width,E=l.height;else if(l=c(this,pt),r>t||o>t){const A=Math.min(t/r,t/o);y=Math.floor(r*A),E=Math.floor(o*A),c(this,vs)||(l=x(this,ke,Ty).call(this,y,E))}const v=new OffscreenCanvas(y,E).getContext("2d",{willReadFrequently:!0});v.drawImage(l,0,0,l.width,l.height,0,0,y,E),p={width:y,height:E,data:v.getImageData(0,0,y,E).data}}return{canvas:f,width:u,height:d,imageData:p}}getImageForAltText(){return c(this,Gi)}static async deserialize(t,s,i){var E;let r=null;if(t instanceof jD){const{data:{rect:k,rotation:v,id:A,structParent:C,popupRef:N},container:F,parent:{page:{pageNumber:V}}}=t,S=F.querySelector("canvas"),T=i.imageManager.getFromCanvas(F.id,S);S.remove();const P=((E=await s._structTree.getAriaAttributes(`${OT}${A}`))==null?void 0:E.get("aria-label"))||"";r=t={annotationType:Ae.STAMP,bitmapId:T.id,bitmap:T.bitmap,pageIndex:V-1,rect:k.slice(0),rotation:v,id:A,deleted:!1,accessibilityData:{decorative:!1,altText:P},isSvg:!1,structParent:C,popupRef:N}}const o=await super.deserialize(t,s,i),{rect:a,bitmap:l,bitmapUrl:u,bitmapId:d,isSvg:f,accessibilityData:p}=t;d&&i.imageManager.isValidId(d)?(w(o,on,d),l&&w(o,pt,l)):w(o,Vr,u),w(o,vs,f);const[m,y]=o.pageDimensions;return o.width=(a[2]-a[0])/m,o.height=(a[3]-a[1])/y,o.annotationElementId=t.id||null,p&&(o.altTextData=p),o._initialData=r,w(o,wh,!!r),o}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Ae.STAMP,bitmapId:c(this,on),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:c(this,vs),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=x(this,ke,Sy).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const l=x(this,ke,w2).call(this,i);if(l.isSame)return null;l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const a=c(this,vs)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(c(this,on)))s.stamps.set(c(this,on),{area:a,serialized:i}),i.bitmap=x(this,ke,Sy).call(this,!1);else if(c(this,vs)){const l=s.stamps.get(c(this,on));a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=x(this,ke,Sy).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};pt=new WeakMap,on=new WeakMap,Yo=new WeakMap,Vr=new WeakMap,Qo=new WeakMap,vh=new WeakMap,Gi=new WeakMap,jr=new WeakMap,qi=new WeakMap,vs=new WeakMap,wh=new WeakMap,ke=new WeakSet,Jd=function(t,s=!1){if(!t){this.remove();return}w(this,pt,t.bitmap),s||(w(this,on,t.id),w(this,vs,t.isSvg)),t.file&&w(this,vh,t.file.name),x(this,ke,RA).call(this)},Zd=function(){if(w(this,Yo,null),this._uiManager.enableWaiting(!1),!!c(this,Gi)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,pt)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,pt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},by=function(){if(c(this,on)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(c(this,on)).then(i=>x(this,ke,Jd).call(this,i,!0)).finally(()=>x(this,ke,Zd).call(this));return}if(c(this,Vr)){const i=c(this,Vr);w(this,Vr,null),this._uiManager.enableWaiting(!0),w(this,Yo,this._uiManager.imageManager.getFromUrl(i).then(r=>x(this,ke,Jd).call(this,r)).finally(()=>x(this,ke,Zd).call(this)));return}if(c(this,Qo)){const i=c(this,Qo);w(this,Qo,null),this._uiManager.enableWaiting(!0),w(this,Yo,this._uiManager.imageManager.getFromFile(i).then(r=>x(this,ke,Jd).call(this,r)).finally(()=>x(this,ke,Zd).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=vf.supportedTypesStr;const s=this._uiManager._signal;w(this,Yo,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),x(this,ke,Jd).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>x(this,ke,Zd).call(this))),t.click()},RA=function(){const{div:t}=this;let{width:s,height:i}=c(this,pt);const[r,o]=this.pageDimensions,a=.75;if(this.width)s=this.width*r,i=this.height*o;else if(s>a*r||i>a*o){const f=Math.min(a*r/s,a*o/i);s*=f,i*=f}const[l,u]=this.parentDimensions;this.setDims(s*l/r,i*u/o),this._uiManager.enableWaiting(!1);const d=w(this,Gi,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),x(this,ke,PA).call(this,s,i),x(this,ke,v2).call(this),c(this,wh)||(this.parent.addUndoableEditor(this),w(this,wh,!0)),this._reportTelemetry({action:"inserted_image"}),c(this,vh)&&d.setAttribute("aria-label",c(this,vh))},_2=function(t,s){var a;const[i,r]=this.parentDimensions;this.width=t/i,this.height=s/r,(a=this._initialOptions)!=null&&a.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,c(this,qi)!==null&&clearTimeout(c(this,qi)),w(this,qi,setTimeout(()=>{w(this,qi,null),x(this,ke,PA).call(this,t,s)},200))},Ty=function(t,s){const{width:i,height:r}=c(this,pt);let o=i,a=r,l=c(this,pt);for(;o>2*t||a>2*s;){const u=o,d=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*s&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const f=new OffscreenCanvas(o,a);f.getContext("2d").drawImage(l,0,0,u,d,0,0,o,a),l=f.transferToImageBitmap()}return l},PA=function(t,s){const i=new IE,r=Math.ceil(t*i.sx),o=Math.ceil(s*i.sy),a=c(this,Gi);if(!a||a.width===r&&a.height===o)return;a.width=r,a.height=o;const l=c(this,vs)?c(this,pt):x(this,ke,Ty).call(this,r,o),u=a.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(l,0,0,l.width,l.height,0,0,r,o)},Sy=function(t){if(t){if(c(this,vs)){const r=this._uiManager.imageManager.getSvgUrl(c(this,on));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=c(this,pt),s.getContext("2d").drawImage(c(this,pt),0,0),s.toDataURL()}if(c(this,vs)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*Ta.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*Ta.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,o);return a.getContext("2d").drawImage(c(this,pt),0,0,c(this,pt).width,c(this,pt).height,0,0,r,o),a.transferToImageBitmap()}return structuredClone(c(this,pt))},v2=function(){this._uiManager._signal&&(w(this,jr,new ResizeObserver(t=>{const s=t[0].contentRect;s.width&&s.height&&x(this,ke,_2).call(this,s.width,s.height)})),c(this,jr).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var t;(t=c(this,jr))==null||t.disconnect(),w(this,jr,null)},{once:!0}))},w2=function(t){var a;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}},ue(vf,"_type","stamp"),ue(vf,"_editorType",Ae.STAMP);let kA=vf;var Kl,Eh,Ki,Jo,Ur,Bs,Zo,Ah,pi,xn,Br,ae,ea,ct,E2,ki,DA,LA,xy;const ei=class ei{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:l,viewport:u,l10n:d}){I(this,ct);I(this,Kl);I(this,Eh,!1);I(this,Ki,null);I(this,Jo,null);I(this,Ur,null);I(this,Bs,new Map);I(this,Zo,!1);I(this,Ah,!1);I(this,pi,null);I(this,xn,null);I(this,Br,null);I(this,ae);const f=[...c(ei,ea).values()];if(!ei._initialized){ei._initialized=!0;for(const p of f)p.initialize(d,e)}e.registerEditorTypes(f),w(this,ae,e),this.pageIndex=t,this.div=s,w(this,Kl,r),w(this,Ki,o),this.viewport=u,w(this,xn,l),this.drawLayer=a,this._structTree=i,c(this,ae).addLayer(this)}get isEmpty(){return c(this,Bs).size===0}get isInvisible(){return this.isEmpty&&c(this,ae).getMode()===Ae.NONE}updateToolbar(e){c(this,ae).updateToolbar(e)}updateMode(e=c(this,ae).getMode()){switch(x(this,ct,xy).call(this),e){case Ae.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ae.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ae.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of c(ei,ea).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=c(this,xn))==null?void 0:t.div)}setEditingState(e){c(this,ae).setEditingState(e)}addCommands(e){c(this,ae).addCommands(e)}cleanUndoStack(e){c(this,ae).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=c(this,Ki))==null||t.div.classList.toggle("disabled",!e)}async enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of c(this,Bs).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(c(this,ae).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!c(this,Ki))return;const t=c(this,Ki).getEditableAnnotations();for(const s of t){if(s.hide(),c(this,ae).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}}disable(){var i;w(this,Ah,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of c(this,Bs).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(c(this,Ki)){const r=c(this,Ki).getEditableAnnotations();for(const o of r){const{id:a}=o.data;if(c(this,ae).isDeletedAnnotationElement(a))continue;let l=t.get(a);if(l){l.resetAnnotationElement(o),l.show(!1),o.show();continue}l=e.get(a),l&&(c(this,ae).addChangedExistingAnnotation(l),l.renderAnnotationElement(o)&&l.show(!1)),o.show()}}x(this,ct,xy).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of c(ei,ea).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),w(this,Ah,!1)}getEditableAnnotation(e){var t;return((t=c(this,Ki))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){c(this,ae).getActive()!==e&&c(this,ae).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=c(this,xn))!=null&&e.div&&!c(this,Br)){w(this,Br,new AbortController);const t=c(this,ae).combinedSignal(c(this,Br));c(this,xn).div.addEventListener("pointerdown",x(this,ct,E2).bind(this),{signal:t}),c(this,xn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=c(this,xn))!=null&&e.div&&c(this,Br)&&(c(this,Br).abort(),w(this,Br,null),c(this,xn).div.classList.remove("highlighting"))}enableClick(){if(c(this,Jo))return;w(this,Jo,new AbortController);const e=c(this,ae).combinedSignal(c(this,Jo));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:e})}disableClick(){var e;(e=c(this,Jo))==null||e.abort(),w(this,Jo,null)}attach(e){c(this,Bs).set(e.id,e);const{annotationElementId:t}=e;t&&c(this,ae).isDeletedAnnotationElement(t)&&c(this,ae).removeDeletedAnnotationElement(e)}detach(e){var t;c(this,Bs).delete(e.id),(t=c(this,Kl))==null||t.removePointerInTextLayer(e.contentDiv),!c(this,Ah)&&e.annotationElementId&&c(this,ae).addDeletedAnnotationElement(e)}remove(e){this.detach(e),c(this,ae).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(c(this,ae).addDeletedAnnotationElement(e.annotationElementId),mt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),c(this,ae).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),c(this,ae).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!c(this,Ur)&&(e._focusEventsAllowed=!1,w(this,Ur,setTimeout(()=>{w(this,Ur,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:c(this,ae)._signal}),t.focus())},0))),e._structTreeParentId=(s=c(this,Kl))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return c(this,ae).getId()}combinedSignal(e){return c(this,ae).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=c(this,ct,ki))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){c(this,ae).updateToolbar(e),c(this,ae).updateMode(e);const{offsetX:s,offsetY:i}=x(this,ct,LA).call(this),r=this.getNextId(),o=x(this,ct,DA).call(this,{parent:this,id:r,x:s,y:i,uiManager:c(this,ae),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=c(ei,ea).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,c(this,ae)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=x(this,ct,DA).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:c(this,ae),isCentered:t,...s});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(x(this,ct,LA).call(this),!0)}setSelected(e){c(this,ae).setSelected(e)}toggleSelected(e){c(this,ae).toggleSelected(e)}unselect(e){c(this,ae).unselect(e)}pointerup(e){var s;const{isMac:t}=Wn.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&c(this,Zo)&&(w(this,Zo,!1),!((s=c(this,ct,ki))!=null&&s.isDrawer&&c(this,ct,ki).supportMultipleDrawings))){if(!c(this,Eh)){w(this,Eh,!0);return}if(c(this,ae).getMode()===Ae.STAMP){c(this,ae).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var i;if(c(this,ae).getMode()===Ae.HIGHLIGHT&&this.enableTextSelection(),c(this,Zo)){w(this,Zo,!1);return}const{isMac:t}=Wn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(w(this,Zo,!0),(i=c(this,ct,ki))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=c(this,ae).getActive();w(this,Eh,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus(),c(this,pi)){c(this,ct,ki).startDrawing(this,c(this,ae),!1,e);return}c(this,ae).setCurrentDrawingSession(this),w(this,pi,new AbortController);const t=c(this,ae).combinedSignal(c(this,pi));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&this.commitOrRemove()},{signal:t}),c(this,ct,ki).startDrawing(this,c(this,ae),!1,e)}endDrawingSession(e=!1){return c(this,pi)?(c(this,ae).setCurrentDrawingSession(null),c(this,pi).abort(),w(this,pi,null),c(this,ct,ki).endDrawing(e)):null}findNewParent(e,t,s){const i=c(this,ae).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return c(this,pi)?(this.endDrawingSession(),!0):!1}onScaleChanging(){c(this,pi)&&c(this,ct,ki).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=c(this,ae).getActive())==null?void 0:e.parent)===this&&(c(this,ae).commitOrRemove(),c(this,ae).setActiveEditor(null)),c(this,Ur)&&(clearTimeout(c(this,Ur)),w(this,Ur,null));for(const s of c(this,Bs).values())(t=c(this,Kl))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,c(this,Bs).clear(),c(this,ae).removeLayer(this)}render({viewport:e}){this.viewport=e,dc(this.div,e);for(const t of c(this,ae).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){c(this,ae).commitOrRemove(),x(this,ct,xy).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,dc(this.div,{rotation:s}),t!==s)for(const i of c(this,Bs).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return c(this,ae).viewParameters.realScale}};Kl=new WeakMap,Eh=new WeakMap,Ki=new WeakMap,Jo=new WeakMap,Ur=new WeakMap,Bs=new WeakMap,Zo=new WeakMap,Ah=new WeakMap,pi=new WeakMap,xn=new WeakMap,Br=new WeakMap,ae=new WeakMap,ea=new WeakMap,ct=new WeakSet,E2=function(e){c(this,ae).unselectAll();const{target:t}=e;if(t===c(this,xn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&c(this,xn).div.contains(t)){const{isMac:s}=Wn.platform;if(e.button!==0||e.ctrlKey&&s)return;c(this,ae).showAllEditors("highlight",!0,!0),c(this,xn).div.classList.add("free"),this.toggleDrawing(),v_.startHighlighting(this,c(this,ae).direction==="ltr",{target:c(this,xn).div,x:e.x,y:e.y}),c(this,xn).div.addEventListener("pointerup",()=>{c(this,xn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:c(this,ae)._signal}),e.preventDefault()}},ki=function(){return c(ei,ea).get(c(this,ae).getMode())},DA=function(e){const t=c(this,ct,ki);return t?new t.prototype.constructor(e):null},LA=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+i),u=(r+a)/2-e,d=(o+l)/2-t,[f,p]=this.viewport.rotation%180===0?[u,d]:[d,u];return{offsetX:f,offsetY:p}},xy=function(){for(const e of c(this,Bs).values())e.isEmpty()&&e.remove()},ue(ei,"_initialized",!1),I(ei,ea,new Map([fA,CA,kA,v_].map(e=>[e._editorType,e])));let NA=ei;var gi,pg,jn,Xl,j_,A2,or,OA,b2,FA;const An=class An{constructor({pageIndex:e}){I(this,or);I(this,gi,null);I(this,pg,0);I(this,jn,new Map);I(this,Xl,new Map);this.pageIndex=e}setParent(e){if(!c(this,gi)){w(this,gi,e);return}if(c(this,gi)!==e){if(c(this,jn).size>0)for(const t of c(this,jn).values())t.remove(),e.append(t);w(this,gi,e)}}static get _svgFactory(){return xe(this,"_svgFactory",new $T)}draw(e,t=!1,s=!1){const i=Ln(this,pg)._++,r=x(this,or,OA).call(this),o=An._svgFactory.createElement("defs");r.append(o);const a=An._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t&&c(this,Xl).set(i,a);const u=s?x(this,or,b2).call(this,o,l):null,d=An._svgFactory.createElement("use");return r.append(d),d.setAttribute("href",`#${l}`),this.updateProperties(r,e),c(this,jn).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=Ln(this,pg)._++,i=x(this,or,OA).call(this),r=An._svgFactory.createElement("defs");i.append(r);const o=An._svgFactory.createElement("path");r.append(o);const a=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const f=An._svgFactory.createElement("mask");r.append(f),l=`mask_p${this.pageIndex}_${s}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const p=An._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const m=An._svgFactory.createElement("use");f.append(m),m.setAttribute("href",`#${a}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const u=An._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${a}`),l&&u.setAttribute("mask",`url(#${l})`);const d=u.cloneNode();return i.append(d),u.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,e),c(this,jn).set(s,i),s}finalizeDraw(e,t){c(this,Xl).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:s,bbox:i,rootClass:r,path:o}=t,a=typeof e=="number"?c(this,jn).get(e):e;if(a){if(s&&x(this,or,FA).call(this,a,s),i&&x(l=An,j_,A2).call(l,a,i),r){const{classList:u}=a;for(const[d,f]of Object.entries(r))u.toggle(d,f)}if(o){const d=a.firstChild.firstChild;x(this,or,FA).call(this,d,o)}}}updateParent(e,t){if(t===this)return;const s=c(this,jn).get(e);s&&(c(t,gi).append(s),c(this,jn).delete(e),c(t,jn).set(e,s))}remove(e){c(this,Xl).delete(e),c(this,gi)!==null&&(c(this,jn).get(e).remove(),c(this,jn).delete(e))}destroy(){w(this,gi,null);for(const e of c(this,jn).values())e.remove();c(this,jn).clear(),c(this,Xl).clear()}};gi=new WeakMap,pg=new WeakMap,jn=new WeakMap,Xl=new WeakMap,j_=new WeakSet,A2=function(e,[t,s,i,r]){const{style:o}=e;o.top=`${100*s}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*r}%`},or=new WeakSet,OA=function(){const e=An._svgFactory.create(1,1,!0);return c(this,gi).append(e),e.setAttribute("aria-hidden",!0),e},b2=function(e,t){const s=An._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=An._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},FA=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},I(An,j_);let MA=An;globalThis.pdfjsTestingUtils={HighlightOutliner:gA};ge.AbortException;ge.AnnotationEditorLayer;ge.AnnotationEditorParamsType;ge.AnnotationEditorType;ge.AnnotationEditorUIManager;ge.AnnotationLayer;ge.AnnotationMode;ge.ColorPicker;ge.DOMSVGFactory;ge.DrawLayer;ge.FeatureTest;var i5=ge.GlobalWorkerOptions;ge.ImageKind;ge.InvalidPDFException;ge.MissingPDFException;ge.OPS;ge.OutputScale;ge.PDFDataRangeTransport;ge.PDFDateString;ge.PDFWorker;ge.PasswordResponses;ge.PermissionFlag;ge.PixelsPerInch;ge.RenderingCancelledException;ge.TextLayer;ge.UnexpectedResponseException;ge.Util;ge.VerbosityLevel;ge.XfaLayer;ge.build;ge.createValidAbsoluteUrl;ge.fetchData;var r5=ge.getDocument;ge.getFilenameFromUrl;ge.getPdfFilenameFromUrl;ge.getXfaPageViewport;ge.isDataScheme;ge.isPdfFile;ge.noContextMenu;ge.normalizeUnicode;ge.setLayerDimensions;ge.shadow;ge.stopEvent;ge.version;i5.workerSrc="/pdf.worker.min.mjs";const o5=({pdf:n,onClose:e,violation:t,onViolation:s,canDownload:i})=>{const r=K.useRef(null),o=K.useRef(null),[a,l]=K.useState(null),[u,d]=K.useState(1),[f,p]=K.useState(0),[m,y]=K.useState(!0),[E,k]=K.useState(null),[v,A]=K.useState(null),[C,N]=K.useState(!1);K.useEffect(()=>{if(!n){l(null),A(null);return}y(!0),k(null),d(1);let S=null,T=null;return(async()=>{var P;try{let D=n.path;if(!D&&n.url){const Ne=(P=new URL(n.url).pathname.split("/o/")[1])==null?void 0:P.split("?")[0];Ne&&(D=decodeURIComponent(Ne))}if(!D)throw new Error("Unable to determine file path");const M=zr($r,D),O=await Kz(M),L=new Blob([O],{type:"application/pdf"});S=URL.createObjectURL(L),A(S),T=await r5({data:O}).promise,l(T),p(T.numPages)}catch(D){const M=D instanceof Error?D.message:"Unknown error loading PDF";k(M),console.error("PDF loading error:",D)}finally{y(!1)}})(),()=>{if(S&&URL.revokeObjectURL(S),T&&typeof T.destroy=="function")try{T.destroy()}catch{}}},[n]),K.useEffect(()=>{if(!a||!r.current)return;(async()=>{if(!(u<1||u>f)){N(!0);try{const T=await a.getPage(u),P=T.getViewport({scale:1.5}),D=r.current;if(!D)return;D.width=P.width,D.height=P.height;const M=D.getContext("2d");if(!M)return;const O={canvasContext:M,viewport:P};await T.render(O).promise}catch(T){console.error("Error rendering page:",T)}finally{N(!1)}}})()},[a,u,f]);const F=async()=>{if(!(!n||!v))try{const S=document.createElement("a");S.href=v,S.download=n.name.endsWith(".pdf")?n.name:`${n.name}.pdf`,document.body.appendChild(S),S.click(),document.body.removeChild(S)}catch(S){console.error("Download error:",S)}},V=S=>{const T=Math.max(1,Math.min(S,f));d(T)};return n?b.jsx("div",{onContextMenu:S=>S.preventDefault(),className:"modal-overlay animate-fade-in select-none",children:t?b.jsxs("div",{className:"modal-content modal-md p-8 flex flex-col items-center text-center border border-error/50 relative overflow-hidden bg-[#09090b] shadow-[0_0_50px_rgba(239,68,68,0.2)]",children:[b.jsx("div",{className:"absolute inset-0 bg-red-900/10 animate-pulse pointer-events-none"}),b.jsx("div",{className:"relative w-24 h-24 rounded-full bg-error/10 flex items-center justify-center mb-6 text-error shadow-[0_0_30px_rgba(239,68,68,0.3)] animate-bounce",children:b.jsx(Iw,{size:48})}),b.jsx("h2",{className:"relative text-3xl font-bold text-white mb-2 tracking-tight",children:"Security Alert"}),b.jsx("p",{className:"relative text-error font-bold text-lg mb-6 uppercase tracking-widest",children:"Screenshot Detected"}),b.jsx("div",{className:"relative bg-white/5 border border-white/10 rounded-lg p-4 mb-8 w-full",children:b.jsxs("p",{className:"text-muted text-sm leading-relaxed",children:["A security violation has been logged against your ID ",b.jsx("strong",{children:localStorage.getItem("Number")}),".",b.jsx("br",{}),b.jsx("br",{}),"This incident has been reported to the administrator. Repeated violations will result in an immediate permanent ban."]})}),b.jsx("button",{onClick:e,className:"relative btn btn-danger w-full justify-center font-bold",children:"Close & Acknowledge"})]}):b.jsxs("div",{className:"modal-content modal-xl relative flex flex-col h-[90vh]",children:[b.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-white/10 bg-surface z-10 shrink-0",children:[b.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[b.jsx("div",{className:"p-2 bg-primary/10 rounded-lg text-primary shrink-0",children:b.jsx(Iw,{size:18})}),b.jsx("h3",{className:"font-semibold text-white truncate",children:n.name})]}),b.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[i&&b.jsx("button",{onClick:F,disabled:m||!v,className:"btn-icon disabled:opacity-50 disabled:cursor-not-allowed hover:text-primary",title:"Download PDF",children:b.jsx(K0,{size:20})}),b.jsx("button",{onClick:e,className:"btn-icon hover:text-white",children:b.jsx(Qy,{size:20})})]})]}),b.jsx("div",{ref:o,className:"flex-1 bg-black relative overflow-auto flex flex-col items-center justify-start pt-4 pb-4",children:m?b.jsx("div",{className:"w-full h-full flex items-center justify-center",children:b.jsxs("div",{className:"flex flex-col items-center gap-3",children:[b.jsx(du,{size:32,className:"animate-spin text-primary"}),b.jsx("p",{className:"text-muted text-sm",children:"Loading document..."})]})}):E?b.jsx("div",{className:"w-full h-full flex items-center justify-center",children:b.jsxs("div",{className:"flex flex-col items-center gap-3 text-center p-8",children:[b.jsx(Iw,{size:32,className:"text-error"}),b.jsx("p",{className:"text-error text-sm font-medium",children:"Failed to load PDF"}),b.jsx("p",{className:"text-muted text-xs",children:E}),b.jsx("p",{className:"text-muted text-xs mt-2",children:"Try downloading the file instead or contact support."})]})}):a?b.jsxs(b.Fragment,{children:[b.jsx("canvas",{ref:r,className:"max-w-full border border-white/10 rounded-lg shadow-lg",style:{maxHeight:"calc(100% - 60px)"}}),C&&b.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-lg pointer-events-none",children:b.jsx(du,{size:24,className:"animate-spin text-primary"})})]}):null}),a&&f>0&&b.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-white/10 bg-surface shrink-0 gap-4",children:[b.jsx("button",{onClick:()=>V(u-1),disabled:u===1,className:"btn-icon disabled:opacity-50 disabled:cursor-not-allowed hover:text-primary",title:"Previous page",children:b.jsx(RO,{size:20})}),b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("input",{type:"number",min:"1",max:f,value:u,onChange:S=>V(parseInt(S.target.value)||1),className:"w-12 px-2 py-1 bg-white/10 border border-white/20 rounded text-white text-center text-sm"}),b.jsxs("span",{className:"text-muted text-sm whitespace-nowrap",children:["/ ",f]})]}),b.jsx("button",{onClick:()=>V(u+1),disabled:u===f,className:"btn-icon disabled:opacity-50 disabled:cursor-not-allowed hover:text-primary",title:"Next page",children:b.jsx(Jk,{size:20})})]})]})}):null},a5=["SveIem0WRcSCKl1IK44dZ1KfalO2","s5rGItmRedXGhgjKr0hUW256Xor1"],l5=({onLogout:n,onNavigateAdmin:e,isAdmin:t})=>{const[s,i]=K.useState([]),[r,o]=K.useState(null),[a,l]=K.useState([]),[u,d]=K.useState(!0),[f,p]=K.useState(!1),[m,y]=K.useState(""),[E,k]=K.useState(!1),[v,A]=K.useState(null),[C,N]=K.useState(!1),[F,V]=K.useState(""),[S,T]=K.useState(!1),[P,D]=K.useState(""),[M,O]=K.useState(!1),[L,ne]=K.useState(!1),Ne=K.useRef(null);K.useEffect(()=>{y(localStorage.getItem("Name")||"User"),de(),(async()=>{const q=localStorage.getItem("Number");if(q)try{const oe=await Zl(lt(qe,"Numbers",q));oe.exists()&&k(oe.data()["PDF-Down"]===!0)}catch{}})()},[]),K.useEffect(()=>{r&&Y(r)},[r]),K.useEffect(()=>{C&&setTimeout(()=>{var $;return($=Ne.current)==null?void 0:$.focus()},100)},[C]),K.useEffect(()=>{const $=()=>{document.hidden&&ne(!0)},q=()=>{document.activeElement instanceof HTMLIFrameElement||ne(!0)};return document.addEventListener("visibilitychange",$),window.addEventListener("blur",q),()=>{document.removeEventListener("visibilitychange",$),window.removeEventListener("blur",q)}},[]),K.useEffect(()=>{if(!v){O(!1);return}const $=async()=>{if(M)return;O(!0);const J=localStorage.getItem("Number");if(J){try{await qf(lt(qe,"Numbers",J),{Screened:k3(1)})}catch(Ge){console.error("Failed to log violation",Ge)}try{const Ge=document.createElement("canvas");Ge.width=1280,Ge.height=720;const _e=Ge.getContext("2d");_e&&(_e.fillStyle="#09090b",_e.fillRect(0,0,1280,720),_e.strokeStyle="#ef4444",_e.lineWidth=10,_e.strokeRect(50,50,1180,620),_e.fillStyle="#ef4444",_e.font="bold 80px sans-serif",_e.textAlign="center",_e.fillText("SECURITY VIOLATION",640,250),_e.fillStyle="#ffffff",_e.font="40px sans-serif",_e.fillText("SCREENSHOT ATTEMPT DETECTED",640,320),_e.fillStyle="#a1a1aa",_e.font="30px monospace",_e.fillText(`User Name: ${localStorage.getItem("Name")||"Unknown"}`,640,450),_e.fillText(`User ID:   ${J}`,640,500),_e.fillText(`Timestamp: ${new Date().toLocaleString()}`,640,550),_e.fillText(`Device:    ${localStorage.getItem("DeviceName")||"Unknown"}`,640,600),Ge.toBlob(async Be=>{if(Be){const be=`Shot_${J}_${Date.now()}.png`;await Xz(zr($r,`Captured-Shots/${be}`),Be)}}))}catch(Ge){console.error("Evidence generation failed",Ge)}}},q=J=>{(J.key==="PrintScreen"||J.ctrlKey&&(J.key==="p"||J.key==="s")||J.metaKey&&(J.key==="p"||J.key==="s")||J.metaKey&&J.shiftKey&&(J.key==="3"||J.key==="4"||J.key==="5"))&&(J.preventDefault(),$())},oe=J=>{J.key==="PrintScreen"&&$()},se=J=>{J.preventDefault()};return window.addEventListener("keydown",q),window.addEventListener("keyup",oe),window.addEventListener("copy",se),()=>{window.removeEventListener("keydown",q),window.removeEventListener("keyup",oe),window.removeEventListener("copy",se)}},[v,M]);const de=async()=>{try{const q=(await yf(zr($r,"/"))).prefixes.map(oe=>oe.name).filter(oe=>oe.startsWith("Week ")).sort((oe,se)=>parseInt(oe.split(" ")[1]||"0")-parseInt(se.split(" ")[1]||"0"));i(q),q.length>0&&o(q[0])}catch($){console.error($)}finally{d(!1)}},Y=async $=>{p(!0),l([]);try{const q=await yf(zr($r,$)),oe=await Promise.all(q.items.map(async se=>{try{const J=await Yz(se);return{name:se.name.replace(".pdf",""),url:"",date:new Date(J.timeCreated).toLocaleDateString("en-GB"),size:`${(J.size/(1024*1024)).toFixed(2)}mb`,path:se.fullPath}}catch{return null}}));l(oe.filter(se=>se!==null))}catch{}finally{p(!1)}},z=async $=>{if($.preventDefault(),!!F){T(!0),D("");try{const q=await iE(Ja,"temrevil+1@gmail.com",F);if(a5.includes(q.user.uid))N(!1),V(""),e();else throw new Error}catch{D("Access Denied")}finally{T(!1)}}};return b.jsxs("div",{className:"flex flex-row h-screen w-full select-none overflow-hidden bg-app-base",children:[b.jsxs("aside",{className:"sidebar z-20 shadow-lg",children:[b.jsx("div",{className:"sidebar-header",children:b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"rounded-lg flex items-center justify-center text-white bg-surface border border-white/10",style:{width:"36px",height:"36px"},children:b.jsx(Y0,{size:18})}),b.jsxs("div",{children:[b.jsx("h1",{className:"font-bold text-white tracking-tight text-base",children:"The State"}),b.jsx("p",{className:"text-muted text-xs",children:"Secure Portal"})]})]})}),b.jsx("div",{className:"flex-1 overflow-auto px-4 py-14 custom-scrollbar",children:u?b.jsx("div",{className:"flex justify-center py-8",children:b.jsx(du,{className:"animate-spin text-muted",size:24})}):b.jsx("div",{className:"flex flex-col gap-2",children:s.map($=>b.jsxs("button",{onClick:()=>o($),className:`nav-btn ${r===$?"active":""}`,children:[b.jsx(Wa,{size:18,className:r===$?"text-primary":""}),b.jsx("span",{className:"font-medium",children:$})]},$))})}),b.jsxs("div",{className:"p-4 border-t border-white/10 mt-auto",children:[b.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 rounded-lg bg-surface/50 mb-3 border border-white/5",children:[b.jsx("div",{className:"rounded-full bg-indigo-600 flex items-center justify-center text-white text-xs font-bold",style:{width:"32px",height:"32px"},children:m.charAt(0).toUpperCase()}),b.jsxs("div",{className:"flex-1 min-w-0",children:[b.jsx("p",{className:"text-sm font-medium text-white truncate",children:m}),b.jsx("p",{className:"text-xs text-success",children:"Connected"})]})]}),t&&b.jsxs("button",{onClick:()=>N(!0),className:"nav-btn mb-1",children:[b.jsx(Y1,{size:16})," Admin"]}),b.jsxs("button",{onClick:n,className:"nav-btn hover:text-error hover:bg-red-500/10",children:[b.jsx(eR,{size:16})," Sign Out"]})]})]}),b.jsxs("main",{className:"main-content",children:[b.jsx("header",{className:"content-header",children:b.jsxs("div",{children:[b.jsx("h2",{className:"text-2xl font-bold text-white",children:r||"Loading..."}),b.jsx("p",{className:"text-sm text-muted",children:"Document Repository"})]})}),b.jsx("div",{className:"content-body custom-scrollbar",children:f?b.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted gap-4",children:[b.jsx(du,{size:32,className:"animate-spin opacity-40"}),b.jsx("p",{className:"text-sm font-medium",children:"Syncing documents..."})]}):a.length===0?b.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted gap-6 border border-dashed border-white/10 rounded-2xl mx-auto max-w-lg p-12",children:[b.jsx(Wa,{size:48,className:"opacity-20"}),b.jsx("p",{className:"text-sm",children:"No documents found in this directory."})]}):b.jsx("div",{className:"grid-cards",children:a.map($=>b.jsxs("div",{onClick:()=>A($),className:"resource-card group",children:[b.jsxs("div",{className:"flex-1",children:[b.jsx("div",{className:"card-icon",children:b.jsx(X0,{size:24})}),b.jsx("h3",{className:"text-lg font-semibold text-white mb-2 leading-snug line-clamp-2",children:$.name})]}),b.jsxs("div",{className:"pt-4 flex justify-between items-center text-muted text-xs border-t border-white/5 mt-auto",children:[b.jsx("span",{children:$.date}),b.jsx("span",{className:"font-mono opacity-70",children:$.size})]})]},$.name))})})]}),b.jsx(o5,{pdf:v,onClose:()=>{A(null),O(!1)},violation:M,onViolation:()=>O(!0),canDownload:E}),L&&b.jsxs("div",{className:"fixed inset-0 z-[99999] flex flex-col items-center justify-center text-center p-8 animate-fade-in select-none",style:{backgroundColor:"rgba(0, 0, 0, 0.85)",backdropFilter:"blur(30px)",WebkitBackdropFilter:"blur(30px)",zIndex:50},children:[b.jsx("div",{className:"w-24 h-24 rounded-full bg-white/5 border border-white/10 flex items-center justify-center mb-6 shadow-glow",children:b.jsx(DO,{size:48,className:"text-muted"})}),b.jsx("h2",{className:"text-3xl font-bold text-white mb-2 tracking-tight",children:"Session Paused"}),b.jsx("p",{className:"text-muted text-lg mb-8 max-w-md",children:"Focus has been lost. To ensure security, content is hidden while you are away."}),b.jsx("button",{onClick:()=>ne(!1),className:"btn btn-primary px-8 py-3 h-auto text-lg rounded-full",children:"Resume Session"})]}),C&&b.jsx("div",{className:"modal-overlay animate-fade-in",children:b.jsxs("div",{className:"modal-content modal-sm p-8 relative",children:[b.jsx("button",{onClick:()=>N(!1),className:"absolute top-4 right-4 text-muted hover:text-white transition-colors",children:b.jsx(Qy,{size:20})}),b.jsxs("div",{className:"flex flex-col items-center",children:[b.jsx("div",{className:"w-14 h-14 rounded-2xl bg-surface border border-white/10 flex items-center justify-center mb-6 text-primary shadow-glow",children:b.jsx(Y1,{size:28})}),b.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Admin Access"}),b.jsx("p",{className:"text-muted text-sm mb-8 text-center",children:"Restricted area. Authentication required."}),b.jsxs("form",{onSubmit:z,className:"w-full flex flex-col gap-4",children:[b.jsxs("div",{className:"relative",children:[b.jsx(Zk,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted pointer-events-none",size:18}),b.jsx("input",{ref:Ne,type:"password",value:F,onChange:$=>V($.target.value),placeholder:"Security Code",className:"login-input pl-12"})]}),P&&b.jsx("div",{className:"text-center text-xs text-error py-2 bg-red-500/10 rounded-lg border border-red-500/20",children:P}),b.jsx("button",{type:"submit",disabled:S,className:"btn btn-primary w-full",children:S?b.jsx(du,{size:20,className:"animate-spin"}):"Authenticate"})]})]})]})})]})},c5=({onBack:n})=>{var td,nd;const[e,t]=K.useState("tables"),[s,i]=K.useState("numbers"),[r,o]=K.useState([]),[a,l]=K.useState([]),[u,d]=K.useState([]),[f,p]=K.useState("Admin"),[m,y]=K.useState([]),[E,k]=K.useState([]),[v,A]=K.useState(""),[C,N]=K.useState([]),[F,V]=K.useState("grid"),[S,T]=K.useState([]),[P,D]=K.useState(0),[M,O]=K.useState(!1),[L,ne]=K.useState(!1),[Ne,de]=K.useState(!1),[Y,z]=K.useState(!1),[$,q]=K.useState(null),[oe,se]=K.useState(""),[J,Ge]=K.useState(!1),[_e,Be]=K.useState(""),[be,Qs]=K.useState(!0),[Da,lr]=K.useState(!0);K.useEffect(()=>{const U=re=>{const Ee=re.target;!Ee.closest(".options-menu")&&!Ee.closest(".btn-icon")&&q(null)};return document.addEventListener("click",U),()=>document.removeEventListener("click",U)},[]),K.useEffect(()=>{Zl(lt(qe,"Dashboard","Admin")).then(Qe=>Qe.exists()&&p(Qe.data().Name||"Admin")),Zl(lt(qe,"Dashboard","Settings")).then(Qe=>Qe.exists()&&(Qs(Qe.data()["Quiz-Enabled"]),lr(Qe.data()["PDF-Down"])));const U=zw(gf(qe,"Blocked"),Qe=>{l(Qe.docs.map(Ze=>({id:Ze.id,number:Ze.id,name:Ze.data().Name||"Unknown",reason:Ze.data().Reason||"Unknown",date:Ze.data()["Blocked Date"]||"",time:Ze.data()["Blocked Time"]||""})))}),re=zw(gf(qe,"Numbers"),Qe=>{o(Qe.docs.map(Ze=>({id:Ze.id,number:Ze.id,name:Ze.data().Name,quizTimes:Ze.data()["Quizi-Times"]||0,quizEnabled:Ze.data()["Quiz-Enabled"]??!0,pdfDown:Ze.data()["PDF-Down"]??!0,deviceCount:0,screenedCount:Ze.data().Screened||0})))}),Ee=zw(gf(qe,"Snitches"),Qe=>{d(Qe.docs.map(Ze=>({id:Ze.id,loginNumber:Ze.data()["The Login Number"],snitchNumber:Ze.data()["The Snitch"],snitchName:Ze.data().Name,date:Ze.data()["Snitched Date"],time:Ze.data()["Snitched Time"]})))});return()=>{U(),re(),Ee()}},[]);const Sc=async()=>{confirm("Logout?")&&(await _j(Ja),window.location.reload())},qh=async()=>{if(!oe||oe.length!==11)return alert("Invalid Number");try{await su(lt(qe,"Numbers",oe),{Name:"Unknown","PDF-Down":J,"Quiz-Enabled":!0,"Quizi-Times":0,Devices:{"Devices Allowed":1},Screened:0}),O(!1),se(""),Ge(!1)}catch(U){console.error(U)}},Kh=async U=>{if(confirm("Delete?"))try{await Dc(lt(qe,"Numbers",U.trim()))}catch{}finally{q(null)}},Xh=async U=>{if(!confirm(`Block ${U.name||U.number}?`))return;const re=new Date;try{await su(lt(qe,"Blocked",U.number),{"Blocked Date":re.toLocaleDateString("en-GB"),"Blocked Time":re.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),Reason:"Blocked by Admin",Name:U.name}),await Dc(lt(qe,"Numbers",U.number)),q(null)}catch(Ee){console.error(Ee)}},Yh=async U=>{try{await qf(lt(qe,"Numbers",U.number),{"Quiz-Enabled":!U.quizEnabled}),q(null)}catch(re){console.error(re)}},Fg=async U=>{try{await qf(lt(qe,"Numbers",U.number),{"PDF-Down":!U.pdfDown}),q(null)}catch(re){console.error(re)}},Mv=async U=>{if(confirm(`Unblock ${U.number}?`))try{await su(lt(qe,"Numbers",U.number),{Name:U.name||"Unknown","PDF-Down":!0,"Quiz-Enabled":!0,"Quizi-Times":0,Devices:{"Devices Allowed":1}}),await Dc(lt(qe,"Blocked",U.number)),q(null)}catch(re){console.error(re)}},Ov=async U=>{confirm("Delete record?")&&(await Dc(lt(qe,"Blocked",U)),q(null))},Vg=async U=>{if(!confirm(`Block Snitch ${U.snitchNumber}?`))return;const re=new Date;try{let Ee=U.snitchName;if(!Ee||Ee==="Unknown")try{const Qe=await Zl(lt(qe,"Numbers",U.snitchNumber));Qe.exists()&&(Ee=Qe.data().Name)}catch{}await su(lt(qe,"Blocked",U.snitchNumber),{"Blocked Date":re.toLocaleDateString("en-GB"),"Blocked Time":re.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),Reason:`Snitched on ${U.loginNumber}`,Name:Ee||"Unknown"});try{await Dc(lt(qe,"Numbers",U.snitchNumber))}catch{}q(null)}catch(Ee){console.error(Ee)}},Qh=async U=>{confirm("Delete record?")&&(await Dc(lt(qe,"Snitches",U)),q(null))},jg=r.filter(U=>{var re,Ee,Qe;return((re=U.number)==null?void 0:re.includes(_e))||((Qe=(Ee=U.name)==null?void 0:Ee.toLowerCase())==null?void 0:Qe.includes(_e.toLowerCase()))}),Fv=a.filter(U=>{var re,Ee,Qe;return((re=U.number)==null?void 0:re.includes(_e))||((Qe=(Ee=U.name)==null?void 0:Ee.toLowerCase())==null?void 0:Qe.includes(_e.toLowerCase()))}),Jh=u.filter(U=>{var re,Ee;return((re=U.loginNumber)==null?void 0:re.includes(_e))||((Ee=U.snitchNumber)==null?void 0:Ee.includes(_e))}),xc=async U=>{try{const re=zr($r,U),Ee=await yf(re),Qe=Ee.prefixes.map(cr=>({name:cr.name,type:"folder",fullPath:cr.fullPath})),Ze=await Promise.all(Ee.items.map(async cr=>({name:cr.name,type:"file",fullPath:cr.fullPath,url:await _I(cr)})));y([...Qe,...Ze]),k([])}catch{}};K.useEffect(()=>{e==="files"&&xc(v)},[e,v]);const Zh=U=>{N(re=>[...re,v]),A(U)},Ht=()=>{if(C.length>0){const U=[...C],re=U.pop();N(U),A(re||"")}},Wt=U=>{k(re=>re.includes(U)?re.filter(Ee=>Ee!==U):[...re,U])},Ic=()=>{E.length===m.length?k([]):k(m.map(U=>U.fullPath))},ed=async U=>{try{const re=await yf(zr($r,U));await Promise.all(re.items.map(Ee=>Ww(Ee))),await Promise.all(re.prefixes.map(Ee=>ed(Ee.fullPath)))}catch(re){console.error("Recursive delete failed",re)}},Ug=async()=>{if(confirm(`Delete ${E.length} items? This cannot be undone.`)){for(const U of E){const re=m.find(Ee=>Ee.fullPath===U);if((re==null?void 0:re.type)==="folder")await ed(U);else try{await Ww(zr($r,U))}catch{}}k([]),xc(v)}},Vv=async()=>{try{const U=await yf(zr($r,"Captured-Shots"));T(await Promise.all(U.items.map(async re=>({fullPath:re.fullPath,url:await _I(re),name:re.name}))))}catch{}};K.useEffect(()=>{e==="shots"&&Vv()},[e]);const La=async()=>{if(confirm("Delete?"))try{await Ww(zr($r,S[P].fullPath));const U=[...S];U.splice(P,1),T(U),P>=U.length&&D(Math.max(0,U.length-1))}catch{}};return b.jsxs("div",{className:"flex h-screen overflow-hidden bg-black",children:[b.jsxs("aside",{className:"sidebar z-20 shadow-xl",children:[b.jsxs("div",{className:"sidebar-header gap-3",children:[b.jsx("div",{className:"rounded border border-indigo-900/50 flex items-center justify-center text-indigo-500 bg-indigo-500/10",style:{width:"32px",height:"32px"},children:b.jsx(tR,{size:18})}),b.jsxs("div",{children:[b.jsx("h1",{className:"font-bold text-white text-sm",children:"The State"}),b.jsx("p",{className:"text-muted uppercase text-[10px] tracking-wider",children:"System Control"})]})]}),b.jsxs("nav",{className:"flex-1 p-4 flex flex-col gap-2",children:[b.jsxs("button",{onClick:()=>t("tables"),className:`nav-btn admin-nav-btn ${e==="tables"?"active":""}`,children:[b.jsx(Y0,{size:18})," Tables"]}),b.jsxs("button",{onClick:()=>t("files"),className:`nav-btn admin-nav-btn ${e==="files"?"active":""}`,children:[b.jsx(Wa,{size:18})," Files"]}),b.jsxs("button",{onClick:()=>t("shots"),className:`nav-btn admin-nav-btn ${e==="shots"?"active":""}`,children:[b.jsx(X1,{size:18})," Shots"]})]}),b.jsxs("div",{className:"p-4 border-t border-white/10 flex flex-col gap-2",children:[b.jsxs("button",{onClick:n,className:"nav-btn",children:[b.jsx(xw,{size:16})," Back to User View"]}),b.jsxs("button",{onClick:Sc,className:"nav-btn hover:text-error hover:bg-red-500/10",children:[b.jsx(eR,{size:16})," Sign Out"]})]})]}),b.jsxs("main",{className:"main-content",children:[b.jsxs("header",{className:"content-header",children:[b.jsxs("div",{className:"flex items-center gap-3",children:[b.jsx("div",{className:"rounded-full bg-surface border border-white/10 flex items-center justify-center text-muted font-bold text-xs",style:{width:"36px",height:"36px"},children:f.charAt(0).toUpperCase()}),b.jsxs("div",{children:[b.jsxs("h2",{className:"text-sm font-semibold text-white",children:["Welcome, ",f]}),b.jsx("p",{className:"text-xs text-success",children:"Online"})]})]}),b.jsxs("button",{onClick:()=>ne(!0),className:"btn btn-secondary btn-sm gap-2 text-xs h-9 px-3",children:[b.jsx(VO,{size:14})," Settings"]})]}),b.jsxs("div",{className:"content-body",children:[e==="tables"&&b.jsxs("div",{className:"h-full flex flex-col gap-4",children:[b.jsxs("div",{className:"table-toolbar",children:[b.jsx("div",{className:"table-nav",children:["numbers","blocked","snitches"].map(U=>b.jsx("button",{onClick:()=>i(U),className:`table-nav-btn capitalize ${s===U?"active":""}`,children:U},U))}),b.jsxs("div",{className:"flex gap-3 items-center",children:[b.jsxs("div",{className:"search-container",children:[b.jsx(FO,{className:"search-icon",size:16}),b.jsx("input",{type:"text",placeholder:"Search...",value:_e,onChange:U=>Be(U.target.value),className:"search-input"})]}),s==="numbers"&&b.jsxs("button",{onClick:()=>O(!0),className:"btn btn-primary btn-toolbar",children:[b.jsx(OO,{size:16})," Add"]})]})]}),b.jsx("div",{className:"flex-1 bg-surface border border-white/10 rounded-xl overflow-hidden shadow-2xl relative",children:b.jsx("div",{className:"absolute inset-0 overflow-auto custom-scrollbar",children:b.jsxs("table",{className:"admin-table",children:[b.jsx("thead",{children:b.jsx("tr",{children:s==="numbers"?b.jsxs(b.Fragment,{children:[b.jsx("th",{children:"Number"}),b.jsx("th",{children:"Name"}),b.jsx("th",{children:"Screened"}),b.jsx("th",{children:"Quiz"}),b.jsx("th",{children:"PDF"}),b.jsx("th",{className:"text-right",children:"Actions"})]}):s==="blocked"?b.jsxs(b.Fragment,{children:[b.jsx("th",{children:"Number"}),b.jsx("th",{children:"Name"}),b.jsx("th",{children:"Reason"}),b.jsx("th",{children:"Date"}),b.jsx("th",{className:"text-right",children:"Actions"})]}):b.jsxs(b.Fragment,{children:[b.jsx("th",{children:"Login #"}),b.jsx("th",{children:"Snitch #"}),b.jsx("th",{children:"Name"}),b.jsx("th",{children:"Time"}),b.jsx("th",{className:"text-right",children:"Actions"})]})})}),b.jsx("tbody",{children:(s==="numbers"?jg:s==="blocked"?Fv:Jh).map(U=>b.jsxs("tr",{children:[s==="numbers"&&b.jsxs(b.Fragment,{children:[b.jsx("td",{className:"font-mono text-muted",children:U.number}),b.jsx("td",{className:"font-medium text-white",children:U.name}),b.jsx("td",{children:b.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${U.screenedCount>0?"bg-orange-500/20 text-orange-500 border border-orange-500/20":"text-muted"}`,children:U.screenedCount})}),b.jsx("td",{children:b.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${U.quizEnabled?"text-success bg-success/10":"text-muted bg-white/5"}`,children:U.quizEnabled?"ON":"OFF"})}),b.jsx("td",{children:b.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${U.pdfDown?"text-success bg-success/10":"text-error bg-error/10"}`,children:U.pdfDown?"Allowed":"Blocked"})}),b.jsxs("td",{className:"text-right relative",children:[b.jsx("div",{className:"flex justify-end",children:b.jsx("button",{onClick:re=>{re.stopPropagation(),q($===U.id?null:U.id)},className:"btn-icon w-8 h-8",children:b.jsx(Cw,{size:16})})}),$===U.id&&b.jsxs("div",{className:"options-menu",children:[b.jsxs("button",{onClick:()=>Xh(U),className:"options-item warning",children:[b.jsx(q0,{size:14})," Block Number"]}),b.jsxs("button",{onClick:()=>Yh(U),className:"options-item",children:[b.jsx(CO,{size:14})," Quiz: ",U.quizEnabled?"ON":"OFF"]}),b.jsxs("button",{onClick:()=>Fg(U),className:"options-item",children:[b.jsx(K0,{size:14})," PDF: ",U.pdfDown?"Allowed":"Blocked"]}),b.jsx("div",{className:"options-divider"}),b.jsxs("button",{onClick:()=>Kh(U.id),className:"options-item danger",children:[b.jsx(vm,{size:14})," Delete"]})]})]})]}),s==="blocked"&&b.jsxs(b.Fragment,{children:[b.jsx("td",{className:"font-mono text-muted",children:U.number}),b.jsx("td",{className:"font-medium text-white",children:U.name}),b.jsx("td",{className:"text-sm text-error",children:U.reason}),b.jsxs("td",{className:"text-xs text-muted",children:[U.date," ",U.time]}),b.jsxs("td",{className:"text-right relative",children:[b.jsx("div",{className:"flex justify-end",children:b.jsx("button",{onClick:re=>{re.stopPropagation(),q($===U.id?null:U.id)},className:"btn-icon w-8 h-8",children:b.jsx(Cw,{size:16})})}),$===U.id&&b.jsxs("div",{className:"options-menu",style:{width:"160px"},children:[b.jsxs("button",{onClick:()=>Mv(U),className:"options-item text-success",children:[b.jsx(MO,{size:14,className:"text-success"})," Unblock"]}),b.jsx("div",{className:"options-divider"}),b.jsxs("button",{onClick:()=>Ov(U.id),className:"options-item danger",children:[b.jsx(vm,{size:14})," Delete"]})]})]})]}),s==="snitches"&&b.jsxs(b.Fragment,{children:[b.jsx("td",{className:"font-mono text-muted",children:U.loginNumber}),b.jsx("td",{className:"font-mono text-error",children:U.snitchNumber}),b.jsx("td",{className:"text-white",children:U.snitchName}),b.jsxs("td",{className:"text-xs text-muted",children:[U.date," ",U.time]}),b.jsxs("td",{className:"text-right relative",children:[b.jsx("div",{className:"flex justify-end",children:b.jsx("button",{onClick:re=>{re.stopPropagation(),q($===U.id?null:U.id)},className:"btn-icon w-8 h-8",children:b.jsx(Cw,{size:16})})}),$===U.id&&b.jsxs("div",{className:"options-menu",style:{width:"160px"},children:[b.jsxs("button",{onClick:()=>Vg(U),className:"options-item warning",children:[b.jsx(q0,{size:14})," Block Snitch"]}),b.jsx("div",{className:"options-divider"}),b.jsxs("button",{onClick:()=>Qh(U.id),className:"options-item danger",children:[b.jsx(vm,{size:14})," Delete"]})]})]})]})]},U.id))})]})})})]}),e==="files"&&b.jsxs("div",{className:"h-full flex flex-col gap-4",children:[b.jsxs("div",{className:"flex items-center justify-between",children:[b.jsxs("div",{className:"flex items-center gap-2",children:[b.jsx("button",{onClick:Ht,disabled:C.length===0,className:`btn-icon border border-white/10 bg-surface ${C.length===0?"opacity-50":""}`,children:b.jsx(xw,{size:16})}),b.jsxs("div",{className:"flex items-center bg-surface border border-white/10 rounded-lg px-3 py-2 text-sm text-muted font-mono",children:[b.jsx("span",{onClick:()=>{A(""),N([])},className:"cursor-pointer hover:text-white",children:"root/"}),v]})]}),b.jsxs("div",{className:"flex items-center gap-2",children:[E.length>0&&b.jsxs("button",{onClick:Ug,className:"btn btn-danger btn-toolbar animate-fade-in",children:[b.jsx(vm,{size:16})," Delete (",E.length,")"]}),b.jsxs("div",{className:"view-toggle-group mr-2",children:[b.jsx("button",{onClick:()=>V("grid"),className:`view-toggle-btn ${F==="grid"?"active":""}`,children:b.jsx(Y0,{size:16})}),b.jsx("button",{onClick:()=>V("table"),className:`view-toggle-btn ${F==="table"?"active":""}`,children:b.jsx(LO,{size:16})})]}),b.jsxs("button",{onClick:()=>z(!0),className:"btn btn-secondary btn-toolbar",children:[b.jsx(Wa,{size:16})," New Folder"]}),b.jsxs("button",{onClick:()=>de(!0),className:"btn btn-primary btn-toolbar",children:[b.jsx(jO,{size:16})," Upload"]})]})]}),b.jsx("div",{className:"flex-1 bg-surface border border-white/10 rounded-xl overflow-hidden shadow-2xl relative",children:b.jsx("div",{className:"absolute inset-0 overflow-auto custom-scrollbar p-4",children:F==="grid"?b.jsxs("div",{className:"file-grid-layout",children:[m.map(U=>{const re=E.includes(U.fullPath);return b.jsxs("div",{onClick:()=>U.type==="folder"&&Zh(U.fullPath),className:`file-card ${re?"selected":""}`,children:[b.jsx("div",{onClick:Ee=>{Ee.stopPropagation(),Wt(U.fullPath)},className:"absolute top-2 left-2 p-1 rounded hover:bg-black/50 text-white/50 hover:text-white z-10 cursor-pointer",children:re?b.jsx(kw,{size:18,className:"text-primary"}):b.jsx(Rw,{size:18})}),b.jsx("div",{className:"flex-1 flex items-center justify-center",children:U.type==="folder"?b.jsx(Wa,{size:48,className:"text-amber-500 drop-shadow-md"}):b.jsx(X0,{size:48,className:"text-primary drop-shadow-md"})}),b.jsx("span",{className:"text-xs text-muted truncate w-full text-center px-2 pb-2",children:U.name})]},U.fullPath)}),m.length===0&&b.jsx("div",{className:"col-span-full text-center text-muted py-10 opacity-50",children:"Empty Directory"})]}):b.jsxs("div",{className:"flex flex-col gap-1",children:[b.jsxs("div",{className:"file-table-layout px-4 py-3 text-xs font-bold text-muted uppercase border-b border-white/10 items-center bg-white/5 rounded-t-lg",children:[b.jsx("div",{onClick:Ic,className:"cursor-pointer hover:text-white flex items-center",children:E.length===m.length&&m.length>0?b.jsx(kw,{size:16}):b.jsx(Rw,{size:16})}),b.jsx("div",{className:"flex justify-center",children:b.jsx(Wa,{size:14,className:"opacity-0"})})," ",b.jsx("span",{children:"Name"}),b.jsx("span",{className:"text-right",children:"Action"})]}),b.jsx("div",{className:"flex flex-col",children:m.map(U=>{const re=E.includes(U.fullPath);return b.jsxs("div",{onClick:()=>U.type==="folder"&&Zh(U.fullPath),className:`file-table-layout px-4 py-3 items-center rounded-lg cursor-pointer border-b border-white/5 last:border-0 transition-colors ${re?"bg-primary/10 border-primary/20":"hover:bg-white/5"}`,children:[b.jsx("div",{onClick:Ee=>{Ee.stopPropagation(),Wt(U.fullPath)},className:"cursor-pointer text-muted hover:text-white flex items-center",children:re?b.jsx(kw,{size:16,className:"text-primary"}):b.jsx(Rw,{size:16})}),b.jsx("div",{className:"flex justify-center",children:U.type==="folder"?b.jsx(Wa,{size:18,className:"text-amber-500"}):b.jsx(X0,{size:18,className:"text-primary"})}),b.jsx("span",{className:"text-sm text-white truncate pr-4",children:U.name}),b.jsx("div",{className:"flex justify-end",children:U.type==="file"&&b.jsx("a",{href:U.url,target:"_blank",rel:"noreferrer",onClick:Ee=>Ee.stopPropagation(),className:"p-2 text-muted hover:text-white",children:b.jsx(K0,{size:14})})})]},U.fullPath)})}),m.length===0&&b.jsx("div",{className:"text-center text-muted py-10 opacity-50",children:"Empty Directory"})]})})})]}),e==="shots"&&b.jsx("div",{className:"h-full flex flex-col items-center justify-center",children:S.length>0?b.jsxs("div",{className:"w-full max-w-4xl flex flex-col gap-4",children:[b.jsxs("div",{className:"relative bg-black rounded-xl border border-white/10 overflow-hidden shadow-2xl aspect-video flex items-center justify-center",children:[b.jsx("img",{src:(td=S[P])==null?void 0:td.url,alt:"Shot",className:"max-w-full max-h-full"}),b.jsx("button",{onClick:()=>D(U=>Math.max(0,U-1)),className:"absolute left-4 top-1/2 -translate-y-1/2 btn-icon bg-black/50 hover:bg-black text-white rounded-full",children:b.jsx(xw,{})}),b.jsx("button",{onClick:()=>D(U=>Math.min(S.length-1,U+1)),className:"absolute right-4 top-1/2 -translate-y-1/2 btn-icon bg-black/50 hover:bg-black text-white rounded-full",children:b.jsx(IO,{})})]}),b.jsxs("div",{className:"flex justify-between items-center bg-surface p-4 rounded-xl border border-white/10",children:[b.jsx("span",{className:"text-sm font-mono text-muted",children:(nd=S[P])==null?void 0:nd.name}),b.jsxs("div",{className:"flex gap-4 items-center",children:[b.jsxs("span",{className:"text-sm text-muted",children:[P+1," / ",S.length]}),b.jsx("button",{onClick:La,className:"btn btn-danger h-8 text-xs px-3",children:"Delete"})]})]})]}):b.jsxs("div",{className:"text-muted flex flex-col items-center gap-4",children:[b.jsx(X1,{size:48,className:"opacity-20"}),b.jsx("p",{children:"No screenshots captured"})]})})]})]}),M&&b.jsx("div",{className:"modal-overlay",children:b.jsxs("div",{className:"modal-content modal-md p-8",children:[b.jsxs("div",{className:"flex justify-between items-center mb-8",children:[b.jsxs("div",{children:[b.jsx("h3",{className:"text-2xl font-bold text-white",children:"Add New User"}),b.jsx("p",{className:"text-muted text-sm mt-1",children:"Create a new user account"})]}),b.jsx("button",{onClick:()=>O(!1),className:"btn-icon text-muted hover:text-white",children:b.jsx(Qy,{size:20})})]}),b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{children:[b.jsx("label",{className:"text-xs text-muted mb-2 block uppercase font-bold tracking-wider",children:"Phone Number"}),b.jsx("input",{type:"text",value:oe,onChange:U=>se(U.target.value),placeholder:"Enter 11 digits",className:"login-input w-full"})]}),b.jsxs("div",{children:[b.jsx("label",{className:"text-xs text-muted mb-3 block uppercase font-bold tracking-wider",children:"PDF Permission"}),b.jsxs("div",{className:"relative",children:[b.jsxs("select",{value:J?"true":"false",onChange:U=>Ge(U.target.value==="true"),className:"login-input appearance-none bg-surface cursor-pointer",children:[b.jsx("option",{value:"false",children:"Blocked (Default)"}),b.jsx("option",{value:"true",children:"Allowed"})]}),b.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 text-muted",children:b.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})]})]})]}),b.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-white/10",children:[b.jsx("button",{onClick:()=>O(!1),className:"btn btn-ghost",children:"Cancel"}),b.jsx("button",{onClick:qh,className:"btn btn-primary",children:"Create User"})]})]})}),L&&b.jsx("div",{className:"modal-overlay",children:b.jsxs("div",{className:"modal-content modal-md p-6",children:[b.jsxs("div",{className:"flex justify-between items-center mb-6",children:[b.jsx("h3",{className:"text-xl font-bold text-white",children:"System Settings"}),b.jsx("button",{onClick:()=>ne(!1),className:"btn-icon",children:b.jsx(Qy,{size:20})})]}),b.jsxs("div",{className:"space-y-4 mb-8",children:[b.jsxs("div",{className:"settings-row",children:[b.jsx("span",{className:"settings-label",children:"Global Quiz Access"}),b.jsx("button",{onClick:()=>Qs(!be),className:`toggle-switch ${be?"active":""}`,children:b.jsx("div",{className:"toggle-thumb"})})]}),b.jsxs("div",{className:"settings-row",children:[b.jsx("span",{className:"settings-label",children:"Global PDF Downloads"}),b.jsx("button",{onClick:()=>lr(!Da),className:`toggle-switch ${Da?"active":""}`,children:b.jsx("div",{className:"toggle-thumb"})})]})]}),b.jsx("div",{className:"flex justify-end",children:b.jsx("button",{onClick:()=>ne(!1),className:"btn btn-primary",children:"Save Changes"})})]})})]})},u5=()=>{const[n,e]=K.useState("login"),[t,s]=K.useState(!1);K.useEffect(()=>{const o=localStorage.getItem("Number"),a=localStorage.getItem("Code"),l=localStorage.getItem("Name"),u=Ja.onAuthStateChanged(d=>{s(!!d)});return o&&a&&l&&e("dashboard"),()=>u()},[]);const i=()=>{e("dashboard")},r=()=>{localStorage.clear(),e("login")};return b.jsxs("main",{className:"relative h-screen w-full flex overflow-hidden bg-app-base text-white font-sans",children:[b.jsx("div",{className:"bg-gradient-radial"}),b.jsx("div",{className:"bg-orb-1"}),b.jsx("div",{className:"bg-orb-2"}),b.jsx("div",{className:"relative z-10 w-full h-full",children:n==="login"?b.jsx("div",{className:"flex items-center justify-center h-full p-4",children:b.jsx(i6,{onLoginSuccess:i})}):n==="dashboard"?b.jsx(l5,{onLogout:r,onNavigateAdmin:()=>e("admin"),isAdmin:t}):b.jsx(c5,{onBack:()=>e("dashboard")})})]})},T2=document.getElementById("root");if(!T2)throw new Error("Could not find root element to mount to");const h5=e0.createRoot(T2);h5.render(b.jsx(dL.StrictMode,{children:b.jsx(u5,{})}));
